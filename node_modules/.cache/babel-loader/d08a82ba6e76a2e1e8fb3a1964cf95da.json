{"remainingRequest":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js!D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\views\\system\\modules\\RoleDataruleModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\src\\views\\system\\modules\\RoleDataruleModal.vue","mtime":1615948821502},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IEFSb3cgZnJvbSAnYW50LWRlc2lnbi12dWUvZXMvZ3JpZC9Sb3cnOwppbXBvcnQgQUNvbCBmcm9tICdhbnQtZGVzaWduLXZ1ZS9lcy9ncmlkL0NvbCc7CmltcG9ydCB7IGdldEFjdGlvbiwgcG9zdEFjdGlvbiB9IGZyb20gJ0AvYXBpL21hbmFnZSc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnUm9sZURhdGFydWxlTW9kYWwnLAogIGNvbXBvbmVudHM6IHsKICAgIEFDb2w6IEFDb2wsCiAgICBBUm93OiBBUm93CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZnVuY3Rpb25JZDogJycsCiAgICAgIHJvbGVJZDogJycsCiAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICB0YWJMaXN0OiBbewogICAgICAgIGtleTogJzEnLAogICAgICAgIHRhYjogJ+aVsOaNruinhOWImScKICAgICAgfSwgewogICAgICAgIGtleTogJzInLAogICAgICAgIHRhYjogJ+aMiemSruadg+mZkCcKICAgICAgfV0sCiAgICAgIGFjdGl2ZVRhYktleTogJzEnLAogICAgICB1cmw6IHsKICAgICAgICBkYXRhcnVsZTogIi9zeXMvcm9sZS9kYXRhcnVsZSIKICAgICAgfSwKICAgICAgZGF0YXJ1bGVMaXN0OiBbXSwKICAgICAgZGF0YXJ1bGVDaGVja2VkOiBbXQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGxvYWREYXRhOiBmdW5jdGlvbiBsb2FkRGF0YSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGdldEFjdGlvbigiIi5jb25jYXQodGhpcy51cmwuZGF0YXJ1bGUsICIvIikuY29uY2F0KHRoaXMuZnVuY3Rpb25JZCwgIi8iKS5jb25jYXQodGhpcy5yb2xlSWQpKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwoKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIF90aGlzLmRhdGFydWxlTGlzdCA9IHJlcy5yZXN1bHQuZGF0YXJ1bGU7CiAgICAgICAgICB2YXIgZHJDaGVja2VkID0gcmVzLnJlc3VsdC5kckNoZWNrZWQ7CgogICAgICAgICAgaWYgKGRyQ2hlY2tlZCkgewogICAgICAgICAgICBfdGhpcy5kYXRhcnVsZUNoZWNrZWQgPSBkckNoZWNrZWQuc3BsaXQoIiwiKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHNhdmVEYXRhcnVsZUZvclJvbGU6IGZ1bmN0aW9uIHNhdmVEYXRhcnVsZUZvclJvbGUoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLmRhdGFydWxlQ2hlY2tlZCB8fCB0aGlzLmRhdGFydWxlQ2hlY2tlZC5sZW5ndGggPT0gMCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygi6K+35rOo5oSP77yM546w5pyq5Yu+6YCJ5Lu75L2V5pWw5o2u5p2D6ZmQISIpOwogICAgICB9CgogICAgICB2YXIgcGFyYW1zID0gewogICAgICAgIHBlcm1pc3Npb25JZDogdGhpcy5mdW5jdGlvbklkLAogICAgICAgIHJvbGVJZDogdGhpcy5yb2xlSWQsCiAgICAgICAgZGF0YVJ1bGVJZHM6IHRoaXMuZGF0YXJ1bGVDaGVja2VkLmpvaW4oIiwiKQogICAgICB9OwogICAgICBjb25zb2xlLmxvZygi5L+d5a2Y5pWw5o2u5p2D6ZmQIiwgcGFyYW1zKTsKICAgICAgcG9zdEFjdGlvbih0aGlzLnVybC5kYXRhcnVsZSwgcGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIF90aGlzMi4kbWVzc2FnZS5zdWNjZXNzKHJlcy5tZXNzYWdlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXMyLiRtZXNzYWdlLmVycm9yKHJlcy5tZXNzYWdlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHNob3c6IGZ1bmN0aW9uIHNob3coZnVuY3Rpb25JZCwgcm9sZUlkKSB7CiAgICAgIHRoaXMub25SZXNldCgpOwogICAgICB0aGlzLmZ1bmN0aW9uSWQgPSBmdW5jdGlvbklkOwogICAgICB0aGlzLnJvbGVJZCA9IHJvbGVJZDsKICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTsKICAgICAgdGhpcy5sb2FkRGF0YSgpOwogICAgfSwKICAgIG9uQ2xvc2U6IGZ1bmN0aW9uIG9uQ2xvc2UoKSB7CiAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLm9uUmVzZXQoKTsKICAgIH0sCiAgICBvblRhYkNoYW5nZTogZnVuY3Rpb24gb25UYWJDaGFuZ2Uoa2V5KSB7CiAgICAgIHRoaXMuYWN0aXZlVGFiS2V5ID0ga2V5OwogICAgfSwKICAgIG9uUmVzZXQ6IGZ1bmN0aW9uIG9uUmVzZXQoKSB7CiAgICAgIHRoaXMuZnVuY3Rpb25JZCA9ICcnOwogICAgICB0aGlzLnJvbGVJZCA9ICcnOwogICAgICB0aGlzLmRhdGFydWxlTGlzdCA9IFtdOwogICAgICB0aGlzLmRhdGFydWxlQ2hlY2tlZCA9IFtdOwogICAgfQogIH0KfTs="},{"version":3,"sources":["RoleDataruleModal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <a-drawer\r\n    title=\"数据规则/按钮权限配置\"\r\n    width=\"365\"\r\n    :closable=\"false\"\r\n    @close=\"onClose\"\r\n    :visible=\"visible\"\r\n  >\r\n\r\n    <a-tabs defaultActiveKey=\"1\">\r\n      <a-tab-pane tab=\"数据规则\" key=\"1\">\r\n\r\n        <a-checkbox-group v-model=\"dataruleChecked\" v-if=\"dataruleList.length>0\">\r\n          <a-row>\r\n            <a-col :span=\"24\" v-for=\"(item,index) in dataruleList\" :key=\" 'dr'+index \">\r\n              <a-checkbox :value=\"item.id\">{{ item.ruleName }}</a-checkbox>\r\n            </a-col>\r\n\r\n            <a-col :span=\"24\">\r\n              <div style=\"width: 100%;margin-top: 15px\">\r\n                <a-button @click=\"saveDataruleForRole\" type=\"primary\" size=\"small\" icon=\"save\">点击保存</a-button>\r\n              </div>\r\n            </a-col>\r\n          </a-row>\r\n        </a-checkbox-group>\r\n        <div v-else><h3>无配置信息!</h3></div>\r\n\r\n      </a-tab-pane>\r\n      <!--<a-tab-pane tab=\"按钮权限\" key=\"2\">敬请期待!!!</a-tab-pane>-->\r\n    </a-tabs>\r\n\r\n  </a-drawer>\r\n</template>\r\n\r\n<script>\r\n  import ARow from 'ant-design-vue/es/grid/Row'\r\n  import ACol from 'ant-design-vue/es/grid/Col'\r\n  import { getAction,postAction } from '@/api/manage'\r\n\r\n  export default {\r\n    name: 'RoleDataruleModal',\r\n    components: { ACol, ARow },\r\n    data(){\r\n      return {\r\n        functionId:'',\r\n        roleId:'',\r\n        visible:false,\r\n        tabList: [{\r\n          key: '1',\r\n          tab: '数据规则',\r\n        }, {\r\n          key: '2',\r\n          tab: '按钮权限',\r\n        }],\r\n        activeTabKey: '1',\r\n        url:{\r\n          datarule:\"/sys/role/datarule\",\r\n        },\r\n        dataruleList:[],\r\n        dataruleChecked:[]\r\n      }\r\n    },\r\n    methods:{\r\n      loadData(){\r\n        getAction(`${this.url.datarule}/${this.functionId}/${this.roleId}`).then(res=>{\r\n          console.log(res)\r\n          if(res.success){\r\n            this.dataruleList = res.result.datarule\r\n            let drChecked = res.result.drChecked\r\n            if(drChecked){\r\n              this.dataruleChecked = drChecked.split(\",\")\r\n            }\r\n          }\r\n        })\r\n      },\r\n      saveDataruleForRole(){\r\n        if(!this.dataruleChecked || this.dataruleChecked.length==0){\r\n          this.$message.warning(\"请注意，现未勾选任何数据权限!\")\r\n        }\r\n        let params = {\r\n          permissionId:this.functionId,\r\n          roleId:this.roleId,\r\n          dataRuleIds:this.dataruleChecked.join(\",\")\r\n        }\r\n        console.log(\"保存数据权限\",params)\r\n        postAction(this.url.datarule,params).then(res=>{\r\n          if(res.success){\r\n            this.$message.success(res.message)\r\n          }else{\r\n            this.$message.error(res.message)\r\n          }\r\n        })\r\n      },\r\n      show(functionId,roleId){\r\n        this.onReset()\r\n        this.functionId = functionId\r\n        this.roleId = roleId\r\n        this.visible=true\r\n        this.loadData()\r\n      },\r\n      onClose(){\r\n        this.visible=false\r\n        this.onReset()\r\n      },\r\n      onTabChange (key) {\r\n        this.activeTabKey = key\r\n      },\r\n      onReset(){\r\n        this.functionId=''\r\n        this.roleId=''\r\n        this.dataruleList=[]\r\n        this.dataruleChecked=[]\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"],"sourceRoot":"src/views/system/modules"}]}