{"remainingRequest":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js!D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\components\\CountDown\\CountDown.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\src\\components\\CountDown\\CountDown.vue","mtime":1615948813397},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KZnVuY3Rpb24gZml4ZWRaZXJvKHZhbCkgewogIHJldHVybiB2YWwgKiAxIDwgMTAgPyAiMCIuY29uY2F0KHZhbCkgOiB2YWw7Cn0KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQ291bnREb3duIiwKICBwcm9wczogewogICAgZm9ybWF0OiB7CiAgICAgIHR5cGU6IEZ1bmN0aW9uLAogICAgICBkZWZhdWx0OiB1bmRlZmluZWQKICAgIH0sCiAgICB0YXJnZXQ6IHsKICAgICAgdHlwZTogW0RhdGUsIE51bWJlcl0sCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9LAogICAgb25FbmQ6IHsKICAgICAgdHlwZTogRnVuY3Rpb24sCiAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkge30KICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkYXRlVGltZTogJzAnLAogICAgICBvcmlnaW5UYXJnZXRUaW1lOiAwLAogICAgICBsYXN0VGltZTogMCwKICAgICAgdGltZXI6IDAsCiAgICAgIGludGVydmFsOiAxMDAwCiAgICB9OwogIH0sCiAgZmlsdGVyczogewogICAgZm9ybWF0OiBmdW5jdGlvbiBmb3JtYXQodGltZSkgewogICAgICB2YXIgaG91cnMgPSA2MCAqIDYwICogMTAwMDsKICAgICAgdmFyIG1pbnV0ZXMgPSA2MCAqIDEwMDA7CiAgICAgIHZhciBoID0gTWF0aC5mbG9vcih0aW1lIC8gaG91cnMpOwogICAgICB2YXIgbSA9IE1hdGguZmxvb3IoKHRpbWUgLSBoICogaG91cnMpIC8gbWludXRlcyk7CiAgICAgIHZhciBzID0gTWF0aC5mbG9vcigodGltZSAtIGggKiBob3VycyAtIG0gKiBtaW51dGVzKSAvIDEwMDApOwogICAgICByZXR1cm4gIiIuY29uY2F0KGZpeGVkWmVybyhoKSwgIjoiKS5jb25jYXQoZml4ZWRaZXJvKG0pLCAiOiIpLmNvbmNhdChmaXhlZFplcm8ocykpOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuaW5pdFRpbWUoKTsKICAgIHRoaXMudGljaygpOwogIH0sCiAgbWV0aG9kczogewogICAgaW5pdFRpbWU6IGZ1bmN0aW9uIGluaXRUaW1lKCkgewogICAgICB2YXIgbGFzdFRpbWUgPSAwOwogICAgICB2YXIgdGFyZ2V0VGltZSA9IDA7CiAgICAgIHRoaXMub3JpZ2luVGFyZ2V0VGltZSA9IHRoaXMudGFyZ2V0OwoKICAgICAgdHJ5IHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHRoaXMudGFyZ2V0KSA9PT0gJ1tvYmplY3QgRGF0ZV0nKSB7CiAgICAgICAgICB0YXJnZXRUaW1lID0gdGhpcy50YXJnZXQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRhcmdldFRpbWUgPSBuZXcgRGF0ZSh0aGlzLnRhcmdldCkuZ2V0VGltZSgpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCB0YXJnZXQgcHJvcCcpOwogICAgICB9CgogICAgICBsYXN0VGltZSA9IHRhcmdldFRpbWUgLSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgdGhpcy5sYXN0VGltZSA9IGxhc3RUaW1lIDwgMCA/IDAgOiBsYXN0VGltZTsKICAgIH0sCiAgICB0aWNrOiBmdW5jdGlvbiB0aWNrKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIG9uRW5kID0gdGhpcy5vbkVuZDsKICAgICAgdGhpcy50aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChfdGhpcy5sYXN0VGltZSA8IF90aGlzLmludGVydmFsKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQoX3RoaXMudGltZXIpOwogICAgICAgICAgX3RoaXMubGFzdFRpbWUgPSAwOwoKICAgICAgICAgIGlmICh0eXBlb2Ygb25FbmQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgb25FbmQoKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXMubGFzdFRpbWUgLT0gX3RoaXMuaW50ZXJ2YWw7CgogICAgICAgICAgX3RoaXMudGljaygpOwogICAgICAgIH0KICAgICAgfSwgdGhpcy5pbnRlcnZhbCk7CiAgICB9CiAgfSwKICBiZWZvcmVVcGRhdGU6IGZ1bmN0aW9uIGJlZm9yZVVwZGF0ZSgpIHsKICAgIGlmICh0aGlzLm9yaWdpblRhcmdldFRpbWUgIT09IHRoaXMudGFyZ2V0KSB7CiAgICAgIHRoaXMuaW5pdFRpbWUoKTsKICAgIH0KICB9LAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcik7CiAgfQp9Ow=="},{"version":3,"sources":["CountDown.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <span>\r\n    {{ lastTime | format }}\r\n  </span>\r\n</template>\r\n\r\n<script>\r\n\r\n  function fixedZero(val) {\r\n    return val * 1 < 10 ? `0${val}` : val;\r\n  }\r\n\r\n  export default {\r\n    name: \"CountDown\",\r\n    props: {\r\n      format: {\r\n        type: Function,\r\n        default: undefined\r\n      },\r\n      target: {\r\n        type: [Date, Number],\r\n        required: true,\r\n      },\r\n      onEnd: {\r\n        type: Function,\r\n        default: () => {\r\n        }\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        dateTime: '0',\r\n        originTargetTime: 0,\r\n        lastTime: 0,\r\n        timer: 0,\r\n        interval: 1000\r\n      }\r\n    },\r\n    filters: {\r\n      format(time) {\r\n        const hours = 60 * 60 * 1000;\r\n        const minutes = 60 * 1000;\r\n\r\n        const h = Math.floor(time / hours);\r\n        const m = Math.floor((time - h * hours) / minutes);\r\n        const s = Math.floor((time - h * hours - m * minutes) / 1000);\r\n        return `${fixedZero(h)}:${fixedZero(m)}:${fixedZero(s)}`\r\n      }\r\n    },\r\n    created() {\r\n      this.initTime()\r\n      this.tick()\r\n    },\r\n    methods: {\r\n      initTime() {\r\n        let lastTime = 0;\r\n        let targetTime = 0;\r\n        this.originTargetTime = this.target\r\n        try {\r\n          if (Object.prototype.toString.call(this.target) === '[object Date]') {\r\n            targetTime = this.target\r\n          } else {\r\n            targetTime = new Date(this.target).getTime()\r\n          }\r\n        } catch (e) {\r\n          throw new Error('invalid target prop')\r\n        }\r\n\r\n        lastTime = targetTime - new Date().getTime();\r\n\r\n        this.lastTime = lastTime < 0 ? 0 : lastTime\r\n      },\r\n      tick() {\r\n        const {onEnd} = this\r\n\r\n        this.timer = setTimeout(() => {\r\n          if (this.lastTime < this.interval) {\r\n            clearTimeout(this.timer)\r\n            this.lastTime = 0\r\n            if (typeof onEnd === 'function') {\r\n              onEnd();\r\n            }\r\n          } else {\r\n            this.lastTime -= this.interval\r\n            this.tick()\r\n          }\r\n        }, this.interval)\r\n      }\r\n    },\r\n    beforeUpdate () {\r\n      if (this.originTargetTime !== this.target) {\r\n        this.initTime()\r\n      }\r\n    },\r\n    beforeDestroy() {\r\n      clearTimeout(this.timer)\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"],"sourceRoot":"src/components/CountDown"}]}