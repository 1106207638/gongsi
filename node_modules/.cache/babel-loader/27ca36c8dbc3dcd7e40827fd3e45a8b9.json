{"remainingRequest":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js!D:\\vue\\src\\components\\jeecg\\JVxeTable\\components\\JVxeTable.js","dependencies":[{"path":"D:\\vue\\src\\components\\jeecg\\JVxeTable\\components\\JVxeTable.js","mtime":1615948814766},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiRDpcXHZ1ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvcmVnZW5lcmF0b3IiOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsgdHJ5IHsgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOyB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOyB9IGNhdGNoIChlcnJvcikgeyByZWplY3QoZXJyb3IpOyByZXR1cm47IH0gaWYgKGluZm8uZG9uZSkgeyByZXNvbHZlKHZhbHVlKTsgfSBlbHNlIHsgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpOyB9IH0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOyB9IGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOyB9IF9uZXh0KHVuZGVmaW5lZCk7IH0pOyB9OyB9CgppbXBvcnQgWEVVdGlscyBmcm9tICd4ZS11dGlscyc7CmltcG9ydCBQcm9wVHlwZXMgZnJvbSAnYW50LWRlc2lnbi12dWUvZXMvX3V0aWwvdnVlLXR5cGVzJzsKaW1wb3J0IHsgSlZYRVR5cGVzIH0gZnJvbSAnQC9jb21wb25lbnRzL2plZWNnL0pWeGVUYWJsZS9pbmRleCc7CmltcG9ydCBWeGVXZWJTb2NrZXRNaXhpbnMgZnJvbSAnLi4vbWl4aW5zL3Z4ZS53ZWIuc29ja2V0Lm1peGlucyc7CmltcG9ydCB7IGluaXREaWN0T3B0aW9ucyB9IGZyb20gJ0AvY29tcG9uZW50cy9kaWN0L0pEaWN0U2VsZWN0VXRpbCc7CmltcG9ydCB7IGdldFJlZlByb21pc2UgfSBmcm9tICcuLi91dGlscy92eGVVdGlscyc7CmltcG9ydCB7IGdldEVuaGFuY2VkTWl4aW5zLCByZXBsYWNlUHJvcHMgfSBmcm9tICcuLi91dGlscy9jZWxsVXRpbHMnOwppbXBvcnQgSlZ4ZVRvb2xiYXIgZnJvbSAnLi9KVnhlVG9vbGJhcic7CmltcG9ydCBKVnhlU3ViUG9wb3ZlciBmcm9tICcuL0pWeGVTdWJQb3BvdmVyJzsKaW1wb3J0IEpWeGVEZXRhaWxzTW9kYWwgZnJvbSAnLi9KVnhlRGV0YWlsc01vZGFsJzsKaW1wb3J0IEpWeGVQYWdpbmF0aW9uIGZyb20gJy4vSlZ4ZVBhZ2luYXRpb24nOwppbXBvcnQgeyBjbG9uZU9iamVjdCwgZ2V0Vm1QYXJlbnRCeU5hbWUsIHB1c2hJZk5vdEV4aXN0LCByYW5kb21TdHJpbmcsIHNpbXBsZURlYm91bmNlIH0gZnJvbSAnQC91dGlscy91dGlsJzsKaW1wb3J0IHsgVXRpbFRvb2xzIH0gZnJvbSAndnhlLXRhYmxlL3BhY2thZ2VzL3Rvb2xzL3NyYy91dGlscyc7CmltcG9ydCB7IGdldE5vQXV0aENvbHMgfSBmcm9tICJAL3V0aWxzL2F1dGhGaWx0ZXIiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0pWeGVUYWJsZScsCiAgcHJvdmlkZTogZnVuY3Rpb24gcHJvdmlkZSgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgcmV0dXJuIHsKICAgICAgc3VwZXJUcmlnZ2VyOiBmdW5jdGlvbiBzdXBlclRyaWdnZXIobmFtZSwgZXZlbnQpIHsKICAgICAgICByZXR1cm4gX3RoaXMudHJpZ2dlcihuYW1lLCBldmVudCk7CiAgICAgIH0KICAgIH07CiAgfSwKICBtaXhpbnM6IFtWeGVXZWJTb2NrZXRNaXhpbnNdLAogIGNvbXBvbmVudHM6IHsKICAgIEpWeGVUb29sYmFyOiBKVnhlVG9vbGJhciwKICAgIEpWeGVTdWJQb3BvdmVyOiBKVnhlU3ViUG9wb3ZlciwKICAgIEpWeGVEZXRhaWxzTW9kYWw6IEpWeGVEZXRhaWxzTW9kYWwsCiAgICBKVnhlUGFnaW5hdGlvbjogSlZ4ZVBhZ2luYXRpb24KICB9LAogIHByb3BzOiB7CiAgICByb3dLZXk6IFByb3BUeXBlcy5zdHJpbmcuZGVmKCdpZCcpLAogICAgLy8g5YiX5L+h5oGvCiAgICBjb2x1bW5zOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfSwKICAgIC8vIOaVsOaNrua6kAogICAgZGF0YVNvdXJjZTogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICBhdXRoUHJlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICBkZWZhdWx0OiAnJwogICAgfSwKICAgIGlzb25saW5lOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICAvLyDmmK/lkKbmmL7npLrlt6XlhbfmoI8KICAgIHRvb2xiYXI6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9LAogICAgaW1wb3J0QnRuOiBCb29sZWFuLAogICAgLy8g5bel5YW35qCP6YWN572uCiAgICB0b29sYmFyQ29uZmlnOiBQcm9wVHlwZXMub2JqZWN0LmRlZihmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgLy8gcHJlZml4IOWJjee8gO+8m3N1ZmZpeCDlkI7nvIDvvJsKICAgICAgICBzbG90czogWydwcmVmaXgnLCAnc3VmZml4J10sCiAgICAgICAgLy8gYWRkIOaWsOWinuaMiemSru+8m3JlbW92ZSDliKDpmaTmjInpkq7vvJtjbGVhclNlbGVjdGlvbiDmuIXnqbrpgInmi6nmjInpkq7vvJtjb2xsYXBzZSDlsZXlvIDmlLbotbcKICAgICAgICBidG5zOiBbJ2FkZCcsICdyZW1vdmUnLCAnY2xlYXJTZWxlY3Rpb24nXQogICAgICB9OwogICAgfSksCiAgICAvLyDmmK/lkKbmmL7npLrooYzlj7cKICAgIHJvd051bWJlcjogUHJvcFR5cGVzLmJvb2wuZGVmKGZhbHNlKSwKICAgIC8vIOaYr+WQpuWPr+mAieaLqeihjAogICAgcm93U2VsZWN0aW9uOiBQcm9wVHlwZXMuYm9vbC5kZWYoZmFsc2UpLAogICAgLy8g6YCJ5oup6KGM57G75Z6LCiAgICByb3dTZWxlY3Rpb25UeXBlOiBQcm9wVHlwZXMub25lT2YoWydjaGVja2JveCcsICdyYWRpbyddKS5kZWYoJ2NoZWNrYm94JyksCiAgICAvLyDmmK/lkKblj6/lsZXlvIDooYwKICAgIHJvd0V4cGFuZDogUHJvcFR5cGVzLmJvb2wuZGVmKGZhbHNlKSwKICAgIC8vIOWxleW8gOihjOmFjee9rgogICAgZXhwYW5kQ29uZmlnOiBQcm9wVHlwZXMub2JqZWN0LmRlZihmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB7fTsKICAgIH0pLAogICAgLy8g6aG16Z2i5piv5ZCm5Zyo5Yqg6L295LitCiAgICBsb2FkaW5nOiBQcm9wVHlwZXMuYm9vbC5kZWYoZmFsc2UpLAogICAgaGVpZ2h0OiBQcm9wVHlwZXMuaW5zdGFuY2VPZihbTnVtYmVyLCBTdHJpbmddKS5kZWYoJ2F1dG8nKSwKICAgIC8vIOacgOWkp+mrmOW6pgogICAgbWF4SGVpZ2h0OiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0sCiAgICAvLyDopoHnpoHnlKjnmoTooYwgVE9ETyDmnKrlrp7njrAKICAgIGRpc2FibGVkUm93czogUHJvcFR5cGVzLm9iamVjdC5kZWYoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4ge307CiAgICB9KSwKICAgIC8vIOaYr+WQpuemgeeUqOWFqOmDqOe7hOS7tgogICAgZGlzYWJsZWQ6IFByb3BUeXBlcy5ib29sLmRlZihmYWxzZSksCiAgICAvLyDmmK/lkKblj6/mi5bmi73mjpLluo8gVE9ETyDku4Xlrp7njrDkuIrkuIvmjpLluo/vvIzmnKrlrp7njrDmi5bmi73mjpLluo/vvIjlj6/og73ml6Dms5Xlrp7njrDmiJbovoPkuLrlm7Dpmr7vvIkKICAgIGRyYWdTb3J0OiBQcm9wVHlwZXMuYm9vbC5kZWYoZmFsc2UpLAogICAgLy8g5o6S5bqP5a2X5q615L+d5a2Y55qES2V5CiAgICBkcmFnU29ydEtleTogUHJvcFR5cGVzLnN0cmluZy5kZWYoJ29yZGVyTnVtJyksCiAgICAvLyDlpKflsI/vvIzlj6/pgInlgLzmnInvvJptZWRpdW3vvIjkuK3vvInjgIFzbWFsbO+8iOWwj++8ieOAgW1pbmnvvIjlvq7vvInjgIF0aW5577yI6Z2e5bi45bCP77yJCiAgICBzaXplOiBQcm9wVHlwZXMub25lT2YoWydtZWRpdW0nLCAnc21hbGwnLCAnbWluaScsICd0aW55J10pLmRlZignbWVkaXVtJyksCiAgICAvLyDmmK/lkKbmmL7npLrovrnmoYbnur8KICAgIGJvcmRlcmVkOiBQcm9wVHlwZXMuYm9vbC5kZWYoZmFsc2UpLAogICAgLy8g5YiG6aG15Zmo5Y+C5pWw77yM6K6+572u5LqG5Y2z5Y+v5pi+56S65YiG6aG15ZmoCiAgICBwYWdpbmF0aW9uOiBQcm9wVHlwZXMub2JqZWN0LmRlZihmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB7fTsKICAgIH0pLAogICAgLy8g54K55Ye76KGM5pe25piv5ZCm5pi+56S65a2Q6KGo5Y2VCiAgICBjbGlja1Jvd1Nob3dTdWJGb3JtOiBQcm9wVHlwZXMuYm9vbC5kZWYoZmFsc2UpLAogICAgLy8g54K55Ye76KGM5pe25piv5ZCm5pi+56S65Li76KGo5Y2VCiAgICBjbGlja1Jvd1Nob3dNYWluRm9ybTogUHJvcFR5cGVzLmJvb2wuZGVmKGZhbHNlKSwKICAgIC8vIOaYr+WQpueCueWHu+mAieS4reihjO+8jOS8mOWFiOe6p+acgOS9jgogICAgY2xpY2tTZWxlY3RSb3c6IFByb3BUeXBlcy5ib29sLmRlZihmYWxzZSksCiAgICAvLyDmmK/lkKblvIDlkK8gcmVsb2FkIOaVsOaNruaViOaenAogICAgcmVsb2FkRWZmZWN0OiBQcm9wVHlwZXMuYm9vbC5kZWYoZmFsc2UpLAogICAgLy8g5qCh6aqM6KeE5YiZCiAgICBSdWxlczogUHJvcFR5cGVzLm9iamVjdC5kZWYoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4ge307CiAgICB9KSwKICAgIC8vIOaYr+WQpuW8guatpeWIoOmZpOihjO+8jOWmguaenOS9oOimgeWunueOsOW8guatpeWIoOmZpO+8jOmCo+S5iOmcgOimgeaKiui/meS4qumAiemhueW8gOWQr++8jAogICAgLy8g5ZyocmVtb3Zl5LqL5Lu26YeM6LCD55SoY29uZmlybVJlbW92ZeaWueazleaJjeS8muecn+ato+WIoOmZpO+8iOmZpOmdnuWIoOmZpOeahOWFqOaYr+aWsOWinueahOihjO+8iQogICAgYXN5bmNSZW1vdmU6IFByb3BUeXBlcy5ib29sLmRlZihmYWxzZSkKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpc0pWWEVUYWJsZTogdHJ1ZSwKICAgICAgLy8gY2FzZUlk77yM6KGo5qC85ZSv5LiA5qCH6K+GCiAgICAgIGNhc2VJZDogIl9qLXZ4ZS0iLmNvbmNhdChyYW5kb21TdHJpbmcoOCksICJfIiksCiAgICAgIC8vIOWGhee9rmNvbHVtbnMKICAgICAgX2lubmVyQ29sdW1uczogW10sCiAgICAgIC8vIOWGhee9riBFZGl0UnVsZXMKICAgICAgX2lubmVyRWRpdFJ1bGVzOiBbXSwKICAgICAgLy8g6K6w5b2V5rua5Yqo5p2h5L2N572uCiAgICAgIHNjcm9sbDogewogICAgICAgIHRvcDogMCwKICAgICAgICBsZWZ0OiAwCiAgICAgIH0sCiAgICAgIC8vIOW9k+WJjeaYr+WQpuato+WcqOa7muWKqAogICAgICBzY3JvbGxpbmc6IGZhbHNlLAogICAgICAvLyB2eGUg6buY6K6k6YWN572uCiAgICAgIGRlZmF1bHRWeGVQcm9wczogewogICAgICAgICdyb3ctaWQnOiB0aGlzLnJvd0tleSwKICAgICAgICAvLyDpq5jkuq5ob3ZlcueahOihjAogICAgICAgICdoaWdobGlnaHQtaG92ZXItcm93JzogdHJ1ZSwKICAgICAgICAvLyDmuqLlh7rpmpDol4/lubbmmL7npLp0b29sdGlwCiAgICAgICAgJ3Nob3ctb3ZlcmZsb3cnOiB0cnVlLAogICAgICAgIC8vIOihqOWktOa6ouWHuumakOiXj+W5tuaYvuekunRvb2x0aXAKICAgICAgICAnc2hvdy1oZWFkZXItb3ZlcmZsb3cnOiB0cnVlLAogICAgICAgICdzaG93LWZvb3Rlci1vdmVyZmxvdyc6IHRydWUsCiAgICAgICAgLy8g5Y+v57yW6L6R6YWN572uCiAgICAgICAgJ2VkaXQtY29uZmlnJzogewogICAgICAgICAgdHJpZ2dlcjogJ2NsaWNrJywKICAgICAgICAgIG1vZGU6ICdjZWxsJywKICAgICAgICAgIHNob3dJY29uOiBmYWxzZQogICAgICAgIH0sCiAgICAgICAgJ2V4cGFuZC1jb25maWcnOiB7CiAgICAgICAgICBpY29uQ2xvc2U6ICdhbnQtdGFibGUtcm93LWV4cGFuZC1pY29uIGFudC10YWJsZS1yb3ctY29sbGFwc2VkJywKICAgICAgICAgIGljb25PcGVuOiAnYW50LXRhYmxlLXJvdy1leHBhbmQtaWNvbiBhbnQtdGFibGUtcm93LWV4cGFuZGVkJwogICAgICAgIH0sCiAgICAgICAgLy8g6Jma5ouf5rua5Yqo6YWN572u77yMeei9tOWkp+S6jjMw5p2h5pWw5o2u5pe25ZCv55So6Jma5ouf5rua5YqoCiAgICAgICAgLy8gJ3Njcm9sbC15JzogewogICAgICAgIC8vICAgZ3Q6IDMwCiAgICAgICAgLy8gfSwKICAgICAgICAvLyAnc2Nyb2xsLXgnOiB7CiAgICAgICAgLy8gICBndDogMTUKICAgICAgICAvLyB9LAogICAgICAgICdyYWRpby1jb25maWcnOiB7CiAgICAgICAgICBoaWdobGlnaHQ6IHRydWUKICAgICAgICB9LAogICAgICAgICdjaGVja2JveC1jb25maWcnOiB7CiAgICAgICAgICBoaWdobGlnaHQ6IHRydWUKICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIOe7keWumuW3puS+p+mAieaLqeahhgogICAgICBzZWxlY3RlZFJvd3M6IFtdLAogICAgICAvLyDnu5Hlrprlt6bkvqfpgInmi6nmoYblt7LpgInmi6nnmoRpZAogICAgICBzZWxlY3RlZFJvd0lkczogW10sCiAgICAgIC8vIOe7n+iuoeWIl+mFjee9rgogICAgICBzdGF0aXN0aWNzOiB7CiAgICAgICAgaGFzOiBmYWxzZSwKICAgICAgICBzdW06IFtdLAogICAgICAgIGF2ZXJhZ2U6IFtdCiAgICAgIH0sCiAgICAgIC8vIOWFgeiuuOaJp+ihjOWIt+aWsOeJueaViOeahOihjElECiAgICAgIHJlbG9hZEVmZmVjdFJvd0tleXNNYXA6IHt9LAogICAgICAvL+mFjee9ruS6huS9huaYr+ayoeacieaOiOadg+eahOaMiemSruWSjOWIlyDpm4blkIgKICAgICAgZXhjbHVkZUNvZGU6IFtdCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC8vIHZ4ZSDmnIDnu4ggY29sdW1ucwogICAgdnhlQ29sdW1uczogZnVuY3Rpb24gdnhlQ29sdW1ucygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLl9pbm5lckNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7CiAgICAgICAgdmFyIHJlbmRlck9wdGlvbnMgPSB7CiAgICAgICAgICBjYXNlSWQ6IF90aGlzMi5jYXNlSWQsCiAgICAgICAgICBib3JkZXJlZDogX3RoaXMyLmJvcmRlcmVkLAogICAgICAgICAgZGlzYWJsZWQ6IF90aGlzMi5kaXNhYmxlZCwKICAgICAgICAgIHNjcm9sbGluZzogX3RoaXMyLnNjcm9sbGluZywKICAgICAgICAgIHJlbG9hZEVmZmVjdDogX3RoaXMyLnJlbG9hZEVmZmVjdCwKICAgICAgICAgIHJlbG9hZEVmZmVjdFJvd0tleXNNYXA6IF90aGlzMi5yZWxvYWRFZmZlY3RSb3dLZXlzTWFwLAogICAgICAgICAgbGlzdGVuZXJzOiBfdGhpczIuY2VsbExpc3RlbmVycwogICAgICAgIH07CgogICAgICAgIGlmIChjb2x1bW4uJHR5cGUgPT09IEpWWEVUeXBlcy5yb3dEcmFnU29ydCkgewogICAgICAgICAgcmVuZGVyT3B0aW9ucy5kcmFnU29ydEtleSA9IF90aGlzMi5kcmFnU29ydEtleTsKICAgICAgICB9IC8vIHNsb3Qg57uE5Lu254m55q6K5aSE55CGCgoKICAgICAgICBpZiAoY29sdW1uLiR0eXBlID09PSBKVlhFVHlwZXMuc2xvdCkgewogICAgICAgICAgaWYgKF90aGlzMi4kc2NvcGVkU2xvdHMuaGFzT3duUHJvcGVydHkoY29sdW1uLnNsb3ROYW1lKSkgewogICAgICAgICAgICByZW5kZXJPcHRpb25zLnNsb3QgPSBfdGhpczIuJHNjb3BlZFNsb3RzW2NvbHVtbi5zbG90TmFtZV07CiAgICAgICAgICAgIHJlbmRlck9wdGlvbnMudGFyZ2V0ID0gX3RoaXMyOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGNvbHVtbi5lZGl0UmVuZGVyKSB7CiAgICAgICAgICBPYmplY3QuYXNzaWduKGNvbHVtbi5lZGl0UmVuZGVyLCByZW5kZXJPcHRpb25zKTsKICAgICAgICB9CgogICAgICAgIGlmIChjb2x1bW4uY2VsbFJlbmRlcikgewogICAgICAgICAgT2JqZWN0LmFzc2lnbihjb2x1bW4uY2VsbFJlbmRlciwgcmVuZGVyT3B0aW9ucyk7CiAgICAgICAgfSAvLyB1cGRhdGUtLWJlZ2luLS1hdXRvcjpsdmRhbmRhbi0tLS0tZGF0ZToyMDIwMTAxOS0tLS0tLWZvcjpMT1dDT0QtODgyIOOAkOaWsOihjOe8lui+keOAkeWIl+ihqOS4iuW4puaMiemSrueahOmBruaMoemXrumimAoKCiAgICAgICAgaWYgKGNvbHVtbi4kdHlwZSA9PT0gSlZYRVR5cGVzLmZpbGUgfHwgY29sdW1uLiR0eXBlID09PSBKVlhFVHlwZXMuaW1hZ2UpIHsKICAgICAgICAgIGlmIChjb2x1bW4ud2lkdGggJiYgY29sdW1uLndpZHRoLmVuZHNXaXRoKCdweCcpKSB7CiAgICAgICAgICAgIGNvbHVtbi53aWR0aCA9IE51bWJlci5wYXJzZUludChjb2x1bW4ud2lkdGguc3Vic3RyKDAsIGNvbHVtbi53aWR0aC5sZW5ndGggLSAyKSkgKyBOdW1iZXIucGFyc2VJbnQoMSkgKyAncHgnOwogICAgICAgICAgfQogICAgICAgIH0gLy8gdXBkYXRlLS1iZWdpbi0tYXV0b3I6bHZkYW5kYW4tLS0tLWRhdGU6MjAyMDEwMTktLS0tLS1mb3I6TE9XQ09ELTg4MiDjgJDmlrDooYznvJbovpHjgJHliJfooajkuIrluKbmjInpkq7nmoTpga7mjKHpl67popgKCiAgICAgIH0pOwoKICAgICAgcmV0dXJuIHRoaXMuX2lubmVyQ29sdW1uczsKICAgIH0sCiAgICAvLyB2eGUg5pyA57uIIGVkaXRSdWxlcwogICAgdnhlRWRpdFJ1bGVzOiBmdW5jdGlvbiB2eGVFZGl0UnVsZXMoKSB7CiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmVkaXRSdWxlcywgdGhpcy5faW5uZXJFZGl0UnVsZXMpOwogICAgfSwKICAgIC8vIHZ4ZSDmnIDnu4ggcHJvcHMKICAgIHZ4ZVByb3BzOiBmdW5jdGlvbiB2eGVQcm9wcygpIHsKICAgICAgdmFyIGV4cGFuZENvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdFZ4ZVByb3BzWydleHBhbmQtY29uZmlnJ10sIHRoaXMuZXhwYW5kQ29uZmlnKTsKICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdFZ4ZVByb3BzLCB7CiAgICAgICAgc2hvd0Zvb3RlcjogdGhpcy5zdGF0aXN0aWNzLmhhcwogICAgICB9LCB0aGlzLiRhdHRycywgewogICAgICAgIGxvYWRpbmc6IHRoaXMubG9hZGluZywKICAgICAgICBjb2x1bW5zOiB0aGlzLnZ4ZUNvbHVtbnMsCiAgICAgICAgZWRpdFJ1bGVzOiB0aGlzLnZ4ZUVkaXRSdWxlcywKICAgICAgICAvLyBkYXRhOiB0aGlzLmRhdGFTb3VyY2UsCiAgICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodCA9PT0gJ2F1dG8nID8gbnVsbCA6IHRoaXMuaGVpZ2h0LAogICAgICAgIG1heEhlaWdodDogdGhpcy5tYXhIZWlnaHQsCiAgICAgICAgYm9yZGVyOiB0aGlzLmJvcmRlcmVkLAogICAgICAgIGV4cGFuZENvbmZpZzogZXhwYW5kQ29uZmlnLAogICAgICAgIGZvb3Rlck1ldGhvZDogdGhpcy5oYW5kbGVGb290ZXJNZXRob2QgLy8gZm9vdGVyU3Bhbk1ldGhvZDogdGhpcy5oYW5kbGVGb290ZXJTcGFuTWV0aG9kLAoKICAgICAgfSk7CiAgICB9LAogICAgLy8gdnhlIOacgOe7iCBldmVudHMKICAgIHZ4ZUV2ZW50czogZnVuY3Rpb24gdnhlRXZlbnRzKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIC8vIOWGhee9ruS6i+S7tgogICAgICB2YXIgZXZlbnRzID0gewogICAgICAgICdzY3JvbGwnOiB0aGlzLmhhbmRsZVZ4ZVNjcm9sbCwKICAgICAgICAnY2VsbC1jbGljayc6IHRoaXMuaGFuZGxlQ2VsbENsaWNrLAogICAgICAgICdlZGl0LWNsb3NlZCc6IHRoaXMuaGFuZGxlRWRpdENsb3NlZCwKICAgICAgICAnZWRpdC1hY3RpdmVkJzogdGhpcy5oYW5kbGVFZGl0QWN0aXZlZCwKICAgICAgICAncmFkaW8tY2hhbmdlJzogdGhpcy5oYW5kbGVWeGVSYWRpb0NoYW5nZSwKICAgICAgICAnY2hlY2tib3gtYWxsJzogdGhpcy5oYW5kbGVWeGVDaGVja2JveEFsbCwKICAgICAgICAnY2hlY2tib3gtY2hhbmdlJzogdGhpcy5oYW5kbGVWeGVDaGVja2JveENoYW5nZQogICAgICB9OyAvLyDnlKjmiLfkvKDpgJLnmoTkuovku7bvvIzov5vooYzlkIjlubbmk43kvZwKCiAgICAgIE9iamVjdC5rZXlzKHRoaXMuJGxpc3RlbmVycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgdmFyIGxpc3RlbiA9IF90aGlzMy4kbGlzdGVuZXJzW2tleV07CgogICAgICAgIGlmIChldmVudHMuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobGlzdGVuKSkgewogICAgICAgICAgICBsaXN0ZW4ucHVzaChldmVudHNba2V5XSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsaXN0ZW4gPSBbZXZlbnRzW2tleV0sIGxpc3Rlbl07CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBldmVudHNba2V5XSA9IGxpc3RlbjsKICAgICAgfSk7CiAgICAgIHJldHVybiBldmVudHM7CiAgICB9LAogICAgLy8g57uE5Lu255uR5ZCs5LqL5Lu2CiAgICBjZWxsTGlzdGVuZXJzOiBmdW5jdGlvbiBjZWxsTGlzdGVuZXJzKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHJldHVybiB7CiAgICAgICAgdHJpZ2dlcjogZnVuY3Rpb24gdHJpZ2dlcihuYW1lLCBldmVudCkgewogICAgICAgICAgcmV0dXJuIF90aGlzNC50cmlnZ2VyKG5hbWUsIGV2ZW50KTsKICAgICAgICB9LAogICAgICAgIHZhbHVlQ2hhbmdlOiBmdW5jdGlvbiB2YWx1ZUNoYW5nZShldmVudCkgewogICAgICAgICAgcmV0dXJuIF90aGlzNC50cmlnZ2VyKCd2YWx1ZUNoYW5nZScsIGV2ZW50KTsKICAgICAgICB9LAoKICAgICAgICAvKiog5b2T5YmN6KGM5ZCR5LiK56e75LiA5L2NICovCiAgICAgICAgcm93TW92ZVVwOiBmdW5jdGlvbiByb3dNb3ZlVXAocm93SW5kZXgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczQucm93UmVzb3J0KHJvd0luZGV4LCByb3dJbmRleCAtIDEpOwogICAgICAgIH0sCgogICAgICAgIC8qKiDlvZPliY3ooYzlkJHkuIvnp7vkuIDkvY0gKi8KICAgICAgICByb3dNb3ZlRG93bjogZnVuY3Rpb24gcm93TW92ZURvd24ocm93SW5kZXgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczQucm93UmVzb3J0KHJvd0luZGV4LCByb3dJbmRleCArIDEpOwogICAgICAgIH0sCgogICAgICAgIC8qKiDlnKjlvZPliY3ooYzkuIvpnaLmj5LlhaXkuIDooYwgKi8KICAgICAgICByb3dJbnNlcnREb3duOiBmdW5jdGlvbiByb3dJbnNlcnREb3duKHJvd0luZGV4KSB7CiAgICAgICAgICByZXR1cm4gX3RoaXM0Lmluc2VydFJvd3Moe30sIHJvd0luZGV4ICsgMSk7CiAgICAgICAgfQogICAgICB9OwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIGRhdGFTb3VyY2U6IHsKICAgICAgLy8gICBkZWVwOiB0cnVlLAogICAgICBpbW1lZGlhdGU6IHRydWUsCiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX2hhbmRsZXIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICAgICAgdmFyIHZ4ZTsKICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UmVmUHJvbWlzZSh0aGlzLCAndnhlJyk7CgogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICB2eGUgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgICAgLy8g6Zi75patdnVl55uR5ZCs5aSn5pWw5o2u77yM5o+Q6auY5oCn6IO9CiAgICAgICAgICAgICAgICAgIC8vIOW8gOWQr+S6huaOkuW6j+WwseiHquWKqOiuoeeul+aOkuW6j+WAvAogICAgICAgICAgICAgICAgICBpZiAodGhpcy5kcmFnU29ydCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNvdXJjZS5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhLCBpZHgpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS4kc2V0KGRhdGEsIF90aGlzNS5kcmFnU29ydEtleSwgaWR4ICsgMSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHZ4ZS5sb2FkRGF0YSh0aGlzLmRhdGFTb3VyY2UpOyAvLyBUT0RPIOino+aekGRpc2FibGVkUm93cwogICAgICAgICAgICAgICAgICAvLyBsZXQgZGlzYWJsZWQgPSBmYWxzZQogICAgICAgICAgICAgICAgICAvLwogICAgICAgICAgICAgICAgICAvLyBsZXQgZGlzYWJsZWRSb3dJZHMgPSAodGhpcy5kaXNhYmxlZFJvd0lkcyB8fCBbXSkKICAgICAgICAgICAgICAgICAgLy8gLy8g6Kej5p6QZGlzYWJsZWRSb3dzCiAgICAgICAgICAgICAgICAgIC8vIE9iamVjdC5rZXlzKHRoaXMuZGlzYWJsZWRSb3dzKS5mb3JFYWNoKGRpc2FibGVkQ29sS2V5ID0+IHsKICAgICAgICAgICAgICAgICAgLy8gICAvLyDliKTmlq3mmK/lkKbmnInor6XlsZ7mgKcKICAgICAgICAgICAgICAgICAgLy8gICBpZiAoZGF0YS5oYXNPd25Qcm9wZXJ0eShkaXNhYmxlZENvbEtleSkpIHsKICAgICAgICAgICAgICAgICAgLy8gICAgIGlmIChkaXNhYmxlZCAhPT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICAvLyAgICAgICBsZXQgdGVtcCA9IHRoaXMuZGlzYWJsZWRSb3dzW2Rpc2FibGVkQ29sS2V5XQogICAgICAgICAgICAgICAgICAvLyAgICAgICAvLyDnpoHnlKjop4TliJnlj6/ku6XmmK/kuIDkuKrmlbDnu4QKICAgICAgICAgICAgICAgICAgLy8gICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGVtcCkpIHsKICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBkaXNhYmxlZCA9IHRlbXAuaW5jbHVkZXMoZGF0YVtkaXNhYmxlZENvbEtleV0pCiAgICAgICAgICAgICAgICAgIC8vICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgZGlzYWJsZWQgPSAodGVtcCA9PT0gZGF0YVtkaXNhYmxlZENvbEtleV0pCiAgICAgICAgICAgICAgICAgIC8vICAgICAgIH0KICAgICAgICAgICAgICAgICAgLy8gICAgICAgaWYgKGRpc2FibGVkKSB7CiAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgZGlzYWJsZWRSb3dJZHMucHVzaChyb3cuaWQpCiAgICAgICAgICAgICAgICAgIC8vICAgICAgIH0KICAgICAgICAgICAgICAgICAgLy8gICAgIH0KICAgICAgICAgICAgICAgICAgLy8gICB9CiAgICAgICAgICAgICAgICAgIC8vIH0pCgogICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIF9jYWxsZWUsIHRoaXMpOwogICAgICAgIH0pKTsKCiAgICAgICAgZnVuY3Rpb24gaGFuZGxlcigpIHsKICAgICAgICAgIHJldHVybiBfaGFuZGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGhhbmRsZXI7CiAgICAgIH0oKQogICAgfSwKICAgIGNvbHVtbnM6IHsKICAgICAgaW1tZWRpYXRlOiB0cnVlLAogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKGNvbHVtbnMpIHsKICAgICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgICAgLy/ojrflj5bkuI3pnIDopoHmmL7npLrliJcKICAgICAgICB0aGlzLmxvYWRFeGNsdWRlQ29kZSgpOwogICAgICAgIHZhciBfaW5uZXJDb2x1bW5zID0gW107CiAgICAgICAgdmFyIF9pbm5lckVkaXRSdWxlcyA9IHt9OwogICAgICAgIHZhciByb3dOdW1iZXIgPSB0aGlzLnJvd051bWJlciwKICAgICAgICAgICAgcm93U2VsZWN0aW9uID0gdGhpcy5yb3dTZWxlY3Rpb24sCiAgICAgICAgICAgIHJvd0V4cGFuZCA9IHRoaXMucm93RXhwYW5kLAogICAgICAgICAgICBkcmFnU29ydCA9IHRoaXMuZHJhZ1NvcnQ7CiAgICAgICAgdmFyIGV4cGFuZENvbHVtbiwgc2VxQ29sdW1uLCBjaGVja2JveENvbHVtbiwgcmFkaW9Db2x1bW4sIGRyYWdTb3J0Q29sdW1uOwoKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjb2x1bW5zKSkgewogICAgICAgICAgdGhpcy5zdGF0aXN0aWNzLmhhcyA9IGZhbHNlOwogICAgICAgICAgdGhpcy5zdGF0aXN0aWNzLnN1bSA9IFtdOwogICAgICAgICAgdGhpcy5zdGF0aXN0aWNzLmF2ZXJhZ2UgPSBbXTsgLy8g5aSE55CG5oiQdnhl5Y+v6K+G5Yir55qEY29sdW1ucwoKICAgICAgICAgIGNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7CiAgICAgICAgICAgIGlmIChfdGhpczYuZXhjbHVkZUNvZGUuaW5kZXhPZihjb2x1bW4ua2V5KSA+PSAwKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY29sID0gX29iamVjdFNwcmVhZCh7fSwgY29sdW1uKTsKCiAgICAgICAgICAgIHZhciB0eXBlID0gY29sLnR5cGU7CiAgICAgICAgICAgIHZhciBlbmhhbmNlZCA9IGdldEVuaGFuY2VkTWl4aW5zKHR5cGUpOwoKICAgICAgICAgICAgaWYgKHR5cGUgPT09IEpWWEVUeXBlcy5yb3dOdW1iZXIpIHsKICAgICAgICAgICAgICBzZXFDb2x1bW4gPSBjb2w7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gSlZYRVR5cGVzLnJvd0NoZWNrYm94KSB7CiAgICAgICAgICAgICAgY2hlY2tib3hDb2x1bW4gPSBjb2w7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gSlZYRVR5cGVzLnJvd1JhZGlvKSB7CiAgICAgICAgICAgICAgcmFkaW9Db2x1bW4gPSBjb2w7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gSlZYRVR5cGVzLnJvd0V4cGFuZCkgewogICAgICAgICAgICAgIGV4cGFuZENvbHVtbiA9IGNvbDsKICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBKVlhFVHlwZXMucm93RHJhZ1NvcnQpIHsKICAgICAgICAgICAgICBkcmFnU29ydENvbHVtbiA9IGNvbDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb2wuZmllbGQgPSBjb2wua2V5OyAvLyDpmLLmraLlkox2eGVUYWJsZeiHquW4pueahHR5cGXotbflhrLnqoEKCiAgICAgICAgICAgICAgY29sLiR0eXBlID0gY29sLnR5cGU7CiAgICAgICAgICAgICAgZGVsZXRlIGNvbC50eXBlOwogICAgICAgICAgICAgIHZhciByZW5kZXJOYW1lID0gJ2NlbGxSZW5kZXInLAogICAgICAgICAgICAgICAgICByZW5kZXJPcHRpb25zID0gewogICAgICAgICAgICAgICAgbmFtZTogSlZYRVR5cGVzLl9wcmVmaXggKyB0eXBlCiAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgICAgIC8vIGhpZGRlbiDmmK/nibnmrornmoTnu4Tku7YKICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSBKVlhFVHlwZXMuaGlkZGVuKSB7CiAgICAgICAgICAgICAgICAgIGNvbC52aXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVuaGFuY2VkLnN3aXRjaGVzLmVkaXRSZW5kZXIpIHsKICAgICAgICAgICAgICAgICAgcmVuZGVyTmFtZSA9ICdlZGl0UmVuZGVyJzsKICAgICAgICAgICAgICAgICAgcmVuZGVyT3B0aW9ucy50eXBlID0gZW5oYW5jZWQuc3dpdGNoZXMudmlzaWJsZSA/ICd2aXNpYmxlJyA6ICdkZWZhdWx0JzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmVuZGVyT3B0aW9ucy5uYW1lID0gSlZYRVR5cGVzLl9wcmVmaXggKyBKVlhFVHlwZXMubm9ybWFsOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29sW3JlbmRlck5hbWVdID0gcmVuZGVyT3B0aW9uczsgLy8g5aSE55CG5a2X5YW4CgogICAgICAgICAgICAgIGlmIChjb2wuZGljdENvZGUpIHsKICAgICAgICAgICAgICAgIF90aGlzNi5fbG9hZERpY3RDb25jYXRUb09wdGlvbnMoY29sKTsKICAgICAgICAgICAgICB9IC8vIOWkhOeQhuagoemqjAoKCiAgICAgICAgICAgICAgaWYgKGNvbC52YWxpZGF0ZVJ1bGVzKSB7CiAgICAgICAgICAgICAgICB2YXIgcnVsZXMgPSBbXTsKCiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjb2wudmFsaWRhdGVSdWxlcykpIHsKICAgICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlOwogICAgICAgICAgICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkOwoKICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBjb2wudmFsaWRhdGVSdWxlc1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWUpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBydWxlID0gX3N0ZXAudmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVwbGFjZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogcmVwbGFjZVByb3BzKGNvbCwgcnVsZS5tZXNzYWdlKQogICAgICAgICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAgICAgICBpZiAocnVsZS51bmlxdWUgfHwgcnVsZS5wYXR0ZXJuID09PSAnb25seScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8g5ZSv5LiA5qCh6aqM5ZmoCiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUudmFsaWRhdG9yID0gdW5pcXVlVmFsaWRhdG9yLmJpbmQoX3RoaXM2KTsKICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocnVsZS5wYXR0ZXJuKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOmdnuepugogICAgICAgICAgICAgICAgICAgICAgICBpZiAocnVsZS5wYXR0ZXJuID09PSBmb29QYXR0ZXJuc1swXS52YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUucmVxdWlyZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBydWxlLnBhdHRlcm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5YW85a65T25saW5l6KGo5Y2V55qE54m55q6K6KeE5YiZCiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yMiA9IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSBmb29QYXR0ZXJuc1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMjsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IChfc3RlcDIgPSBfaXRlcmF0b3IyLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm9vID0gX3N0ZXAyLnZhbHVlOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvby52YWx1ZSA9PT0gcnVsZS5wYXR0ZXJuKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5wYXR0ZXJuID0gZm9vLnBhdHRlcm47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yMiA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvcjIgPSBlcnI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgJiYgX2l0ZXJhdG9yMi5yZXR1cm4gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIucmV0dXJuKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHJ1bGUuaGFuZGxlciA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgICAgICAgICAvLyDoh6rlrprkuYnlh73mlbDmoKHpqowKICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS52YWxpZGF0b3IgPSBoYW5kbGVyQ29udmVydFRvVmFsaWRhdG9yLmJpbmQoX3RoaXM2KTsKICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICBydWxlcy5wdXNoKE9iamVjdC5hc3NpZ24oe30sIHJ1bGUsIHJlcGxhY2UpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IGVycjsKICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvci5yZXR1cm4gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfaW5uZXJFZGl0UnVsZXNbY29sLmtleV0gPSBydWxlczsKICAgICAgICAgICAgICB9IC8vIOWkhOeQhue7n+iuoeWIlwogICAgICAgICAgICAgIC8vIHN1bSA9IOaxguWSjOOAgWF2ZXJhZ2UgPSDlubPlnYflgLwKCgogICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbC5zdGF0aXN0aWNzKSkgewogICAgICAgICAgICAgICAgX3RoaXM2LnN0YXRpc3RpY3MuaGFzID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGNvbC5zdGF0aXN0aWNzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgdmFyIGFyciA9IF90aGlzNi5zdGF0aXN0aWNzW2l0ZW0udG9Mb3dlckNhc2UoKV07CgogICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7CiAgICAgICAgICAgICAgICAgICAgcHVzaElmTm90RXhpc3QoYXJyLCBjb2wua2V5KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfaW5uZXJDb2x1bW5zLnB1c2goY29sKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSAvLyDliKTmlq3mmK/lkKblvIDlkK/kuobluo/lj7cKCgogICAgICAgIGlmIChyb3dOdW1iZXIpIHsKICAgICAgICAgIHZhciBjb2wgPSB7CiAgICAgICAgICAgIHR5cGU6ICdzZXEnLAogICAgICAgICAgICB0aXRsZTogJyMnLAogICAgICAgICAgICB3aWR0aDogNjAsCiAgICAgICAgICAgIGZpeGVkOiAnbGVmdCcsCiAgICAgICAgICAgIGFsaWduOiAnY2VudGVyJwogICAgICAgICAgfTsKCiAgICAgICAgICBpZiAoc2VxQ29sdW1uKSB7CiAgICAgICAgICAgIGNvbCA9IE9iamVjdC5hc3NpZ24oY29sLCBzZXFDb2x1bW4sIHsKICAgICAgICAgICAgICB0eXBlOiAnc2VxJwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBfaW5uZXJDb2x1bW5zLnVuc2hpZnQoY29sKTsKICAgICAgICB9IC8vIOWIpOaWreaYr+WQpuW8gOWQr+S6huWPr+mAieaLqeihjAoKCiAgICAgICAgaWYgKHJvd1NlbGVjdGlvbikgewogICAgICAgICAgdmFyIHdpZHRoID0gNDA7CgogICAgICAgICAgaWYgKHRoaXMuc3RhdGlzdGljcy5oYXMgJiYgIXJvd0V4cGFuZCAmJiAhZHJhZ1NvcnQpIHsKICAgICAgICAgICAgd2lkdGggPSA2MDsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgX2NvbCA9IHsKICAgICAgICAgICAgdHlwZTogdGhpcy5yb3dTZWxlY3Rpb25UeXBlLAogICAgICAgICAgICB3aWR0aDogd2lkdGgsCiAgICAgICAgICAgIGZpeGVkOiAnbGVmdCcsCiAgICAgICAgICAgIGFsaWduOiAnY2VudGVyJwogICAgICAgICAgfTsgLy8gcmFkaW8KCiAgICAgICAgICBpZiAodGhpcy5yb3dTZWxlY3Rpb25UeXBlID09PSAncmFkaW8nICYmIHJhZGlvQ29sdW1uKSB7CiAgICAgICAgICAgIF9jb2wgPSBPYmplY3QuYXNzaWduKF9jb2wsIHJhZGlvQ29sdW1uLCB7CiAgICAgICAgICAgICAgdHlwZTogJ3JhZGlvJwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gLy8gY2hlY2tib3gKCgogICAgICAgICAgaWYgKHRoaXMucm93U2VsZWN0aW9uVHlwZSA9PT0gJ2NoZWNrYm94JyAmJiBjaGVja2JveENvbHVtbikgewogICAgICAgICAgICBfY29sID0gT2JqZWN0LmFzc2lnbihfY29sLCBjaGVja2JveENvbHVtbiwgewogICAgICAgICAgICAgIHR5cGU6ICdjaGVja2JveCcKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgX2lubmVyQ29sdW1ucy51bnNoaWZ0KF9jb2wpOwogICAgICAgIH0gLy8g5piv5ZCm5Y+v5bGV5byA6KGMCgoKICAgICAgICBpZiAocm93RXhwYW5kKSB7CiAgICAgICAgICB2YXIgX3dpZHRoID0gNDA7CgogICAgICAgICAgaWYgKHRoaXMuc3RhdGlzdGljcy5oYXMgJiYgIWRyYWdTb3J0KSB7CiAgICAgICAgICAgIF93aWR0aCA9IDYwOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBfY29sMiA9IHsKICAgICAgICAgICAgdHlwZTogJ2V4cGFuZCcsCiAgICAgICAgICAgIHRpdGxlOiAnJywKICAgICAgICAgICAgd2lkdGg6IF93aWR0aCwKICAgICAgICAgICAgZml4ZWQ6ICdsZWZ0JywKICAgICAgICAgICAgYWxpZ246ICdjZW50ZXInLAogICAgICAgICAgICBzbG90czogewogICAgICAgICAgICAgIGNvbnRlbnQ6ICdleHBhbmRDb250ZW50JwogICAgICAgICAgICB9CiAgICAgICAgICB9OwoKICAgICAgICAgIGlmIChleHBhbmRDb2x1bW4pIHsKICAgICAgICAgICAgX2NvbDIgPSBPYmplY3QuYXNzaWduKF9jb2wyLCBleHBhbmRDb2x1bW4sIHsKICAgICAgICAgICAgICB0eXBlOiAnZXhwYW5kJwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBfaW5uZXJDb2x1bW5zLnVuc2hpZnQoX2NvbDIpOwogICAgICAgIH0gLy8g5piv5ZCm5Y+v5ouW5Yqo5o6S5bqPCgoKICAgICAgICBpZiAoZHJhZ1NvcnQpIHsKICAgICAgICAgIHZhciBfd2lkdGgyID0gNDA7CgogICAgICAgICAgaWYgKHRoaXMuc3RhdGlzdGljcy5oYXMpIHsKICAgICAgICAgICAgX3dpZHRoMiA9IDYwOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBfY29sMyA9IHsKICAgICAgICAgICAgdHlwZTogSlZYRVR5cGVzLnJvd0RyYWdTb3J0LAogICAgICAgICAgICB0aXRsZTogJycsCiAgICAgICAgICAgIHdpZHRoOiBfd2lkdGgyLAogICAgICAgICAgICBmaXhlZDogJ2xlZnQnLAogICAgICAgICAgICBhbGlnbjogJ2NlbnRlcicsCiAgICAgICAgICAgIGNlbGxSZW5kZXI6IHsKICAgICAgICAgICAgICBuYW1lOiBKVlhFVHlwZXMuX3ByZWZpeCArIEpWWEVUeXBlcy5yb3dEcmFnU29ydAogICAgICAgICAgICB9CiAgICAgICAgICB9OwoKICAgICAgICAgIGlmIChkcmFnU29ydENvbHVtbikgewogICAgICAgICAgICBfY29sMyA9IE9iamVjdC5hc3NpZ24oX2NvbDMsIGRyYWdTb3J0Q29sdW1uLCB7CiAgICAgICAgICAgICAgdHlwZTogSlZYRVR5cGVzLnJvd0RyYWdTb3J0CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIF9pbm5lckNvbHVtbnMudW5zaGlmdChfY29sMyk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLl9pbm5lckNvbHVtbnMgPSBfaW5uZXJDb2x1bW5zOwogICAgICAgIHRoaXMuX2lubmVyRWRpdFJ1bGVzID0gX2lubmVyRWRpdFJ1bGVzOwogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkge30sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHRoaXMuaGFuZGxlVGFic0NoYW5nZSgpOwogIH0sCiAgbWV0aG9kczogewogICAgLyoqDQogICAgICog6Ieq5Yqo5Yik5pat54i257qn5piv5ZCm5pivIDxhLXRhYnMvPiDnu4Tku7bvvIznhLblkI7mt7vliqDkuovku7bnm5HlkKzvvIzoh6rliqjph43nva7ooajmoLwNCiAgICAgKi8KICAgIGhhbmRsZVRhYnNDaGFuZ2U6IGZ1bmN0aW9uIGhhbmRsZVRhYnNDaGFuZ2UoKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgLy8g6I635Y+W54i257qnCiAgICAgIHZhciB0YWJzID0gZ2V0Vm1QYXJlbnRCeU5hbWUodGhpcywgJ0FUYWJzJyk7CiAgICAgIHZhciB0YWJQYW5lID0gZ2V0Vm1QYXJlbnRCeU5hbWUodGhpcywgJ0FUYWJQYW5lJyk7CgogICAgICBpZiAodGFicyAmJiB0YWJQYW5lKSB7CiAgICAgICAgLy8g55So5oi36Ieq5a6a5LmJ55qEIGtleQogICAgICAgIHZhciBjdXJyZW50S2V5ID0gdGFiUGFuZS4kdm5vZGUua2V5OyAvLyDmt7vliqAgYWN0aXZlS2V5IOebkeWQrAoKICAgICAgICB2YXIgdW53YXRjaCA9IHRhYnMuJGNoaWxkcmVuWzBdLiR3YXRjaCgnJGRhdGEuX2FjdGl2ZUtleScsIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKGtleSkgewogICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBpZiAoIShjdXJyZW50S2V5ID09PSBrZXkpKSB7CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM3LiRuZXh0VGljaygpOwoKICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM3LnJlZnJlc2hTY3JvbGwoKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNy5yZWNhbGN1bGF0ZSgpOwoKICAgICAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICAgICAgfSkpOwoKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgIH07CiAgICAgICAgfSgpKTsgLy8g5b2T5YmN5a6e5L6L6ZSA5q+B5pe25Y+W5raI55uR5ZCsCgogICAgICAgIHRoaXMuJG9uKCdiZWZvcmVEZXN0cm95JywgZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIHVud2F0Y2goKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGhhbmRsZVZ4ZVNjcm9sbDogZnVuY3Rpb24gaGFuZGxlVnhlU2Nyb2xsKGV2ZW50KSB7CiAgICAgIHZhciAkcmVmcyA9IHRoaXMuJHJlZnMsCiAgICAgICAgICBzY3JvbGwgPSB0aGlzLnNjcm9sbDsgLy8g6K6w5b2V5rua5Yqo5p2h55qE5L2N572uCgogICAgICBzY3JvbGwudG9wID0gZXZlbnQuc2Nyb2xsVG9wOwogICAgICBzY3JvbGwubGVmdCA9IGV2ZW50LnNjcm9sbExlZnQ7CiAgICAgICRyZWZzLnN1YlBvcG92ZXIgPyAkcmVmcy5zdWJQb3BvdmVyLmNsb3NlKCkgOiBudWxsOwogICAgICB0aGlzLnNjcm9sbGluZyA9IHRydWU7CiAgICAgIHRoaXMuY2xvc2VTY3JvbGxpbmcoKTsKICAgIH0sCiAgICAvLyDlvZPmiYvliqjli77pgInljZXpgInml7bop6blj5HnmoTkuovku7YKICAgIGhhbmRsZVZ4ZVJhZGlvQ2hhbmdlOiBmdW5jdGlvbiBoYW5kbGVWeGVSYWRpb0NoYW5nZShldmVudCkgewogICAgICB2YXIgcm93ID0gZXZlbnQuJHRhYmxlLmdldFJhZGlvUmVjb3JkKCk7CiAgICAgIHRoaXMuc2VsZWN0ZWRSb3dzID0gcm93ID8gW3Jvd10gOiBbXTsKICAgICAgdGhpcy5oYW5kbGVTZWxlY3RDaGFuZ2UoJ3JhZGlvJywgdGhpcy5zZWxlY3RlZFJvd3MsIGV2ZW50KTsKICAgIH0sCiAgICAvLyDlvZPmiYvliqjli77pgInlhajpgInml7bop6blj5HnmoTkuovku7YKICAgIGhhbmRsZVZ4ZUNoZWNrYm94QWxsOiBmdW5jdGlvbiBoYW5kbGVWeGVDaGVja2JveEFsbChldmVudCkgewogICAgICB0aGlzLnNlbGVjdGVkUm93cyA9IGV2ZW50LiR0YWJsZS5nZXRDaGVja2JveFJlY29yZHMoKTsKICAgICAgdGhpcy5oYW5kbGVTZWxlY3RDaGFuZ2UoJ2NoZWNrYm94LWFsbCcsIHRoaXMuc2VsZWN0ZWRSb3dzLCBldmVudCk7CiAgICB9LAogICAgLy8g5b2T5omL5Yqo5Yu+6YCJ5bm25LiU5YC85Y+R55Sf5pS55Y+Y5pe26Kem5Y+R55qE5LqL5Lu2CiAgICBoYW5kbGVWeGVDaGVja2JveENoYW5nZTogZnVuY3Rpb24gaGFuZGxlVnhlQ2hlY2tib3hDaGFuZ2UoZXZlbnQpIHsKICAgICAgdGhpcy5zZWxlY3RlZFJvd3MgPSBldmVudC4kdGFibGUuZ2V0Q2hlY2tib3hSZWNvcmRzKCk7CiAgICAgIHRoaXMuaGFuZGxlU2VsZWN0Q2hhbmdlKCdjaGVja2JveCcsIHRoaXMuc2VsZWN0ZWRSb3dzLCBldmVudCk7CiAgICB9LAogICAgLy8g6KGM6YCJ5oupY2hhbmdl5LqL5Lu2CiAgICBoYW5kbGVTZWxlY3RDaGFuZ2U6IGZ1bmN0aW9uIGhhbmRsZVNlbGVjdENoYW5nZSh0eXBlLCBzZWxlY3RlZFJvd3MsICRldmVudCkgewogICAgICB2YXIgYWN0aW9uOwoKICAgICAgaWYgKHR5cGUgPT09ICdyYWRpbycpIHsKICAgICAgICBhY3Rpb24gPSAnc2VsZWN0ZWQnOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdjaGVja2JveCcpIHsKICAgICAgICBhY3Rpb24gPSBzZWxlY3RlZFJvd3MuaW5jbHVkZXMoJGV2ZW50LnJvdykgPyAnc2VsZWN0ZWQnIDogJ3Vuc2VsZWN0ZWQnOwogICAgICB9IGVsc2UgewogICAgICAgIGFjdGlvbiA9ICdzZWxlY3RlZC1hbGwnOwogICAgICB9CgogICAgICB0aGlzLnNlbGVjdGVkUm93SWRzID0gc2VsZWN0ZWRSb3dzLm1hcChmdW5jdGlvbiAocm93KSB7CiAgICAgICAgcmV0dXJuIHJvdy5pZDsKICAgICAgfSk7CiAgICAgIHRoaXMudHJpZ2dlcignc2VsZWN0Um93Q2hhbmdlJywgewogICAgICAgIHR5cGU6IHR5cGUsCiAgICAgICAgYWN0aW9uOiBhY3Rpb24sCiAgICAgICAgJGV2ZW50OiAkZXZlbnQsCiAgICAgICAgcm93OiAkZXZlbnQucm93LAogICAgICAgIHNlbGVjdGVkUm93czogdGhpcy5zZWxlY3RlZFJvd3MsCiAgICAgICAgc2VsZWN0ZWRSb3dJZHM6IHRoaXMuc2VsZWN0ZWRSb3dJZHMKICAgICAgfSk7CiAgICB9LAogICAgLy8g54K55Ye75Y2V5YWD5qC85pe26Kem5Y+R55qE5LqL5Lu2CiAgICBoYW5kbGVDZWxsQ2xpY2s6IGZ1bmN0aW9uIGhhbmRsZUNlbGxDbGljayhldmVudCkgewogICAgICB2YXIgcm93ID0gZXZlbnQucm93LAogICAgICAgICAgY29sdW1uID0gZXZlbnQuY29sdW1uLAogICAgICAgICAgJGV2ZW50ID0gZXZlbnQuJGV2ZW50LAogICAgICAgICAgJHRhYmxlID0gZXZlbnQuJHRhYmxlOwogICAgICB2YXIgJHJlZnMgPSB0aGlzLiRyZWZzOyAvLyDngrnlh7vkuoblj6/nvJbovpHnmoQKCiAgICAgIGlmIChjb2x1bW4uZWRpdFJlbmRlcikgewogICAgICAgICRyZWZzLnN1YlBvcG92ZXIgPyAkcmVmcy5zdWJQb3BvdmVyLmNsb3NlKCkgOiBudWxsOwogICAgICAgIHJldHVybjsKICAgICAgfSAvLyDmmL7npLror6bnu4bkv6Hmga8KCgogICAgICBpZiAoY29sdW1uLm93bi5zaG93RGV0YWlscykgewogICAgICAgIC8vIOS4pOS4quWmguaenOWQjOaXtuWtmOWcqOeahOivneS8muWHuueOsOatu+W+queOrwogICAgICAgICRyZWZzLnN1YlBvcG92ZXIgPyAkcmVmcy5zdWJQb3BvdmVyLmNsb3NlKCkgOiBudWxsOwogICAgICAgICRyZWZzLmRldGFpbHNNb2RhbCA/ICRyZWZzLmRldGFpbHNNb2RhbC5vcGVuKGV2ZW50KSA6IG51bGw7CiAgICAgIH0gZWxzZSBpZiAoJHJlZnMuc3ViUG9wb3ZlcikgewogICAgICAgICRyZWZzLnN1YlBvcG92ZXIudG9nZ2xlKGV2ZW50KTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmNsaWNrU2VsZWN0Um93KSB7CiAgICAgICAgdmFyIGNsYXNzTmFtZSA9ICRldmVudC50YXJnZXQuY2xhc3NOYW1lIHx8ICcnOwogICAgICAgIGNsYXNzTmFtZSA9IHR5cGVvZiBjbGFzc05hbWUgPT09ICdzdHJpbmcnID8gY2xhc3NOYW1lIDogY2xhc3NOYW1lLnRvU3RyaW5nKCk7IC8vIOeCueWHu+eahOaYr2V4cGFuZO+8jOS4jeWBmuWkhOeQhgoKICAgICAgICBpZiAoY2xhc3NOYW1lLmluY2x1ZGVzKCd2eGUtdGFibGUtLWV4cGFuZC1idG4nKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gLy8g54K55Ye755qE5pivY2hlY2tib3jvvIzkuI3lgZrlpITnkIYKCgogICAgICAgIGlmIChjbGFzc05hbWUuaW5jbHVkZXMoJ3Z4ZS1jaGVja2JveC0taWNvbicpIHx8IGNsYXNzTmFtZS5pbmNsdWRlcygndnhlLWNlbGwtLWNoZWNrYm94JykpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IC8vIOeCueWHu+eahOaYr3JhZGlv77yM5LiN5YGa5aSE55CGCgoKICAgICAgICBpZiAoY2xhc3NOYW1lLmluY2x1ZGVzKCd2eGUtcmFkaW8tLWljb24nKSB8fCBjbGFzc05hbWUuaW5jbHVkZXMoJ3Z4ZS1jZWxsLS1yYWRpbycpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5yb3dTZWxlY3Rpb25UeXBlID09PSAncmFkaW8nKSB7CiAgICAgICAgICAkdGFibGUuc2V0UmFkaW9Sb3cocm93KTsKICAgICAgICAgIHRoaXMuaGFuZGxlVnhlUmFkaW9DaGFuZ2UoZXZlbnQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAkdGFibGUudG9nZ2xlQ2hlY2tib3hSb3cocm93KTsKICAgICAgICAgIHRoaXMuaGFuZGxlVnhlQ2hlY2tib3hDaGFuZ2UoZXZlbnQpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOWNleWFg+agvOe8lui+keeKtuaAgeS4i+iiq+WFs+mXreaXtuS8muinpuWPkeivpeS6i+S7tgogICAgaGFuZGxlRWRpdENsb3NlZDogZnVuY3Rpb24gaGFuZGxlRWRpdENsb3NlZChfcmVmMikgewogICAgICB2YXIgY29sdW1uID0gX3JlZjIuY29sdW1uOwogICAgICAvLyDmiafooYzlop7lvLoKICAgICAgZ2V0RW5oYW5jZWRNaXhpbnMoY29sdW1uLm93bi4kdHlwZSwgJ2FvcEV2ZW50cycpLmVkaXRDbG9zZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0sCiAgICAvLyDljZXlhYPmoLzooqvmv4DmtLvnvJbovpHml7bkvJrop6blj5Hor6Xkuovku7YKICAgIGhhbmRsZUVkaXRBY3RpdmVkOiBmdW5jdGlvbiBoYW5kbGVFZGl0QWN0aXZlZChfcmVmMykgewogICAgICB2YXIgY29sdW1uID0gX3JlZjMuY29sdW1uOwogICAgICAvLyDmiafooYzlop7lvLoKICAgICAgZ2V0RW5oYW5jZWRNaXhpbnMoY29sdW1uLm93bi4kdHlwZSwgJ2FvcEV2ZW50cycpLmVkaXRBY3RpdmVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9LAoKICAgIC8qKiDooajlsL7mlbDmja7lpITnkIbmlrnms5XvvIznlKjkuo7mmL7npLrnu5/orqHkv6Hmga8gKi8KICAgIGhhbmRsZUZvb3Rlck1ldGhvZDogZnVuY3Rpb24gaGFuZGxlRm9vdGVyTWV0aG9kKF9yZWY0KSB7CiAgICAgIHZhciBjb2x1bW5zID0gX3JlZjQuY29sdW1ucywKICAgICAgICAgIGRhdGEgPSBfcmVmNC5kYXRhOwogICAgICB2YXIgc3RhdGlzdGljcyA9IHRoaXMuc3RhdGlzdGljczsKICAgICAgdmFyIGZvb3RlcnMgPSBbXTsKCiAgICAgIGlmIChzdGF0aXN0aWNzLmhhcykgewogICAgICAgIGlmIChzdGF0aXN0aWNzLnN1bS5sZW5ndGggPiAwKSB7CiAgICAgICAgICBmb290ZXJzLnB1c2godGhpcy5nZXRGb290ZXJTdGF0aXN0aWNzTWFwKHsKICAgICAgICAgICAgY29sdW1uczogY29sdW1ucywKICAgICAgICAgICAgdGl0bGU6ICflkIjorqEnLAogICAgICAgICAgICBjaGVja3M6IHN0YXRpc3RpY3Muc3VtLAogICAgICAgICAgICBtZXRob2Q6IGZ1bmN0aW9uIG1ldGhvZChjb2x1bW4pIHsKICAgICAgICAgICAgICByZXR1cm4gWEVVdGlscy5zdW0oZGF0YSwgY29sdW1uLnByb3BlcnR5KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHN0YXRpc3RpY3MuYXZlcmFnZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICBmb290ZXJzLnB1c2godGhpcy5nZXRGb290ZXJTdGF0aXN0aWNzTWFwKHsKICAgICAgICAgICAgY29sdW1uczogY29sdW1ucywKICAgICAgICAgICAgdGl0bGU6ICflubPlnYcnLAogICAgICAgICAgICBjaGVja3M6IHN0YXRpc3RpY3MuYXZlcmFnZSwKICAgICAgICAgICAgbWV0aG9kOiBmdW5jdGlvbiBtZXRob2QoY29sdW1uKSB7CiAgICAgICAgICAgICAgcmV0dXJuIFhFVXRpbHMubWVhbihkYXRhLCBjb2x1bW4ucHJvcGVydHkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gZm9vdGVyczsKICAgIH0sCiAgICBnZXRGb290ZXJTdGF0aXN0aWNzTWFwOiBmdW5jdGlvbiBnZXRGb290ZXJTdGF0aXN0aWNzTWFwKF9yZWY1KSB7CiAgICAgIHZhciBjb2x1bW5zID0gX3JlZjUuY29sdW1ucywKICAgICAgICAgIHRpdGxlID0gX3JlZjUudGl0bGUsCiAgICAgICAgICBjaGVja3MgPSBfcmVmNS5jaGVja3MsCiAgICAgICAgICBtZXRob2QgPSBfcmVmNS5tZXRob2Q7CiAgICAgIHJldHVybiBjb2x1bW5zLm1hcChmdW5jdGlvbiAoY29sdW1uLCBjb2x1bW5JbmRleCkgewogICAgICAgIGlmIChjb2x1bW5JbmRleCA9PT0gMCkgewogICAgICAgICAgcmV0dXJuIHRpdGxlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNoZWNrcy5pbmNsdWRlcyhjb2x1bW4ucHJvcGVydHkpKSB7CiAgICAgICAgICByZXR1cm4gbWV0aG9kKGNvbHVtbiwgY29sdW1uSW5kZXgpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0pOwogICAgfSwKCiAgICAvKiog6KGo5bC+5Y2V5YWD5qC85ZCI5bm25pa55rOVICovCiAgICBoYW5kbGVGb290ZXJTcGFuTWV0aG9kOiBmdW5jdGlvbiBoYW5kbGVGb290ZXJTcGFuTWV0aG9kKGV2ZW50KSB7CiAgICAgIGlmIChldmVudC5jb2x1bW5JbmRleCA9PT0gMCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBjb2xzcGFuOiAyCiAgICAgICAgfTsKICAgICAgfQogICAgfSwKCiAgICAvKi0tLSDlpJbpg6jlj6/osIPnlKjmjqXlj6Pmlrnms5UgLS0tKi8KCiAgICAvKioNCiAgICAgKiDph43nva7mu5rliqjmnaFUb3DkvY3nva4NCiAgICAgKiBAcGFyYW0gdG9wIOaWsHRvcOS9jee9ru+8jOeVmeepuuWImea7muWKqOWIsOS4iuasoeiusOW9leeahOS9jee9ru+8jOeUqOS6juino+WGs+WIh+aNonRhYumAiemhueWNoeaXtuWvvOiHtOeZveWxj+S7peWPiuiHquWKqOWwhua7muWKqOadoea7muWKqOWIsOmhtumDqOeahOmXrumimA0KICAgICAqLwogICAgcmVzZXRTY3JvbGxUb3A6IGZ1bmN0aW9uIHJlc2V0U2Nyb2xsVG9wKHRvcCkgewogICAgICB0aGlzLnNjcm9sbFRvKG51bGwsIHRvcCA9PSBudWxsIHx8IHRvcCA9PT0gJycgPyB0aGlzLnNjcm9sbC50b3AgOiB0b3ApOwogICAgfSwKCiAgICAvKioNCiAgICAgKiDliqDovb3mlrDmlbDmja7vvIzlkowgbG9hZERhdGEg5LiN5ZCM55qE5piv77yM55So6K+l5pa55rOV5Yqg6L2955qE5pWw5o2u6YO95piv55u45b2T5LqO54K55paw5aKe5oyJ6ZKu5paw5aKe55qE5pWw5o2u44CCDQogICAgICog6YCC55So5LqO5LiN5piv5pWw5o2u5bqT6YeM5p+l5Ye65p2l55qE5rKh5pyJaWTnmoTkuLTml7bmlbDmja4NCiAgICAgKiBAcGFyYW0gZGF0YVNvdXJjZQ0KICAgICAqLwogICAgbG9hZE5ld0RhdGE6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9sb2FkTmV3RGF0YSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKGRhdGFTb3VyY2UpIHsKICAgICAgICB2YXIgeFRhYmxlOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGRhdGFTb3VyY2UpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgeFRhYmxlID0gdGhpcy4kcmVmcy52eGUuJHJlZnMueFRhYmxlOwogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIHhUYWJsZS5sb2FkRGF0YShkYXRhU291cmNlKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0My5zZW50KTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIFtdKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gbG9hZE5ld0RhdGEoX3gyKSB7CiAgICAgICAgcmV0dXJuIF9sb2FkTmV3RGF0YS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gbG9hZE5ld0RhdGE7CiAgICB9KCksCiAgICAvLyDmoKHpqox0YWJsZe+8jOWksei0pei/lOWbnmVyck1hcO+8jOaIkOWKn+i/lOWbnm51bGwKICAgIHZhbGlkYXRlVGFibGU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF92YWxpZGF0ZVRhYmxlID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgdmFyIGVyck1hcDsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbGlkYXRlKCkuY2F0Y2goZnVuY3Rpb24gKGVyck1hcCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZXJyTWFwOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGVyck1hcCA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIGVyck1hcCA/IGVyck1hcCA6IG51bGwpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiB2YWxpZGF0ZVRhYmxlKCkgewogICAgICAgIHJldHVybiBfdmFsaWRhdGVUYWJsZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gdmFsaWRhdGVUYWJsZTsKICAgIH0oKSwKICAgIC8vIOWujOaVtOagoemqjAogICAgZnVsbFZhbGlkYXRlVGFibGU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9mdWxsVmFsaWRhdGVUYWJsZSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgIHZhciBlcnJNYXA7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mdWxsVmFsaWRhdGUoKS5jYXRjaChmdW5jdGlvbiAoZXJyTWFwKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlcnJNYXA7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgZXJyTWFwID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgZXJyTWFwID8gZXJyTWFwIDogbnVsbCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGZ1bGxWYWxpZGF0ZVRhYmxlKCkgewogICAgICAgIHJldHVybiBfZnVsbFZhbGlkYXRlVGFibGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZ1bGxWYWxpZGF0ZVRhYmxlOwogICAgfSgpLAoKICAgIC8qKiDorr7nva7mn5DooYzmn5DliJfnmoTlgLwgKi8KICAgIHNldFZhbHVlczogZnVuY3Rpb24gc2V0VmFsdWVzKHZhbHVlcykgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXMpKSB7CiAgICAgICAgY29uc29sZS53YXJuKCJKVnhlVGFibGUuc2V0VmFsdWVzXHVGRjFBXHU1RkM1XHU5ODdCXHU0RjIwXHU5MDEyXHU2NTcwXHU3RUM0Iik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YWx1ZXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaWR4KSB7CiAgICAgICAgdmFyIHJvd0tleSA9IGl0ZW0ucm93S2V5LAogICAgICAgICAgICByZWNvcmQgPSBpdGVtLnZhbHVlczsKCiAgICAgICAgdmFyIF90aGlzOCRnZXRJZlJvd0J5SWQgPSBfdGhpczguZ2V0SWZSb3dCeUlkKHJvd0tleSksCiAgICAgICAgICAgIHJvdyA9IF90aGlzOCRnZXRJZlJvd0J5SWQucm93OwoKICAgICAgICBpZiAoIXJvdykgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgT2JqZWN0LmtleXMocmVjb3JkKS5mb3JFYWNoKGZ1bmN0aW9uIChjb2xLZXkpIHsKICAgICAgICAgIHZhciBjb2x1bW4gPSBfdGhpczguZ2V0Q29sdW1uQnlLZXkoY29sS2V5KTsKCiAgICAgICAgICBpZiAoY29sdW1uKSB7CiAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IHJvd1tjb2xLZXldOwogICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSByZWNvcmRbY29sS2V5XTsKCiAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gb2xkVmFsdWUpIHsKICAgICAgICAgICAgICBfdGhpczguJHNldChyb3csIGNvbEtleSwgbmV3VmFsdWUpOyAvLyDop6blj5EgdmFsdWVDaGFuZ2Ug5LqL5Lu2CgoKICAgICAgICAgICAgICBfdGhpczgudHJpZ2dlcigndmFsdWVDaGFuZ2UnLCB7CiAgICAgICAgICAgICAgICB0eXBlOiBjb2x1bW4ub3duLiR0eXBlLAogICAgICAgICAgICAgICAgdmFsdWU6IG5ld1ZhbHVlLAogICAgICAgICAgICAgICAgb2xkVmFsdWU6IG9sZFZhbHVlLAogICAgICAgICAgICAgICAgY29sOiBjb2x1bW4ub3duLAogICAgICAgICAgICAgICAgY29sdW1uOiBjb2x1bW4sCiAgICAgICAgICAgICAgICBpc1NldFZhbHVlczogdHJ1ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLndhcm4oIkpWeGVUYWJsZS5zZXRWYWx1ZXNcdUZGMUFcdTZDQTFcdTY3MDlcdTYyN0VcdTUyMzBrZXlcdTRFM0FcIiIuY29uY2F0KGNvbEtleSwgIlwiXHU3Njg0XHU1MjE3IikpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCgogICAgLyoqIOiOt+WPluaJgOacieeahOaVsOaNru+8jOWMheaLrHZhbHVlc+OAgWRlbGV0ZUlkcyAqLwogICAgZ2V0QWxsOiBmdW5jdGlvbiBnZXRBbGwoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdGFibGVEYXRhOiB0aGlzLmdldFRhYmxlRGF0YSgpLAogICAgICAgIGRlbGV0ZURhdGE6IHRoaXMuZ2V0RGVsZXRlRGF0YSgpCiAgICAgIH07CiAgICB9LAoKICAgIC8qKiDojrflj5booajmoLzmlbDmja4gKi8KICAgIGdldFRhYmxlRGF0YTogZnVuY3Rpb24gZ2V0VGFibGVEYXRhKCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKICAgICAgdmFyIHJvd0lkcyA9IG9wdGlvbnMucm93SWRzOwogICAgICB2YXIgdGFibGVEYXRhOyAvLyDku4Xmn6Xor6LmjIflrpppZOeahOihjAoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkocm93SWRzKSAmJiByb3dJZHMubGVuZ3RoID4gMCkgewogICAgICAgIHRhYmxlRGF0YSA9IFtdOwogICAgICAgIHJvd0lkcy5mb3JFYWNoKGZ1bmN0aW9uIChyb3dJZCkgewogICAgICAgICAgdmFyIF90aGlzOSRnZXRJZlJvd0J5SWQgPSBfdGhpczkuZ2V0SWZSb3dCeUlkKHJvd0lkKSwKICAgICAgICAgICAgICByb3cgPSBfdGhpczkkZ2V0SWZSb3dCeUlkLnJvdzsKCiAgICAgICAgICBpZiAocm93KSB7CiAgICAgICAgICAgIHRhYmxlRGF0YS5wdXNoKHJvdyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5p+l6K+i5omA5pyJ6KGMCiAgICAgICAgdGFibGVEYXRhID0gdGhpcy4kcmVmcy52eGUuZ2V0VGFibGVEYXRhKCkuZnVsbERhdGE7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmZpbHRlck5ld1Jvd3ModGFibGVEYXRhLCBmYWxzZSk7CiAgICB9LAoKICAgIC8qKiDku4Xojrflj5bmlrDlop7nmoTmlbDmja4gKi8KICAgIGdldE5ld0RhdGE6IGZ1bmN0aW9uIGdldE5ld0RhdGEoKSB7CiAgICAgIHZhciBuZXdEYXRhID0gY2xvbmVPYmplY3QodGhpcy4kcmVmcy52eGUuZ2V0SW5zZXJ0UmVjb3JkcygpKTsKICAgICAgbmV3RGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHsKICAgICAgICByZXR1cm4gZGVsZXRlIHJvdy5pZDsKICAgICAgfSk7CiAgICAgIHJldHVybiBuZXdEYXRhOwogICAgfSwKCiAgICAvKiog5LuF6I635Y+W5paw5aKe55qE5pWw5o2uLOW4puaciWlkICovCiAgICBnZXROZXdEYXRhV2l0aElkOiBmdW5jdGlvbiBnZXROZXdEYXRhV2l0aElkKCkgewogICAgICB2YXIgbmV3RGF0YSA9IGNsb25lT2JqZWN0KHRoaXMuJHJlZnMudnhlLmdldEluc2VydFJlY29yZHMoKSk7CiAgICAgIHJldHVybiBuZXdEYXRhOwogICAgfSwKCiAgICAvKiog5qC55o2uSUTojrflj5booYzvvIzmlrDlop7nmoTooYzkuZ/og73mn6Xlh7rmnaUgKi8KICAgIGdldElmUm93QnlJZDogZnVuY3Rpb24gZ2V0SWZSb3dCeUlkKGlkKSB7CiAgICAgIHZhciByb3cgPSB0aGlzLmdldFJvd0J5SWQoaWQpLAogICAgICAgICAgaXNOZXcgPSBmYWxzZTsKCiAgICAgIGlmICghcm93KSB7CiAgICAgICAgcm93ID0gdGhpcy5nZXROZXdSb3dCeUlkKGlkKTsKCiAgICAgICAgaWYgKCFyb3cpIHsKICAgICAgICAgIGNvbnNvbGUud2FybigiSlZ4ZVRhYmxlLmdldElmUm93QnlJZFx1RkYxQVx1NkNBMVx1NjcwOVx1NjI3RVx1NTIzMGlkXHU0RTNBXCIiLmNvbmNhdChpZCwgIlwiXHU3Njg0XHU4ODRDIikpOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgcm93OiBudWxsCiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgaXNOZXcgPSB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIHJvdzogcm93LAogICAgICAgIGlzTmV3OiBpc05ldwogICAgICB9OwogICAgfSwKCiAgICAvKiog6YCa6L+H5Li05pe2SUTojrflj5bmlrDlop7nmoTooYwgKi8KICAgIGdldE5ld1Jvd0J5SWQ6IGZ1bmN0aW9uIGdldE5ld1Jvd0J5SWQoaWQpIHsKICAgICAgdmFyIHJlY29yZHMgPSB0aGlzLmdldEluc2VydFJlY29yZHMoKTsKICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zID0gdHJ1ZTsKICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMyA9IGZhbHNlOwogICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IzID0gdW5kZWZpbmVkOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IzID0gcmVjb3Jkc1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMzsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IChfc3RlcDMgPSBfaXRlcmF0b3IzLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zID0gdHJ1ZSkgewogICAgICAgICAgdmFyIHJlY29yZCA9IF9zdGVwMy52YWx1ZTsKCiAgICAgICAgICBpZiAocmVjb3JkLmlkID09PSBpZCkgewogICAgICAgICAgICByZXR1cm4gcmVjb3JkOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IzID0gdHJ1ZTsKICAgICAgICBfaXRlcmF0b3JFcnJvcjMgPSBlcnI7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMgJiYgX2l0ZXJhdG9yMy5yZXR1cm4gIT0gbnVsbCkgewogICAgICAgICAgICBfaXRlcmF0b3IzLnJldHVybigpOwogICAgICAgICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IzKSB7CiAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfSwKCiAgICAvKiog5LuF6I635Y+W6KKr5Yig6Zmk55qE5pWw5o2u77yI5paw5aKe5Y+I6KKr5Yig6Zmk55qE5pWw5o2u5LiN5Lya6KKr6I635Y+W5Yiw77yJICovCiAgICBnZXREZWxldGVEYXRhOiBmdW5jdGlvbiBnZXREZWxldGVEYXRhKCkgewogICAgICByZXR1cm4gY2xvbmVPYmplY3QodGhpcy4kcmVmcy52eGUuZ2V0UmVtb3ZlUmVjb3JkcygpKTsKICAgIH0sCgogICAgLyoqDQogICAgICog5re75Yqg5LiA6KGM5oiW5aSa6KGMDQogICAgICoNCiAgICAgKiBAcGFyYW0gcm93cw0KICAgICAqIEByZXR1cm4NCiAgICAgKi8KICAgIGFkZFJvd3M6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9hZGRSb3dzID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgdmFyIHJvd3MsCiAgICAgICAgICAgIGlzT25sSnMsCiAgICAgICAgICAgIF9hcmdzNiA9IGFyZ3VtZW50czsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHJvd3MgPSBfYXJnczYubGVuZ3RoID4gMCAmJiBfYXJnczZbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzNlswXSA6IHt9OwogICAgICAgICAgICAgICAgaXNPbmxKcyA9IF9hcmdzNi5sZW5ndGggPiAxID8gX2FyZ3M2WzFdIDogdW5kZWZpbmVkOwoKICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc29ubGluZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJvd3MgPSB7CiAgICAgICAgICAgICAgICAgIGNvbnZlcnRlcjogIiIsCiAgICAgICAgICAgICAgICAgIGRiRGVmYXVsdFZhbDogIiIsCiAgICAgICAgICAgICAgICAgIGRiRmllbGROYW1lOiAiIiwKICAgICAgICAgICAgICAgICAgZGJGaWVsZFR4dDogIiIsCiAgICAgICAgICAgICAgICAgIGRiSXNLZXk6ICIxIiwKICAgICAgICAgICAgICAgICAgZGJJc051bGw6ICIwIiwKICAgICAgICAgICAgICAgICAgZGJMZW5ndGg6ICIzNiIsCiAgICAgICAgICAgICAgICAgIGRiUG9pbnRMZW5ndGg6ICIwIiwKICAgICAgICAgICAgICAgICAgZGJUeXBlOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgZGljdEZpZWxkOiAiIiwKICAgICAgICAgICAgICAgICAgZGljdFRhYmxlOiAiIiwKICAgICAgICAgICAgICAgICAgZGljdFRleHQ6ICIiLAogICAgICAgICAgICAgICAgICBmaWVsZERlZmF1bHRWYWx1ZTogIiIsCiAgICAgICAgICAgICAgICAgIGZpZWxkRXh0ZW5kSnNvbjogIiIsCiAgICAgICAgICAgICAgICAgIGZpZWxkSHJlZjogIiIsCiAgICAgICAgICAgICAgICAgIGZpZWxkTGVuZ3RoOiAiMTIwIiwKICAgICAgICAgICAgICAgICAgZmllbGRNdXN0SW5wdXQ6ICIwIiwKICAgICAgICAgICAgICAgICAgZmllbGRTaG93VHlwZTogInRleHQiLAogICAgICAgICAgICAgICAgICBpc1F1ZXJ5OiAiMCIsCiAgICAgICAgICAgICAgICAgIGlzUmVhZE9ubHk6ICIxIiwKICAgICAgICAgICAgICAgICAgaXNTaG93Rm9ybTogIjAiLAogICAgICAgICAgICAgICAgICBpc1Nob3dMaXN0OiAiMCIsCiAgICAgICAgICAgICAgICAgIG1haW5GaWVsZDogIiIsCiAgICAgICAgICAgICAgICAgIG1haW5UYWJsZTogIiIsCiAgICAgICAgICAgICAgICAgIG9yZGVyTnVtOiAxLAogICAgICAgICAgICAgICAgICBvcmRlcl9udW06IDAsCiAgICAgICAgICAgICAgICAgIHF1ZXJ5Q29uZmlnRmxhZzogIjAiLAogICAgICAgICAgICAgICAgICBxdWVyeURlZlZhbDogIiIsCiAgICAgICAgICAgICAgICAgIHF1ZXJ5RGljdEZpZWxkOiAiIiwKICAgICAgICAgICAgICAgICAgcXVlcnlEaWN0VGFibGU6ICIiLAogICAgICAgICAgICAgICAgICBxdWVyeURpY3RUZXh0OiAiIiwKICAgICAgICAgICAgICAgICAgcXVlcnlNb2RlOiAic2luZ2xlIiwKICAgICAgICAgICAgICAgICAgc29ydEZsYWc6ICIwIgogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3NlbGZBZGQnKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gODsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgdGhpcy5fYWRkT3JJbnNlcnQocm93cywgLTEsICdhZGRlZCcsIGlzT25sSnMpKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU2LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gYWRkUm93cygpIHsKICAgICAgICByZXR1cm4gX2FkZFJvd3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGFkZFJvd3M7CiAgICB9KCksCgogICAgLyoqDQogICAgICog5re75Yqg5LiA6KGM5oiW5aSa6KGMDQogICAgICoNCiAgICAgKiBAcGFyYW0gcm93cw0KICAgICAqIEBwYXJhbSBpbmRleCDmt7vliqDkuIvmoIfvvIzmlbDlrZfvvIzlv4XloasNCiAgICAgKiBAcmV0dXJuDQogICAgICovCiAgICBpbnNlcnRSb3dzOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfaW5zZXJ0Um93cyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KHJvd3MsIGluZGV4KSB7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoISh0eXBlb2YgaW5kZXggIT09ICdudW1iZXInIHx8IGluZGV4IDwgMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oIlx1MzAxMEpWWEVUYWJsZVx1MzAxMWluc2VydFJvd3NcdUZGMUFpbmRleFx1NUZDNVx1OTg3Qlx1NEYyMFx1OTAxMlx1NjU3MFx1NUI1N1x1RkYwQ1x1NEUxNFx1NTkyN1x1NEU4RS0xIik7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iLCB0aGlzLl9hZGRPckluc2VydChyb3dzLCBpbmRleCwgJ2luc2VydGVkJykpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTcsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBpbnNlcnRSb3dzKF94MywgX3g0KSB7CiAgICAgICAgcmV0dXJuIF9pbnNlcnRSb3dzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBpbnNlcnRSb3dzOwogICAgfSgpLAoKICAgIC8qKg0KICAgICAqIOa3u+WKoOS4gOihjOaIluWkmuihjOS4tOaXtuaVsOaNru+8jOS4jeS8muWhq+WFhem7mOiupOWAvO+8jOS8oOS7gOS5iOWwsea3u+WKoOi/m+WOu+S7gOS5iA0KICAgICAqIEBwYXJhbSByb3dzDQogICAgICogQHBhcmFtIG9wdGlvbnMg6YCJ6aG5DQogICAgICogQHBhcmFtIG9wdGlvbnMuc2V0QWN0aXZlIOaYr+WQpua/gOa0u+acgOWQjuS4gOihjOeahOe8lui+keaooeW8jw0KICAgICAqLwogICAgcHVzaFJvd3M6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9wdXNoUm93cyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KCkgewogICAgICAgIHZhciByb3dzLAogICAgICAgICAgICBvcHRpb25zLAogICAgICAgICAgICB4VGFibGUsCiAgICAgICAgICAgIHNldEFjdGl2ZSwKICAgICAgICAgICAgaW5kZXgsCiAgICAgICAgICAgIHJlc3VsdCwKICAgICAgICAgICAgX2FyZ3M4ID0gYXJndW1lbnRzOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcm93cyA9IF9hcmdzOC5sZW5ndGggPiAwICYmIF9hcmdzOFswXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3M4WzBdIDoge307CiAgICAgICAgICAgICAgICBvcHRpb25zID0gX2FyZ3M4Lmxlbmd0aCA+IDEgJiYgX2FyZ3M4WzFdICE9PSB1bmRlZmluZWQgPyBfYXJnczhbMV0gOiB7fTsKICAgICAgICAgICAgICAgIHhUYWJsZSA9IHRoaXMuJHJlZnMudnhlLiRyZWZzLnhUYWJsZTsKICAgICAgICAgICAgICAgIHNldEFjdGl2ZSA9IG9wdGlvbnMuc2V0QWN0aXZlLCBpbmRleCA9IG9wdGlvbnMuaW5kZXg7CiAgICAgICAgICAgICAgICBzZXRBY3RpdmUgPSBzZXRBY3RpdmUgPT0gbnVsbCA/IGZhbHNlIDogISFzZXRBY3RpdmU7CiAgICAgICAgICAgICAgICBpbmRleCA9IGluZGV4ID09IG51bGwgPyAtMSA6IGluZGV4OwogICAgICAgICAgICAgICAgaW5kZXggPSBpbmRleCA9PT0gLTEgPyBpbmRleCA6IHhUYWJsZS50YWJsZUZ1bGxEYXRhW2luZGV4XTsgLy8g5o+S5YWl6KGMCgogICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgcmV0dXJuIHhUYWJsZS5pbnNlcnRBdChyb3dzLCBpbmRleCk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0OC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChzZXRBY3RpdmUpIHsKICAgICAgICAgICAgICAgICAgLy8g5r+A5rS75pyA5ZCO5LiA6KGM55qE57yW6L6R5qih5byPCiAgICAgICAgICAgICAgICAgIHhUYWJsZS5zZXRBY3RpdmVSb3cocmVzdWx0LnJvd3NbcmVzdWx0LnJvd3MubGVuZ3RoIC0gMV0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVjYWxjU29ydE51bWJlcigpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoInJldHVybiIsIHJlc3VsdCk7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTgsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBwdXNoUm93cygpIHsKICAgICAgICByZXR1cm4gX3B1c2hSb3dzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwdXNoUm93czsKICAgIH0oKSwKCiAgICAvKiog5riF56m66YCJ5oup6KGMICovCiAgICBjbGVhclNlbGVjdGlvbjogZnVuY3Rpb24gY2xlYXJTZWxlY3Rpb24oKSB7CiAgICAgIHZhciBldmVudCA9IHsKICAgICAgICAkdGFibGU6IHRoaXMuJHJlZnMudnhlLAogICAgICAgIHRhcmdldDogdGhpcwogICAgICB9OwoKICAgICAgaWYgKHRoaXMucm93U2VsZWN0aW9uVHlwZSA9PT0gSlZYRVR5cGVzLnJvd1JhZGlvKSB7CiAgICAgICAgdGhpcy4kcmVmcy52eGUuY2xlYXJSYWRpb1JvdygpOwogICAgICAgIHRoaXMuaGFuZGxlVnhlUmFkaW9DaGFuZ2UoZXZlbnQpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJlZnMudnhlLmNsZWFyQ2hlY2tib3hSb3coKTsKICAgICAgICB0aGlzLmhhbmRsZVZ4ZUNoZWNrYm94Q2hhbmdlKGV2ZW50KTsKICAgICAgfQogICAgfSwKCiAgICAvKiog5Yig6Zmk5LiA6KGM5oiW5aSa6KGM5pWw5o2uICovCiAgICByZW1vdmVSb3dzOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcmVtb3ZlUm93cyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KHJvd3MpIHsKICAgICAgICB2YXIgcmVzOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlbW92ZShyb3dzKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQ5LnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVjYWxjU29ydE51bWJlcigpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIiwgcmVzKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU5LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcmVtb3ZlUm93cyhfeDUpIHsKICAgICAgICByZXR1cm4gX3JlbW92ZVJvd3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlbW92ZVJvd3M7CiAgICB9KCksCgogICAgLyoqIOagueaNrmlk5Yig6Zmk5LiA6KGM5oiW5aSa6KGMICovCiAgICByZW1vdmVSb3dzQnlJZDogZnVuY3Rpb24gcmVtb3ZlUm93c0J5SWQocm93SWQpIHsKICAgICAgdmFyIF90aGlzMTAgPSB0aGlzOwoKICAgICAgdmFyIHJvd0lkczsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KHJvd0lkKSkgewogICAgICAgIHJvd0lkcyA9IHJvd0lkOwogICAgICB9IGVsc2UgewogICAgICAgIHJvd0lkcyA9IFtyb3dJZF07CiAgICAgIH0KCiAgICAgIHZhciByb3dzID0gcm93SWRzLm1hcChmdW5jdGlvbiAoaWQpIHsKICAgICAgICB2YXIgX3RoaXMxMCRnZXRJZlJvd0J5SWQgPSBfdGhpczEwLmdldElmUm93QnlJZChpZCksCiAgICAgICAgICAgIHJvdyA9IF90aGlzMTAkZ2V0SWZSb3dCeUlkLnJvdzsKCiAgICAgICAgaWYgKCFyb3cpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChyb3cpIHsKICAgICAgICAgIHJldHVybiByb3c7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUud2FybigiXHUzMDEwSlZYRVRhYmxlXHUzMDExcmVtb3ZlUm93c0J5SWRcdUZGMUEiLmNvbmNhdChpZCwgIlx1NEUwRFx1NUI1OFx1NTcyOCIpKTsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChyb3cpIHsKICAgICAgICByZXR1cm4gcm93ICE9IG51bGw7CiAgICAgIH0pOwogICAgICByZXR1cm4gdGhpcy5yZW1vdmVSb3dzKHJvd3MpOwogICAgfSwKICAgIGdldENvbHVtbkJ5S2V5OiBmdW5jdGlvbiBnZXRDb2x1bW5CeUtleSgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHJlZnMudnhlLmdldENvbHVtbkJ5RmllbGQuYXBwbHkodGhpcy4kcmVmcy52eGUsIGFyZ3VtZW50cyk7CiAgICB9LAoKICAgIC8qIC0tLSDovoXliqnmlrnms5UgLS0tKi8KICAgIC8vIOinpuWPkeS6i+S7tgogICAgdHJpZ2dlcjogZnVuY3Rpb24gdHJpZ2dlcihuYW1lKSB7CiAgICAgIHZhciBldmVudCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgIGV2ZW50LiR0YXJnZXQgPSB0aGlzOwogICAgICBldmVudC4kdGFibGUgPSB0aGlzLiRyZWZzLnZ4ZTsgLy9vbmxpbmXlop7lvLrlj4LmlbDlhbzlrrkKCiAgICAgIGV2ZW50LnRhcmdldCA9IHRoaXM7CiAgICAgIHRoaXMuJGVtaXQobmFtZSwgZXZlbnQpOwogICAgfSwKCiAgICAvKiog5Yqg6L295pWw5o2u5a2X5YW45bm25ZCI5bm25YiwIG9wdGlvbnMgKi8KICAgIF9sb2FkRGljdENvbmNhdFRvT3B0aW9uczogZnVuY3Rpb24gX2xvYWREaWN0Q29uY2F0VG9PcHRpb25zKGNvbHVtbikgewogICAgICB2YXIgX3RoaXMxMSA9IHRoaXM7CgogICAgICBpbml0RGljdE9wdGlvbnMoY29sdW1uLmRpY3RDb2RlKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIHZhciBuZXdPcHRpb25zID0gY29sdW1uLm9wdGlvbnMgfHwgW107IC8vIC5jb25jYXQocmVzLnJlc3VsdCkKCiAgICAgICAgICByZXMucmVzdWx0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgLy8g6L+H5ruk6YeN5aSN5pWw5o2uCiAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCA9IHRydWU7CiAgICAgICAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvcjQgPSBmYWxzZTsKICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yNCA9IHVuZGVmaW5lZDsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yNCA9IG5ld09wdGlvbnNbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDQ7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjQgPSAoX3N0ZXA0ID0gX2l0ZXJhdG9yNC5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCA9IHRydWUpIHsKICAgICAgICAgICAgICAgIHZhciBvcHRpb24gPSBfc3RlcDQudmFsdWU7CiAgICAgICAgICAgICAgICBpZiAob3B0aW9uLnZhbHVlID09PSBpdGVtLnZhbHVlKSByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjQgPSB0cnVlOwogICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yNCA9IGVycjsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCAmJiBfaXRlcmF0b3I0LnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjQucmV0dXJuKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjQpIHsKICAgICAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV3T3B0aW9ucy5wdXNoKGl0ZW0pOwogICAgICAgICAgfSk7CgogICAgICAgICAgX3RoaXMxMS4kc2V0KGNvbHVtbiwgJ29wdGlvbnMnLCBuZXdPcHRpb25zKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5ncm91cCgiSlZ4ZVRhYmxlIFx1NjdFNVx1OEJFMlx1NUI1N1x1NTE3OCgiLmNvbmNhdChjb2x1bW4uZGljdENvZGUsICIpXHU1M0QxXHU3NTFGXHU1RjAyXHU1RTM4IikpOwogICAgICAgICAgY29uc29sZS53YXJuKHJlcy5tZXNzYWdlKTsKICAgICAgICAgIGNvbnNvbGUuZ3JvdXBFbmQoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOiuvue9riB0aGlzLnNjcm9sbGluZyDpmLLmipbmqKHlvI8KICAgIGNsb3NlU2Nyb2xsaW5nOiBzaW1wbGVEZWJvdW5jZShmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuc2Nyb2xsaW5nID0gZmFsc2U7CiAgICB9LCAxMDApLAoKICAgIC8qKg0KICAgICAqIOi/h+a7pOa3u+WKoOeahOihjA0KICAgICAqIEBwYXJhbSByb3dzIOimgeetm+mAieeahOihjOaVsOaNrg0KICAgICAqIEBwYXJhbSByZW1vdmUgdHJ1ZSA9IOWIoOmZpOaWsOWinu+8jGZhbHNlPeWPquWIoOmZpGlkDQogICAgICogQHBhcmFtIGhhbmRsZXIgZnVuY3Rpb24NCiAgICAgKi8KICAgIGZpbHRlck5ld1Jvd3M6IGZ1bmN0aW9uIGZpbHRlck5ld1Jvd3Mocm93cykgewogICAgICB2YXIgcmVtb3ZlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB0cnVlOwogICAgICB2YXIgaGFuZGxlciA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkOwogICAgICB2YXIgaW5zZXJ0UmVjb3JkcyA9IHRoaXMuJHJlZnMudnhlLmdldEluc2VydFJlY29yZHMoKTsKICAgICAgdmFyIHJlY29yZHMgPSBbXTsKICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb241ID0gdHJ1ZTsKICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yNSA9IGZhbHNlOwogICAgICB2YXIgX2l0ZXJhdG9yRXJyb3I1ID0gdW5kZWZpbmVkOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3I1ID0gcm93c1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwNTsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNSA9IChfc3RlcDUgPSBfaXRlcmF0b3I1Lm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb241ID0gdHJ1ZSkgewogICAgICAgICAgdmFyIHJvdyA9IF9zdGVwNS52YWx1ZTsKICAgICAgICAgIHZhciBpdGVtID0gY2xvbmVPYmplY3Qocm93KTsKCiAgICAgICAgICBpZiAoaW5zZXJ0UmVjb3Jkcy5pbmNsdWRlcyhyb3cpKSB7CiAgICAgICAgICAgIGhhbmRsZXIgPyBoYW5kbGVyKHsKICAgICAgICAgICAgICBpdGVtOiBpdGVtLAogICAgICAgICAgICAgIHJvdzogcm93LAogICAgICAgICAgICAgIGluc2VydFJlY29yZHM6IGluc2VydFJlY29yZHMKICAgICAgICAgICAgfSkgOiBudWxsOwoKICAgICAgICAgICAgaWYgKHJlbW92ZSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBkZWxldGUgaXRlbS5pZDsKICAgICAgICAgIH0KCiAgICAgICAgICByZWNvcmRzLnB1c2goaXRlbSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjUgPSB0cnVlOwogICAgICAgIF9pdGVyYXRvckVycm9yNSA9IGVycjsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNSAmJiBfaXRlcmF0b3I1LnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjUucmV0dXJuKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjUpIHsKICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I1OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJlY29yZHM7CiAgICB9LAogICAgLy8g5Yig6Zmk6YCJ5Lit55qE5pWw5o2uCiAgICByZW1vdmVTZWxlY3Rpb246IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZW1vdmVTZWxlY3Rpb24gPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoKSB7CiAgICAgICAgdmFyIHJlczsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlbW92ZSh0aGlzLnNlbGVjdGVkUm93cyk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0MTAuc2VudDsKICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDY7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVjYWxjU29ydE51bWJlcigpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5hYnJ1cHQoInJldHVybiIsIHJlcyk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEwLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcmVtb3ZlU2VsZWN0aW9uKCkgewogICAgICAgIHJldHVybiBfcmVtb3ZlU2VsZWN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiByZW1vdmVTZWxlY3Rpb247CiAgICB9KCksCgogICAgLyoqDQogICAgICog44CQ5Yig6Zmk5oyH5a6a6KGM5pWw5o2u44CR77yI6YeN5YaZdnhlVGFibGXnmoTlhoXpg6jmlrnms5XvvIzmt7vliqDkuobku45rZWVwU291cmNl5Lit5Yig6Zmk77yJDQogICAgICog5aaC5p6c5LygIHJvdyDliJnliKDpmaTkuIDooYwNCiAgICAgKiDlpoLmnpzkvKAgcm93cyDliJnliKDpmaTlpJrooYwNCiAgICAgKiDlpoLmnpzkuLrnqbrliJnliKDpmaTmiYDmnIkNCiAgICAgKi8KICAgIF9yZW1vdmU6IGZ1bmN0aW9uIF9yZW1vdmUocm93cykgewogICAgICB2YXIgeFRhYmxlID0gdGhpcy4kcmVmcy52eGUuJHJlZnMueFRhYmxlOwogICAgICB2YXIgYWZ0ZXJGdWxsRGF0YSA9IHhUYWJsZS5hZnRlckZ1bGxEYXRhLAogICAgICAgICAgdGFibGVGdWxsRGF0YSA9IHhUYWJsZS50YWJsZUZ1bGxEYXRhLAogICAgICAgICAgdGFibGVTb3VyY2VEYXRhID0geFRhYmxlLnRhYmxlU291cmNlRGF0YSwKICAgICAgICAgIGVkaXRTdG9yZSA9IHhUYWJsZS5lZGl0U3RvcmUsCiAgICAgICAgICB0cmVlQ29uZmlnID0geFRhYmxlLnRyZWVDb25maWcsCiAgICAgICAgICBjaGVja2JveE9wdHMgPSB4VGFibGUuY2hlY2tib3hPcHRzLAogICAgICAgICAgc2VsZWN0aW9uID0geFRhYmxlLnNlbGVjdGlvbiwKICAgICAgICAgIGlzSW5zZXJ0QnlSb3cgPSB4VGFibGUuaXNJbnNlcnRCeVJvdywKICAgICAgICAgIHNjcm9sbFlMb2FkID0geFRhYmxlLnNjcm9sbFlMb2FkOwogICAgICB2YXIgYWN0aXZlZCA9IGVkaXRTdG9yZS5hY3RpdmVkLAogICAgICAgICAgcmVtb3ZlTGlzdCA9IGVkaXRTdG9yZS5yZW1vdmVMaXN0LAogICAgICAgICAgaW5zZXJ0TGlzdCA9IGVkaXRTdG9yZS5pbnNlcnRMaXN0OwogICAgICB2YXIgcHJvcGVydHkgPSBjaGVja2JveE9wdHMuY2hlY2tGaWVsZDsKICAgICAgdmFyIHJlc3QgPSBbXTsKICAgICAgdmFyIG5vd0RhdGEgPSBhZnRlckZ1bGxEYXRhOwoKICAgICAgaWYgKHRyZWVDb25maWcpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoVXRpbFRvb2xzLmdldExvZygndnhlLmVycm9yLm5vVHJlZScsIFsncmVtb3ZlJ10pKTsKICAgICAgfQoKICAgICAgaWYgKCFyb3dzKSB7CiAgICAgICAgcm93cyA9IHRhYmxlRnVsbERhdGE7CiAgICAgIH0gZWxzZSBpZiAoIVhFVXRpbHMuaXNBcnJheShyb3dzKSkgewogICAgICAgIHJvd3MgPSBbcm93c107CiAgICAgIH0gLy8g5aaC5p6c5piv5paw5aKe77yM5YiZ5L+d5a2Y6K6w5b2VCgoKICAgICAgcm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHsKICAgICAgICBpZiAoIWlzSW5zZXJ0QnlSb3cocm93KSkgewogICAgICAgICAgcmVtb3ZlTGlzdC5wdXNoKHJvdyk7CiAgICAgICAgfQogICAgICB9KTsgLy8g5aaC5p6c57uR5a6a5LqG5aSa6YCJ5bGe5oCn77yM5YiZ5pu05paw54q25oCBCgogICAgICBpZiAoIXByb3BlcnR5KSB7CiAgICAgICAgWEVVdGlscy5yZW1vdmUoc2VsZWN0aW9uLCBmdW5jdGlvbiAocm93KSB7CiAgICAgICAgICByZXR1cm4gcm93cy5pbmRleE9mKHJvdykgPiAtMTsKICAgICAgICB9KTsKICAgICAgfSAvLyDku47mlbDmja7mupDkuK3np7vpmaQKCgogICAgICBpZiAodGFibGVGdWxsRGF0YSA9PT0gcm93cykgewogICAgICAgIHJvd3MgPSByZXN0ID0gdGFibGVGdWxsRGF0YS5zbGljZSgwKTsKICAgICAgICB0YWJsZUZ1bGxEYXRhLmxlbmd0aCA9IDA7CiAgICAgICAgbm93RGF0YS5sZW5ndGggPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIHJlc3QgPSBYRVV0aWxzLnJlbW92ZSh0YWJsZUZ1bGxEYXRhLCBmdW5jdGlvbiAocm93KSB7CiAgICAgICAgICByZXR1cm4gcm93cy5pbmRleE9mKHJvdykgPiAtMTsKICAgICAgICB9KTsKICAgICAgICBYRVV0aWxzLnJlbW92ZShub3dEYXRhLCBmdW5jdGlvbiAocm93KSB7CiAgICAgICAgICByZXR1cm4gcm93cy5pbmRleE9mKHJvdykgPiAtMTsKICAgICAgICB9KTsKICAgICAgfSAvLyDjgJDku45rZWVwU291cmNl5Lit5Yig6Zmk44CRCgoKICAgICAgaWYgKHhUYWJsZS5rZWVwU291cmNlKSB7CiAgICAgICAgdmFyIHJvd0lkU2V0ID0gbmV3IFNldChyb3dzLm1hcChmdW5jdGlvbiAocm93KSB7CiAgICAgICAgICByZXR1cm4gcm93LmlkOwogICAgICAgIH0pKTsKICAgICAgICBYRVV0aWxzLnJlbW92ZSh0YWJsZVNvdXJjZURhdGEsIGZ1bmN0aW9uIChyb3cpIHsKICAgICAgICAgIHJldHVybiByb3dJZFNldC5oYXMocm93LmlkKTsKICAgICAgICB9KTsKICAgICAgfSAvLyDlpoLmnpzlvZPliY3ooYzooqvmv4DmtLvnvJbovpHvvIzliJnmuIXpmaTmv4DmtLvnirbmgIEKCgogICAgICBpZiAoYWN0aXZlZC5yb3cgJiYgcm93cy5pbmRleE9mKGFjdGl2ZWQucm93KSA+IC0xKSB7CiAgICAgICAgeFRhYmxlLmNsZWFyQWN0aXZlZCgpOwogICAgICB9IC8vIOS7juaWsOWinuS4reenu+mZpOW3suWIoOmZpOeahOaVsOaNrgoKCiAgICAgIFhFVXRpbHMucmVtb3ZlKGluc2VydExpc3QsIGZ1bmN0aW9uIChyb3cpIHsKICAgICAgICByZXR1cm4gcm93cy5pbmRleE9mKHJvdykgPiAtMTsKICAgICAgfSk7CiAgICAgIHhUYWJsZS5oYW5kbGVUYWJsZURhdGEoKTsKICAgICAgeFRhYmxlLnVwZGF0ZUZvb3RlcigpOwogICAgICB4VGFibGUudXBkYXRlQ2FjaGUoKTsKICAgICAgeFRhYmxlLmNoZWNrU2VsZWN0aW9uU3RhdHVzKCk7CgogICAgICBpZiAoc2Nyb2xsWUxvYWQpIHsKICAgICAgICB4VGFibGUudXBkYXRlU2Nyb2xsWVNwYWNlKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB4VGFibGUuJG5leHRUaWNrKCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgeFRhYmxlLnJlY2FsY3VsYXRlKCk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHJvdzogcmVzdC5sZW5ndGggPyByZXN0W3Jlc3QubGVuZ3RoIC0gMV0gOiBudWxsLAogICAgICAgICAgcm93czogcmVzdAogICAgICAgIH07CiAgICAgIH0pOwogICAgfSwKCiAgICAvKiog6KGM6YeN5paw5o6S5bqPICovCiAgICByb3dSZXNvcnQ6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yb3dSZXNvcnQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTEob2xkSW5kZXgsIG5ld0luZGV4KSB7CiAgICAgICAgdmFyIHhUYWJsZSwgc29ydDsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB4VGFibGUgPSB0aGlzLiRyZWZzLnZ4ZS4kcmVmcy54VGFibGU7CiAgICAgICAgICAgICAgICB3aW5kb3cueFRhYmxlID0geFRhYmxlOwoKICAgICAgICAgICAgICAgIHNvcnQgPSBmdW5jdGlvbiBzb3J0KGFycmF5KSB7CiAgICAgICAgICAgICAgICAgIC8vIOWtmOWCqOaXp+aVsOaNru+8jOW5tuWIoOmZpOaXp+mhueebrgogICAgICAgICAgICAgICAgICB2YXIgcm93ID0gYXJyYXkuc3BsaWNlKG9sZEluZGV4LCAxKVswXTsgLy8g5ZCR5paw6aG555uu6YeM5re75Yqg5pen5pWw5o2uCgogICAgICAgICAgICAgICAgICBhcnJheS5zcGxpY2UobmV3SW5kZXgsIDAsIHJvdyk7CiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIHNvcnQoeFRhYmxlLnRhYmxlRnVsbERhdGEpOwoKICAgICAgICAgICAgICAgIGlmICh4VGFibGUua2VlcFNvdXJjZSkgewogICAgICAgICAgICAgICAgICBzb3J0KHhUYWJsZS50YWJsZVNvdXJjZURhdGEpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDc7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kbmV4dFRpY2soKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWNhbGNTb3J0TnVtYmVyKCk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTExLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcm93UmVzb3J0KF94NiwgX3g3KSB7CiAgICAgICAgcmV0dXJuIF9yb3dSZXNvcnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJvd1Jlc29ydDsKICAgIH0oKSwKCiAgICAvKiog6YeN5paw6K6h566X5o6S5bqP5a2X5q6155qE5pWw5YC8ICovCiAgICBfcmVjYWxjU29ydE51bWJlcjogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlY2FsY1NvcnROdW1iZXIyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEyKCkgewogICAgICAgIHZhciBfdGhpczEyID0gdGhpczsKCiAgICAgICAgdmFyIHhUYWJsZTsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMiQoX2NvbnRleHQxMikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEyLnByZXYgPSBfY29udGV4dDEyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB4VGFibGUgPSB0aGlzLiRyZWZzLnZ4ZS4kcmVmcy54VGFibGU7CgogICAgICAgICAgICAgICAgaWYgKHRoaXMuZHJhZ1NvcnQpIHsKICAgICAgICAgICAgICAgICAgeFRhYmxlLnRhYmxlRnVsbERhdGEuZm9yRWFjaChmdW5jdGlvbiAoZGF0YSwgaWR4KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFbX3RoaXMxMi5kcmFnU29ydEtleV0gPSBpZHggKyAxOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIHhUYWJsZS51cGRhdGVDYWNoZSh0cnVlKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gNjsKICAgICAgICAgICAgICAgIHJldHVybiB4VGFibGUudXBkYXRlRGF0YSgpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0MTIuc2VudCk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEyLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gX3JlY2FsY1NvcnROdW1iZXIoKSB7CiAgICAgICAgcmV0dXJuIF9yZWNhbGNTb3J0TnVtYmVyMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gX3JlY2FsY1NvcnROdW1iZXI7CiAgICB9KCksCiAgICBfYWRkT3JJbnNlcnQ6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9hZGRPckluc2VydDIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTMoKSB7CiAgICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwoKICAgICAgICB2YXIgcm93cywKICAgICAgICAgICAgaW5kZXgsCiAgICAgICAgICAgIHRyaWdnZXJOYW1lLAogICAgICAgICAgICBpc09ubEpzLAogICAgICAgICAgICB4VGFibGUsCiAgICAgICAgICAgIHJlY29yZHMsCiAgICAgICAgICAgIHJlc3VsdCwKICAgICAgICAgICAgaSwKICAgICAgICAgICAgcm93LAogICAgICAgICAgICBfYXJnczEzID0gYXJndW1lbnRzOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTMucHJldiA9IF9jb250ZXh0MTMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHJvd3MgPSBfYXJnczEzLmxlbmd0aCA+IDAgJiYgX2FyZ3MxM1swXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MxM1swXSA6IHt9OwogICAgICAgICAgICAgICAgaW5kZXggPSBfYXJnczEzLmxlbmd0aCA+IDEgPyBfYXJnczEzWzFdIDogdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgdHJpZ2dlck5hbWUgPSBfYXJnczEzLmxlbmd0aCA+IDIgPyBfYXJnczEzWzJdIDogdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgaXNPbmxKcyA9IF9hcmdzMTMubGVuZ3RoID4gMyA/IF9hcmdzMTNbM10gOiB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICB4VGFibGUgPSB0aGlzLiRyZWZzLnZ4ZS4kcmVmcy54VGFibGU7CgogICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocm93cykpIHsKICAgICAgICAgICAgICAgICAgZGVsZXRlIHJvd3MudW5kZWZpbmVkOwogICAgICAgICAgICAgICAgICByZWNvcmRzID0gcm93czsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGRlbGV0ZSByb3dzLnVuZGVmaW5lZDsKICAgICAgICAgICAgICAgICAgcmVjb3JkcyA9IFtyb3dzXTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZWNvcmRzKTsgLy8g6YGN5Y6G5re75Yqg6buY6K6k5YC8CgogICAgICAgICAgICAgICAgcmVjb3Jkcy5mb3JFYWNoKGZ1bmN0aW9uIChyZWNvcmQpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTMuX2NyZWF0ZVJvdyhyZWNvcmQpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZWNvcmRzKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTMubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHVzaFJvd3MocmVjb3JkcywgewogICAgICAgICAgICAgICAgICBpbmRleDogaW5kZXgsCiAgICAgICAgICAgICAgICAgIHNldEFjdGl2ZTogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDEzLnNlbnQ7CgogICAgICAgICAgICAgICAgLy8g6YGN5Y6G5o+S5YWl55qE6KGMCiAgICAgICAgICAgICAgICAvLyB1cGRhdGUtLWJlZ2luLS1hdXRvcjpsdmRhbmRhbi0tLS0tZGF0ZToyMDIwMTExNy0tLS0tLWZvcjpMT1dDT0QtOTg3IOOAkOaWsOihjOe8lui+keOAkWpz5aKe5by66ZmE6KGo5YaF572u5pa55rOV6LCD55So6Zeu6aKYICMxODE5CiAgICAgICAgICAgICAgICAvLyBvbmxpbmUganPlop7lvLrml7bku6XkvKDov4fmnaXlgLzkuLrlh4bvvIzkuI3lho3otYvpu5jorqTlgLwKICAgICAgICAgICAgICAgIGlmIChpc09ubEpzICE9IHRydWUpIHsKICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHJlc3VsdC5yb3dzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgcm93ID0gcmVzdWx0LnJvd3NbaV07CiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKHRyaWdnZXJOYW1lLCB7CiAgICAgICAgICAgICAgICAgICAgICByb3c6IHJvdywKICAgICAgICAgICAgICAgICAgICAgICR0YWJsZTogeFRhYmxlLAogICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gLy8gdXBkYXRlLS1lbmQtLWF1dG9yOmx2ZGFuZGFuLS0tLS1kYXRlOjIwMjAxMTE3LS0tLS0tZm9yOkxPV0NPRC05ODcg44CQ5paw6KGM57yW6L6R44CRanPlop7lvLrpmYTooajlhoXnva7mlrnms5XosIPnlKjpl67popggIzE4MTkKCgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuYWJydXB0KCJyZXR1cm4iLCByZXN1bHQpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTMsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBfYWRkT3JJbnNlcnQoKSB7CiAgICAgICAgcmV0dXJuIF9hZGRPckluc2VydDIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9hZGRPckluc2VydDsKICAgIH0oKSwKICAgIC8vIOWIm+W7uuaWsOihjO+8jOiHquWKqOa3u+WKoOm7mOiupOWAvAogICAgX2NyZWF0ZVJvdzogZnVuY3Rpb24gX2NyZWF0ZVJvdygpIHsKICAgICAgdmFyIHJlY29yZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgICAgIHZhciB4VGFibGUgPSB0aGlzLiRyZWZzLnZ4ZS4kcmVmcy54VGFibGU7IC8vIOa3u+WKoOm7mOiupOWAvAoKICAgICAgeFRhYmxlLnRhYmxlRnVsbENvbHVtbi5mb3JFYWNoKGZ1bmN0aW9uIChjb2x1bW4pIHsKICAgICAgICB2YXIgY29sID0gY29sdW1uLm93bjsKCiAgICAgICAgaWYgKHJlY29yZFtjb2wua2V5XSA9PSBudWxsIHx8IHJlY29yZFtjb2wua2V5XSA9PT0gJycpIHsKICAgICAgICAgIC8vIOiuvue9rum7mOiupOWAvAogICAgICAgICAgdmFyIGNyZWF0ZVZhbHVlID0gZ2V0RW5oYW5jZWRNaXhpbnMoY29sLiR0eXBlIHx8IGNvbC50eXBlLCAnY3JlYXRlVmFsdWUnKTsKICAgICAgICAgIHJlY29yZFtjb2wua2V5XSA9IGNyZWF0ZVZhbHVlKHsKICAgICAgICAgICAgcm93OiByZWNvcmQsCiAgICAgICAgICAgIGNvbHVtbjogY29sdW1uLAogICAgICAgICAgICAkdGFibGU6IHhUYWJsZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgZGVsZXRlIHJlY29yZC51bmRlZmluZWQ7CiAgICAgIHJldHVybiByZWNvcmQ7CiAgICB9LAoKICAgIC8qLS0tIOa4suafk+WHveaVsCAtLS0qLwogICAgLy8g5riy5p+TIHZ4ZQogICAgcmVuZGVyVnhlR3JpZDogZnVuY3Rpb24gcmVuZGVyVnhlR3JpZChoKSB7CiAgICAgIHJldHVybiBoKCd2eGUtZ3JpZCcsIHsKICAgICAgICByZWY6ICd2eGUnLAogICAgICAgIGNsYXNzOiBbJ2otdnhlLXRhYmxlJ10sCiAgICAgICAgcHJvcHM6IHRoaXMudnhlUHJvcHMsCiAgICAgICAgb246IHRoaXMudnhlRXZlbnRzLAogICAgICAgIC8vIOS9nOeUqOWfn+aPkuanveeahOagvOW8j+S4ugogICAgICAgIHNjb3BlZFNsb3RzOiB0aGlzLiRzY29wZWRTbG90cwogICAgICB9KTsKICAgIH0sCiAgICAvLyDmuLLmn5Plt6XlhbfmoI8KICAgIHJlbmRlclRvb2xiYXI6IGZ1bmN0aW9uIHJlbmRlclRvb2xiYXIoaCkgewogICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7CgogICAgICB2YXIgdGhhdCA9IHRoaXM7CgogICAgICBpZiAodGhpcy50b29sYmFyKSB7CiAgICAgICAgcmV0dXJuIGgoJ2otdnhlLXRvb2xiYXInLCB7CiAgICAgICAgICBwcm9wczogewogICAgICAgICAgICB0b29sYmFyQ29uZmlnOiB0aGlzLnRvb2xiYXJDb25maWcsCiAgICAgICAgICAgIGltcG9ydEJ0bjogdGhpcy5pbXBvcnRCdG4sCiAgICAgICAgICAgIGV4Y2x1ZGVDb2RlOiB0aGlzLmV4Y2x1ZGVDb2RlLAogICAgICAgICAgICBzaXplOiB0aGlzLnNpemUsCiAgICAgICAgICAgIGRpc2FibGVkOiB0aGlzLmRpc2FibGVkLAogICAgICAgICAgICBkaXNhYmxlZFJvd3M6IHRoaXMuZGlzYWJsZWRSb3dzLAogICAgICAgICAgICBzZWxlY3RlZFJvd0lkczogdGhpcy5zZWxlY3RlZFJvd0lkcwogICAgICAgICAgfSwKICAgICAgICAgIG9uOiB7CiAgICAgICAgICAgIC8vIOaWsOWinuS6i+S7tgogICAgICAgICAgICBhZGQ6IGZ1bmN0aW9uIGFkZCgpIHsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxNC5hZGRSb3dzKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIC8vIOS/neWtmOS6i+S7tgogICAgICAgICAgICBzYXZlOiBmdW5jdGlvbiBzYXZlKCkgewogICAgICAgICAgICAgIHJldHVybiBfdGhpczE0LnRyaWdnZXIoJ3NhdmUnLCB7CiAgICAgICAgICAgICAgICAkdGFibGU6IF90aGlzMTQuJHJlZnMudnhlLAogICAgICAgICAgICAgICAgdGFyZ2V0OiBfdGhpczE0CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGltcG9ydDogZnVuY3Rpb24gX2ltcG9ydCgpIHsKICAgICAgICAgICAgICB2YXIgZm9ybURhdGEgPSBKU09OLnBhcnNlKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZm9ybURhdGEnKSk7CiAgICAgICAgICAgICAgdmFyIHJlcyA9IEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1cGxvYWRyZXN1bHQnKSk7CgogICAgICAgICAgICAgIGlmIChmb3JtRGF0YS50eXBlID09ICdEdXR5RGF0YScpIHsKICAgICAgICAgICAgICAgIHRoYXQuJGVtaXQoJ2xvYWREYXRhVXBsb2FkJywgcmVzKTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZvcm1EYXRhLnR5cGUgPT0gJ1dlZWtTdGF0aXN0aWNzJykgewogICAgICAgICAgICAgICAgdGhhdC5kYXRhU291cmNlID0gcmVzOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgLy8g5Yig6Zmk5LqL5Lu2CiAgICAgICAgICAgIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKCkgewogICAgICAgICAgICAgIHZhciAkdGFibGUgPSBfdGhpczE0LiRyZWZzLnZ4ZTsKCiAgICAgICAgICAgICAgdmFyIGRlbGV0ZVJvd3MgPSBfdGhpczE0LmZpbHRlck5ld1Jvd3MoX3RoaXMxNC5zZWxlY3RlZFJvd3MpOyAvLyDop6blj5HliKDpmaTkuovku7YKCgogICAgICAgICAgICAgIGlmIChkZWxldGVSb3dzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHZhciByZW1vdmVFdmVudCA9IHsKICAgICAgICAgICAgICAgICAgZGVsZXRlUm93czogZGVsZXRlUm93cywKICAgICAgICAgICAgICAgICAgJHRhYmxlOiAkdGFibGUsCiAgICAgICAgICAgICAgICAgIHRhcmdldDogX3RoaXMxNAogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxNC5hc3luY1JlbW92ZSkgewogICAgICAgICAgICAgICAgICAvLyDnoa7orqTliKDpmaTvvIzlj6rmnInosIPnlKjov5nkuKrmlrnms5XmiY3kvJrnnJ/liKDpmaQKICAgICAgICAgICAgICAgICAgcmVtb3ZlRXZlbnQuY29uZmlybVJlbW92ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxNC5yZW1vdmVTZWxlY3Rpb24oKTsKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTQucmVtb3ZlU2VsZWN0aW9uKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMxNC50cmlnZ2VyKCdyZW1vdmUnLCByZW1vdmVFdmVudCk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIF90aGlzMTQucmVtb3ZlU2VsZWN0aW9uKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICAvLyDmuIXpmaTpgInmi6nkuovku7YKICAgICAgICAgICAgY2xlYXJTZWxlY3Rpb246IHRoaXMuY2xlYXJTZWxlY3Rpb24KICAgICAgICAgIH0sCiAgICAgICAgICBzY29wZWRTbG90czogewogICAgICAgICAgICB0b29sYmFyUHJlZml4OiB0aGlzLiRzY29wZWRTbG90cy50b29sYmFyUHJlZml4LAogICAgICAgICAgICB0b29sYmFyU3VmZml4OiB0aGlzLiRzY29wZWRTbG90cy50b29sYmFyU3VmZml4CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfSwKICAgIC8vIOa4suafkyB0b29sYmFyQWZ0ZXIg5o+S5qe9CiAgICByZW5kZXJUb29sYmFyQWZ0ZXJTbG90OiBmdW5jdGlvbiByZW5kZXJUb29sYmFyQWZ0ZXJTbG90KCkgewogICAgICBpZiAodGhpcy4kc2NvcGVkU2xvdHNbJ3Rvb2xiYXJBZnRlciddKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHNjb3BlZFNsb3RzWyd0b29sYmFyQWZ0ZXInXSgpOwogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0sCiAgICAvLyDmuLLmn5Pngrnlh7vml7blvLnlh7rnmoTlrZDooagKICAgIHJlbmRlclN1YlBvcG92ZXI6IGZ1bmN0aW9uIHJlbmRlclN1YlBvcG92ZXIoaCkgewogICAgICBpZiAodGhpcy5jbGlja1Jvd1Nob3dTdWJGb3JtICYmIHRoaXMuJHNjb3BlZFNsb3RzLnN1YkZvcm0pIHsKICAgICAgICByZXR1cm4gaCgnai12eGUtc3ViLXBvcG92ZXInLCB7CiAgICAgICAgICByZWY6ICdzdWJQb3BvdmVyJywKICAgICAgICAgIHNjb3BlZFNsb3RzOiB7CiAgICAgICAgICAgIHN1YkZvcm06IHRoaXMuJHNjb3BlZFNsb3RzLnN1YkZvcm0KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9LAogICAgLy8g5riy5p+T54K55Ye75pe25by55Ye655qE6K+m57uG5L+h5oGvCiAgICByZW5kZXJEZXRhaWxzTW9kYWw6IGZ1bmN0aW9uIHJlbmRlckRldGFpbHNNb2RhbChoKSB7CiAgICAgIGlmICh0aGlzLmNsaWNrUm93U2hvd01haW5Gb3JtICYmIHRoaXMuJHNjb3BlZFNsb3RzLm1haW5Gb3JtKSB7CiAgICAgICAgcmV0dXJuIGgoJ2otdnhlLWRldGFpbHMtbW9kYWwnLCB7CiAgICAgICAgICByZWY6ICdkZXRhaWxzTW9kYWwnLAogICAgICAgICAgc2NvcGVkU2xvdHM6IHsKICAgICAgICAgICAgc3ViRm9ybTogdGhpcy5jbGlja1Jvd1Nob3dTdWJGb3JtID8gdGhpcy4kc2NvcGVkU2xvdHMuc3ViRm9ybSA6IG51bGwsCiAgICAgICAgICAgIG1haW5Gb3JtOiB0aGlzLiRzY29wZWRTbG90cy5tYWluRm9ybQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgLy8g5riy5p+T5YiG6aG15ZmoCiAgICByZW5kZXJQYWdpbmF0aW9uOiBmdW5jdGlvbiByZW5kZXJQYWdpbmF0aW9uKGgpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMucGFnaW5hdGlvbiAmJiBPYmplY3Qua2V5cyh0aGlzLnBhZ2luYXRpb24pLmxlbmd0aCA+IDApIHsKICAgICAgICByZXR1cm4gaCgnai12eGUtcGFnaW5hdGlvbicsIHsKICAgICAgICAgIHByb3BzOiB7CiAgICAgICAgICAgIHNpemU6IHRoaXMuc2l6ZSwKICAgICAgICAgICAgZGlzYWJsZWQ6IHRoaXMuZGlzYWJsZWQsCiAgICAgICAgICAgIHBhZ2luYXRpb246IHRoaXMucGFnaW5hdGlvbgogICAgICAgICAgfSwKICAgICAgICAgIG9uOiB7CiAgICAgICAgICAgIGNoYW5nZTogZnVuY3Rpb24gY2hhbmdlKGUpIHsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxNS50cmlnZ2VyKCdwYWdlQ2hhbmdlJywgZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9LAogICAgbG9hZEV4Y2x1ZGVDb2RlOiBmdW5jdGlvbiBsb2FkRXhjbHVkZUNvZGUoKSB7CiAgICAgIGlmICghdGhpcy5hdXRoUHJlIHx8IHRoaXMuYXV0aFByZS5sZW5ndGggPT0gMCkgewogICAgICAgIHRoaXMuZXhjbHVkZUNvZGUgPSBbXTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgcHJlID0gdGhpcy5hdXRoUHJlOwoKICAgICAgICBpZiAoIXByZS5lbmRzV2l0aCgnOicpKSB7CiAgICAgICAgICBwcmUgKz0gJzonOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5leGNsdWRlQ29kZSA9IGdldE5vQXV0aENvbHMocHJlKTsKICAgICAgfQogICAgfQogIH0sCiAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoaCkgewogICAgcmV0dXJuIGgoJ2RpdicsIHsKICAgICAgY2xhc3M6IFsnai12eGUtdGFibGUtYm94JywgInNpemUtLSIuY29uY2F0KHRoaXMuc2l6ZSldCiAgICB9LCBbdGhpcy5yZW5kZXJTdWJQb3BvdmVyKGgpLCB0aGlzLnJlbmRlckRldGFpbHNNb2RhbChoKSwgdGhpcy5yZW5kZXJUb29sYmFyKGgpLCB0aGlzLnJlbmRlclRvb2xiYXJBZnRlclNsb3QoKSwgdGhpcy5yZW5kZXJWeGVHcmlkKGgpLCB0aGlzLnJlbmRlclBhZ2luYXRpb24oaCldKTsKICB9LAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICB0aGlzLiRlbWl0KCdiZWZvcmVEZXN0cm95Jyk7CiAgfQp9OyAvLyDlhbzlrrkgb25saW5lIOeahOinhOWImQoKdmFyIGZvb1BhdHRlcm5zID0gW3sKICB0aXRsZTogJ+mdnuepuicsCiAgdmFsdWU6ICcqJywKICBwYXR0ZXJuOiAvXi4rJC8KfSwgewogIHRpdGxlOiAnNuWIsDE25L2N5pWw5a2XJywKICB2YWx1ZTogJ242LTE2JywKICBwYXR0ZXJuOiAvXlxkezYsMTh9JC8KfSwgewogIHRpdGxlOiAnNuWIsDE25L2N5Lu75oSP5a2X56ymJywKICB2YWx1ZTogJyo2LTE2JywKICBwYXR0ZXJuOiAvXi57NiwxNn0kLwp9LCB7CiAgdGl0bGU6ICc25YiwMTjkvY3lrZfmr40nLAogIHZhbHVlOiAnczYtMTgnLAogIHBhdHRlcm46IC9eW2EtenxBLVpdezYsMTh9JC8KfSwgewogIHRpdGxlOiAn572R5Z2AJywKICB2YWx1ZTogJ3VybCcsCiAgcGF0dGVybjogL14oPzooW0EtWmEtel0rKTopPyhcL3swLDN9KShbMC05LlwtQS1aYS16XSspKD86OihcZCspKT8oPzpcLyhbXj8jXSopKT8oPzpcPyhbXiNdKikpPyg/OiMoLiopKT8kLwp9LCB7CiAgdGl0bGU6ICfnlLXlrZDpgq7ku7YnLAogIHZhbHVlOiAnZScsCiAgcGF0dGVybjogL14oW1x3XStcLiopKFtcd10rKUBbXHddK1wuXHd7M30oXC5cd3syfXwpJC8KfSwgewogIHRpdGxlOiAn5omL5py65Y+356CBJywKICB2YWx1ZTogJ20nLAogIHBhdHRlcm46IC9eMVszNDU2Nzg5XVxkezl9JC8KfSwgewogIHRpdGxlOiAn6YKu5pS/57yW56CBJywKICB2YWx1ZTogJ3AnLAogIHBhdHRlcm46IC9eWzEtOV1cZHs1fSQvCn0sIHsKICB0aXRsZTogJ+Wtl+avjScsCiAgdmFsdWU6ICdzJywKICBwYXR0ZXJuOiAvXltBLVp8YS16XSskLwp9LCB7CiAgdGl0bGU6ICfmlbDlrZcnLAogIHZhbHVlOiAnbicsCiAgcGF0dGVybjogL14tP1xkKyhcLj9cZCt8XGQ/KSQvCn0sIHsKICB0aXRsZTogJ+aVtOaVsCcsCiAgdmFsdWU6ICd6JywKICBwYXR0ZXJuOiAvXi0/XGQrJC8KfSwgewogIHRpdGxlOiAn6YeR6aKdJywKICB2YWx1ZTogJ21vbmV5JywKICBwYXR0ZXJuOiAvXigoWzEtOV1bMC05XSopfChbMF1cLlxkezAsMn18WzEtOV1bMC05XSpcLlxkezAsMn0pKSQvCn1dOwovKiog5pen54mIaGFuZGxlcui9rOS4uuaWsOeJiFZhbGlkYXRvciAqLwoKZnVuY3Rpb24gaGFuZGxlckNvbnZlcnRUb1ZhbGlkYXRvcihldmVudCkgewogIHZhciBfdGhpczE2ID0gdGhpczsKCiAgdmFyIGNvbHVtbiA9IGV2ZW50LmNvbHVtbiwKICAgICAgcnVsZSA9IGV2ZW50LnJ1bGU7CiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgIHJ1bGUuaGFuZGxlcihldmVudCwgZnVuY3Rpb24gKGZsYWcsIG1zZykgewogICAgICB2YXIgbWVzc2FnZSA9IHJ1bGUubWVzc2FnZTsKCiAgICAgIGlmICh0eXBlb2YgbXNnID09PSAnc3RyaW5nJykgewogICAgICAgIG1lc3NhZ2UgPSByZXBsYWNlUHJvcHMoY29sdW1uLm93biwgbXNnKTsKICAgICAgfQoKICAgICAgaWYgKGZsYWcgPT0gbnVsbCkgewogICAgICAgIHJlc29sdmUobWVzc2FnZSk7CiAgICAgIH0gZWxzZSBpZiAoISFmbGFnKSB7CiAgICAgICAgcmVzb2x2ZShtZXNzYWdlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZWplY3QobmV3IEVycm9yKG1lc3NhZ2UpKTsKICAgICAgfQogICAgfSwgX3RoaXMxNiwgZXZlbnQpOwogIH0pOwp9Ci8qKiDllK/kuIDmoKHpqozlmaggKi8KCgpmdW5jdGlvbiB1bmlxdWVWYWxpZGF0b3IoZXZlbnQpIHsKICB2YXIgY2VsbFZhbHVlID0gZXZlbnQuY2VsbFZhbHVlLAogICAgICBjb2x1bW4gPSBldmVudC5jb2x1bW4sCiAgICAgIHJ1bGUgPSBldmVudC5ydWxlOwogIHZhciB0YWJsZURhdGEgPSB0aGlzLmdldFRhYmxlRGF0YSgpOwogIHZhciBmaW5kQ291bnQgPSAwOwogIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNiA9IHRydWU7CiAgdmFyIF9kaWRJdGVyYXRvckVycm9yNiA9IGZhbHNlOwogIHZhciBfaXRlcmF0b3JFcnJvcjYgPSB1bmRlZmluZWQ7CgogIHRyeSB7CiAgICBmb3IgKHZhciBfaXRlcmF0b3I2ID0gdGFibGVEYXRhW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA2OyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb242ID0gKF9zdGVwNiA9IF9pdGVyYXRvcjYubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjYgPSB0cnVlKSB7CiAgICAgIHZhciByb3dEYXRhID0gX3N0ZXA2LnZhbHVlOwoKICAgICAgaWYgKHJvd0RhdGFbY29sdW1uLm93bi5rZXldID09PSBjZWxsVmFsdWUpIHsKICAgICAgICBpZiAoKytmaW5kQ291bnQgPj0gMikgewogICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihydWxlLm1lc3NhZ2UpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9kaWRJdGVyYXRvckVycm9yNiA9IHRydWU7CiAgICBfaXRlcmF0b3JFcnJvcjYgPSBlcnI7CiAgfSBmaW5hbGx5IHsKICAgIHRyeSB7CiAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjYgJiYgX2l0ZXJhdG9yNi5yZXR1cm4gIT0gbnVsbCkgewogICAgICAgIF9pdGVyYXRvcjYucmV0dXJuKCk7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjYpIHsKICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjY7CiAgICAgIH0KICAgIH0KICB9CgogIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKfQ=="},{"version":3,"sources":["D:/vue/src/components/jeecg/JVxeTable/components/JVxeTable.js"],"names":["XEUtils","PropTypes","JVXETypes","VxeWebSocketMixins","initDictOptions","getRefPromise","getEnhancedMixins","replaceProps","JVxeToolbar","JVxeSubPopover","JVxeDetailsModal","JVxePagination","cloneObject","getVmParentByName","pushIfNotExist","randomString","simpleDebounce","UtilTools","getNoAuthCols","name","provide","superTrigger","event","trigger","mixins","components","props","rowKey","string","def","columns","type","Array","required","dataSource","authPre","String","default","isonline","Boolean","toolbar","importBtn","toolbarConfig","object","slots","btns","rowNumber","bool","rowSelection","rowSelectionType","oneOf","rowExpand","expandConfig","loading","height","instanceOf","Number","maxHeight","disabledRows","disabled","dragSort","dragSortKey","size","bordered","pagination","clickRowShowSubForm","clickRowShowMainForm","clickSelectRow","reloadEffect","Rules","asyncRemove","data","isJVXETable","caseId","_innerColumns","_innerEditRules","scroll","top","left","scrolling","defaultVxeProps","mode","showIcon","iconClose","iconOpen","highlight","selectedRows","selectedRowIds","statistics","has","sum","average","reloadEffectRowKeysMap","excludeCode","computed","vxeColumns","forEach","column","renderOptions","listeners","cellListeners","$type","rowDragSort","slot","$scopedSlots","hasOwnProperty","slotName","target","editRender","Object","assign","cellRender","file","image","width","endsWith","parseInt","substr","length","vxeEditRules","editRules","vxeProps","showFooter","$attrs","border","footerMethod","handleFooterMethod","vxeEvents","events","handleVxeScroll","handleCellClick","handleEditClosed","handleEditActived","handleVxeRadioChange","handleVxeCheckboxAll","handleVxeCheckboxChange","keys","$listeners","key","listen","isArray","push","valueChange","rowMoveUp","rowIndex","rowResort","rowMoveDown","rowInsertDown","insertRows","watch","immediate","handler","vxe","idx","$set","loadData","loadExcludeCode","expandColumn","seqColumn","checkboxColumn","radioColumn","dragSortColumn","indexOf","col","enhanced","rowCheckbox","rowRadio","field","renderName","_prefix","hidden","visible","switches","normal","dictCode","_loadDictConcatToOptions","validateRules","rules","rule","replace","message","unique","pattern","validator","uniqueValidator","bind","fooPatterns","value","foo","handlerConvertToValidator","item","arr","toLowerCase","title","fixed","align","unshift","content","created","mounted","handleTabsChange","methods","tabs","tabPane","currentKey","$vnode","unwatch","$children","$watch","$nextTick","refreshScroll","recalculate","$on","$refs","scrollTop","scrollLeft","subPopover","close","closeScrolling","row","$table","getRadioRecord","handleSelectChange","getCheckboxRecords","$event","action","includes","map","id","own","showDetails","detailsModal","open","toggle","className","toString","setRadioRow","toggleCheckboxRow","editClosed","apply","arguments","editActived","footers","getFooterStatisticsMap","checks","method","property","mean","columnIndex","handleFooterSpanMethod","colspan","resetScrollTop","scrollTo","loadNewData","xTable","validateTable","validate","catch","errMap","fullValidateTable","fullValidate","setValues","values","console","warn","record","getIfRowById","colKey","getColumnByKey","oldValue","newValue","isSetValues","getAll","tableData","getTableData","deleteData","getDeleteData","options","rowIds","rowId","fullData","filterNewRows","getNewData","newData","getInsertRecords","getNewDataWithId","getRowById","isNew","getNewRowById","records","getRemoveRecords","addRows","rows","isOnlJs","converter","dbDefaultVal","dbFieldName","dbFieldTxt","dbIsKey","dbIsNull","dbLength","dbPointLength","dbType","dictField","dictTable","dictText","fieldDefaultValue","fieldExtendJson","fieldHref","fieldLength","fieldMustInput","fieldShowType","isQuery","isReadOnly","isShowForm","isShowList","mainField","mainTable","orderNum","order_num","queryConfigFlag","queryDefVal","queryDictField","queryDictTable","queryDictText","queryMode","sortFlag","$emit","_addOrInsert","index","pushRows","setActive","tableFullData","insertAt","result","setActiveRow","_recalcSortNumber","clearSelection","clearRadioRow","clearCheckboxRow","removeRows","_remove","res","removeRowsById","filter","getColumnByField","$target","then","success","newOptions","option","group","groupEnd","remove","insertRecords","removeSelection","afterFullData","tableSourceData","editStore","treeConfig","checkboxOpts","selection","isInsertByRow","scrollYLoad","actived","removeList","insertList","checkField","rest","nowData","Error","getLog","slice","keepSource","rowIdSet","Set","clearActived","handleTableData","updateFooter","updateCache","checkSelectionStatus","updateScrollYSpace","oldIndex","newIndex","window","sort","array","splice","updateData","triggerName","undefined","log","_createRow","i","tableFullColumn","createValue","renderVxeGrid","h","ref","class","on","scopedSlots","renderToolbar","that","add","save","import","formData","JSON","parse","localStorage","getItem","deleteRows","removeEvent","confirmRemove","toolbarPrefix","toolbarSuffix","renderToolbarAfterSlot","renderSubPopover","subForm","renderDetailsModal","mainForm","renderPagination","change","e","pre","render","beforeDestroy","Promise","resolve","reject","flag","msg","cellValue","findCount","rowData"],"mappings":"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","sourcesContent":["import XEUtils from 'xe-utils'\r\nimport PropTypes from 'ant-design-vue/es/_util/vue-types'\r\nimport { JVXETypes } from '@/components/jeecg/JVxeTable/index'\r\nimport VxeWebSocketMixins from '../mixins/vxe.web.socket.mixins'\r\nimport { initDictOptions } from '@/components/dict/JDictSelectUtil'\r\n\r\nimport { getRefPromise } from '../utils/vxeUtils'\r\nimport { getEnhancedMixins, replaceProps } from '../utils/cellUtils'\r\n\r\nimport JVxeToolbar from './JVxeToolbar'\r\nimport JVxeSubPopover from './JVxeSubPopover'\r\nimport JVxeDetailsModal from './JVxeDetailsModal'\r\nimport JVxePagination from './JVxePagination'\r\nimport { cloneObject, getVmParentByName, pushIfNotExist, randomString, simpleDebounce } from '@/utils/util'\r\nimport { UtilTools } from 'vxe-table/packages/tools/src/utils'\r\nimport { getNoAuthCols } from \"@/utils/authFilter\"\r\n\r\nexport default {\r\n  name: 'JVxeTable',\r\n  provide() {\r\n    return {\r\n      superTrigger: (name, event) => this.trigger(name, event)\r\n    }\r\n  },\r\n  mixins: [VxeWebSocketMixins],\r\n  components: {JVxeToolbar, JVxeSubPopover, JVxeDetailsModal, JVxePagination},\r\n  props: {\r\n    rowKey: PropTypes.string.def('id'),\r\n    // 列信息\r\n    columns: {\r\n      type: Array,\r\n      required: true\r\n    },\r\n    // 数据源\r\n    dataSource: {\r\n      type: Array,\r\n      required: true\r\n    },\r\n    authPre: {\r\n      type: String,\r\n      required: false,\r\n      default: ''\r\n    },\r\n    isonline:{\r\n      type: Boolean,\r\n      required: false,\r\n      default: false\r\n    },\r\n    // 是否显示工具栏\r\n    toolbar: {\r\n      type: Boolean,\r\n      required: false,\r\n      default: true\r\n    },\r\n    importBtn:Boolean,\r\n    // 工具栏配置\r\n    toolbarConfig: PropTypes.object.def(() => ({\r\n      // prefix 前缀；suffix 后缀；\r\n      slots: ['prefix', 'suffix'],\r\n      // add 新增按钮；remove 删除按钮；clearSelection 清空选择按钮；collapse 展开收起\r\n      btns: ['add', 'remove', 'clearSelection'],\r\n    })),\r\n    // 是否显示行号\r\n    rowNumber: PropTypes.bool.def(false),\r\n    // 是否可选择行\r\n    rowSelection: PropTypes.bool.def(false),\r\n    // 选择行类型\r\n    rowSelectionType: PropTypes.oneOf(['checkbox', 'radio']).def('checkbox'),\r\n    // 是否可展开行\r\n    rowExpand: PropTypes.bool.def(false),\r\n    // 展开行配置\r\n    expandConfig: PropTypes.object.def(() => ({})),\r\n    // 页面是否在加载中\r\n    loading: PropTypes.bool.def(false),\r\n    height: PropTypes.instanceOf([Number, String]).def('auto'),\r\n    // 最大高度\r\n    maxHeight: {\r\n      type: Number,\r\n      default: () => null,\r\n    },\r\n    // 要禁用的行 TODO 未实现\r\n    disabledRows: PropTypes.object.def(() => ({})),\r\n    // 是否禁用全部组件\r\n    disabled: PropTypes.bool.def(false),\r\n    // 是否可拖拽排序 TODO 仅实现上下排序，未实现拖拽排序（可能无法实现或较为困难）\r\n    dragSort: PropTypes.bool.def(false),\r\n    // 排序字段保存的Key\r\n    dragSortKey: PropTypes.string.def('orderNum'),\r\n    // 大小，可选值有：medium（中）、small（小）、mini（微）、tiny（非常小）\r\n    size: PropTypes.oneOf(['medium', 'small', 'mini', 'tiny']).def('medium'),\r\n    // 是否显示边框线\r\n    bordered: PropTypes.bool.def(false),\r\n    // 分页器参数，设置了即可显示分页器\r\n    pagination: PropTypes.object.def(() => ({})),\r\n    // 点击行时是否显示子表单\r\n    clickRowShowSubForm: PropTypes.bool.def(false),\r\n    // 点击行时是否显示主表单\r\n    clickRowShowMainForm: PropTypes.bool.def(false),\r\n    // 是否点击选中行，优先级最低\r\n    clickSelectRow: PropTypes.bool.def(false),\r\n    // 是否开启 reload 数据效果\r\n    reloadEffect: PropTypes.bool.def(false),\r\n    // 校验规则\r\n    Rules: PropTypes.object.def(() => ({})),\r\n    // 是否异步删除行，如果你要实现异步删除，那么需要把这个选项开启，\r\n    // 在remove事件里调用confirmRemove方法才会真正删除（除非删除的全是新增的行）\r\n    asyncRemove: PropTypes.bool.def(false),\r\n  },\r\n  data() {\r\n    return {\r\n      isJVXETable: true,\r\n      // caseId，表格唯一标识\r\n      caseId: `_j-vxe-${randomString(8)}_`,\r\n      // 内置columns\r\n      _innerColumns: [],\r\n      // 内置 EditRules\r\n      _innerEditRules: [],\r\n      // 记录滚动条位置\r\n      scroll: {top: 0, left: 0},\r\n      // 当前是否正在滚动\r\n      scrolling: false,\r\n      // vxe 默认配置\r\n      defaultVxeProps: {\r\n        'row-id': this.rowKey,\r\n        // 高亮hover的行\r\n        'highlight-hover-row': true,\r\n        // 溢出隐藏并显示tooltip\r\n        'show-overflow': true,\r\n        // 表头溢出隐藏并显示tooltip\r\n        'show-header-overflow': true,\r\n        'show-footer-overflow': true,\r\n        // 可编辑配置\r\n        'edit-config': {trigger: 'click', mode: 'cell',showIcon:false},\r\n        'expand-config': {\r\n          iconClose: 'ant-table-row-expand-icon ant-table-row-collapsed',\r\n          iconOpen: 'ant-table-row-expand-icon ant-table-row-expanded'\r\n        },\r\n        // 虚拟滚动配置，y轴大于30条数据时启用虚拟滚动\r\n        // 'scroll-y': {\r\n        //   gt: 30\r\n        // },\r\n        // 'scroll-x': {\r\n        //   gt: 15\r\n        // },\r\n        'radio-config': {highlight: true},\r\n        'checkbox-config': {highlight: true},\r\n      },\r\n      // 绑定左侧选择框\r\n      selectedRows: [],\r\n      // 绑定左侧选择框已选择的id\r\n      selectedRowIds: [],\r\n      // 统计列配置\r\n      statistics: {\r\n        has: false,\r\n        sum: [],\r\n        average: [],\r\n      },\r\n      // 允许执行刷新特效的行ID\r\n      reloadEffectRowKeysMap: {},\r\n      //配置了但是没有授权的按钮和列 集合\r\n      excludeCode:[]\r\n    }\r\n  },\r\n  computed: {\r\n\r\n    // vxe 最终 columns\r\n    vxeColumns() {\r\n      this._innerColumns.forEach(column => {\r\n        let renderOptions = {\r\n          caseId: this.caseId,\r\n          bordered: this.bordered,\r\n          disabled: this.disabled,\r\n          scrolling: this.scrolling,\r\n          reloadEffect: this.reloadEffect,\r\n          reloadEffectRowKeysMap: this.reloadEffectRowKeysMap,\r\n          listeners: this.cellListeners,\r\n        }\r\n        if (column.$type === JVXETypes.rowDragSort) {\r\n          renderOptions.dragSortKey = this.dragSortKey\r\n        }\r\n        // slot 组件特殊处理\r\n        if (column.$type === JVXETypes.slot) {\r\n          if (this.$scopedSlots.hasOwnProperty(column.slotName)) {\r\n            renderOptions.slot = this.$scopedSlots[column.slotName]\r\n            renderOptions.target = this\r\n          }\r\n        }\r\n        if (column.editRender) {\r\n          Object.assign(column.editRender, renderOptions)\r\n        }\r\n        if (column.cellRender) {\r\n          Object.assign(column.cellRender, renderOptions)\r\n        }\r\n        // update--begin--autor:lvdandan-----date:20201019------for:LOWCOD-882 【新行编辑】列表上带按钮的遮挡问题\r\n        if (column.$type === JVXETypes.file || column.$type === JVXETypes.image) {\r\n          if (column.width && column.width.endsWith('px')) {\r\n            column.width = Number.parseInt(column.width.substr(0,column.width.length-2))+Number.parseInt(1)+'px';\r\n          }\r\n        }\r\n        // update--begin--autor:lvdandan-----date:20201019------for:LOWCOD-882 【新行编辑】列表上带按钮的遮挡问题\r\n      })\r\n      return this._innerColumns\r\n    },\r\n    // vxe 最终 editRules\r\n    vxeEditRules() {\r\n      return Object.assign({}, this.editRules, this._innerEditRules)\r\n    },\r\n    // vxe 最终 props\r\n    vxeProps() {\r\n      let expandConfig = Object.assign({}, this.defaultVxeProps['expand-config'], this.expandConfig)\r\n\r\n      return Object.assign({}, this.defaultVxeProps, {\r\n        showFooter: this.statistics.has,\r\n      }, this.$attrs, {\r\n        loading: this.loading,\r\n        columns: this.vxeColumns,\r\n        editRules: this.vxeEditRules,\r\n        // data: this.dataSource,\r\n        height: this.height === 'auto' ? null : this.height,\r\n        maxHeight: this.maxHeight,\r\n        border: this.bordered,\r\n        expandConfig: expandConfig,\r\n        footerMethod: this.handleFooterMethod,\r\n        // footerSpanMethod: this.handleFooterSpanMethod,\r\n      })\r\n    },\r\n    // vxe 最终 events\r\n    vxeEvents() {\r\n      // 内置事件\r\n      let events = {\r\n        'scroll': this.handleVxeScroll,\r\n        'cell-click': this.handleCellClick,\r\n        'edit-closed': this.handleEditClosed,\r\n        'edit-actived': this.handleEditActived,\r\n        'radio-change': this.handleVxeRadioChange,\r\n        'checkbox-all': this.handleVxeCheckboxAll,\r\n        'checkbox-change': this.handleVxeCheckboxChange,\r\n      }\r\n      // 用户传递的事件，进行合并操作\r\n      Object.keys(this.$listeners).forEach(key => {\r\n        let listen = this.$listeners[key]\r\n        if (events.hasOwnProperty(key)) {\r\n          if (Array.isArray(listen)) {\r\n            listen.push(events[key])\r\n          } else {\r\n            listen = [events[key], listen]\r\n          }\r\n        }\r\n        events[key] = listen\r\n      })\r\n      return events\r\n    },\r\n    // 组件监听事件\r\n    cellListeners() {\r\n      return {\r\n        trigger: (name, event) => this.trigger(name, event),\r\n        valueChange: event => this.trigger('valueChange', event),\r\n        /** 当前行向上移一位 */\r\n        rowMoveUp: rowIndex => this.rowResort(rowIndex, rowIndex - 1),\r\n        /** 当前行向下移一位 */\r\n        rowMoveDown: rowIndex => this.rowResort(rowIndex, rowIndex + 1),\r\n        /** 在当前行下面插入一行 */\r\n        rowInsertDown: rowIndex => this.insertRows({}, rowIndex + 1),\r\n      }\r\n    },\r\n  },\r\n  watch: {\r\n    dataSource: {\r\n      //   deep: true,\r\n      immediate: true,\r\n      async handler() {\r\n        let vxe = await getRefPromise(this, 'vxe')\r\n        // 阻断vue监听大数据，提高性能\r\n\r\n        // 开启了排序就自动计算排序值\r\n        if (this.dragSort) {\r\n          this.dataSource.forEach((data, idx) => {\r\n            this.$set(data, this.dragSortKey, idx + 1)\r\n          })\r\n        }\r\n\r\n        vxe.loadData(this.dataSource)\r\n        // TODO 解析disabledRows\r\n        // let disabled = false\r\n        //\r\n        // let disabledRowIds = (this.disabledRowIds || [])\r\n        // // 解析disabledRows\r\n        // Object.keys(this.disabledRows).forEach(disabledColKey => {\r\n        //   // 判断是否有该属性\r\n        //   if (data.hasOwnProperty(disabledColKey)) {\r\n        //     if (disabled !== true) {\r\n        //       let temp = this.disabledRows[disabledColKey]\r\n        //       // 禁用规则可以是一个数组\r\n        //       if (Array.isArray(temp)) {\r\n        //         disabled = temp.includes(data[disabledColKey])\r\n        //       } else {\r\n        //         disabled = (temp === data[disabledColKey])\r\n        //       }\r\n        //       if (disabled) {\r\n        //         disabledRowIds.push(row.id)\r\n        //       }\r\n        //     }\r\n        //   }\r\n        // })\r\n      },\r\n    },\r\n    columns: {\r\n      immediate: true,\r\n      handler(columns) {\r\n        //获取不需要显示列\r\n        this.loadExcludeCode()\r\n        let _innerColumns = []\r\n        let _innerEditRules = {}\r\n        let {rowNumber, rowSelection, rowExpand, dragSort} = this\r\n        let expandColumn, seqColumn, checkboxColumn, radioColumn, dragSortColumn\r\n        if (Array.isArray(columns)) {\r\n          this.statistics.has = false\r\n          this.statistics.sum = []\r\n          this.statistics.average = []\r\n\r\n          // 处理成vxe可识别的columns\r\n          columns.forEach(column => {\r\n            if(this.excludeCode.indexOf(column.key)>=0){\r\n              return false\r\n            }\r\n            let col = {...column}\r\n            let {type} = col\r\n            const enhanced = getEnhancedMixins(type)\r\n            if (type === JVXETypes.rowNumber) {\r\n              seqColumn = col\r\n            } else if (type === JVXETypes.rowCheckbox) {\r\n              checkboxColumn = col\r\n            } else if (type === JVXETypes.rowRadio) {\r\n              radioColumn = col\r\n            } else if (type === JVXETypes.rowExpand) {\r\n              expandColumn = col\r\n            } else if (type === JVXETypes.rowDragSort) {\r\n              dragSortColumn = col\r\n            } else {\r\n              col.field = col.key\r\n              // 防止和vxeTable自带的type起冲突\r\n              col.$type = col.type\r\n              delete col.type\r\n              let renderName = 'cellRender', renderOptions = {name: JVXETypes._prefix + type}\r\n              if (type) {\r\n                // hidden 是特殊的组件\r\n                if (type === JVXETypes.hidden) {\r\n                  col.visible = false\r\n                } else if (enhanced.switches.editRender) {\r\n                  renderName = 'editRender'\r\n                  renderOptions.type = enhanced.switches.visible ? 'visible' : 'default'\r\n                }\r\n              } else {\r\n                renderOptions.name = JVXETypes._prefix + JVXETypes.normal\r\n              }\r\n              col[renderName] = renderOptions\r\n              // 处理字典\r\n              if (col.dictCode) {\r\n                this._loadDictConcatToOptions(col)\r\n              }\r\n              // 处理校验\r\n              if (col.validateRules) {\r\n                let rules = []\r\n                if (Array.isArray(col.validateRules)) {\r\n                  for (let rule of col.validateRules) {\r\n                    let replace = {\r\n                      message: replaceProps(col, rule.message)\r\n                    }\r\n                    if (rule.unique || rule.pattern === 'only') {\r\n                      // 唯一校验器\r\n                      rule.validator = uniqueValidator.bind(this)\r\n                    } else if (rule.pattern) {\r\n                      // 非空\r\n                      if (rule.pattern === fooPatterns[0].value) {\r\n                        rule.required = true\r\n                        delete rule.pattern\r\n                      } else {\r\n                        // 兼容Online表单的特殊规则\r\n                        for (let foo of fooPatterns) {\r\n                          if (foo.value === rule.pattern) {\r\n                            rule.pattern = foo.pattern\r\n                            break\r\n                          }\r\n                        }\r\n                      }\r\n                    } else if (typeof rule.handler === 'function') {\r\n                      // 自定义函数校验\r\n                      rule.validator = handlerConvertToValidator.bind(this)\r\n                    }\r\n                    rules.push(Object.assign({}, rule, replace))\r\n                  }\r\n                }\r\n                _innerEditRules[col.key] = rules\r\n              }\r\n              // 处理统计列\r\n              // sum = 求和、average = 平均值\r\n              if (Array.isArray(col.statistics)) {\r\n                this.statistics.has = true\r\n                col.statistics.forEach(item => {\r\n                  let arr = this.statistics[item.toLowerCase()]\r\n                  if (Array.isArray(arr)) {\r\n                    pushIfNotExist(arr, col.key)\r\n                  }\r\n                })\r\n              }\r\n              _innerColumns.push(col)\r\n            }\r\n          })\r\n        }\r\n        // 判断是否开启了序号\r\n        if (rowNumber) {\r\n          let col = {type: 'seq', title: '#', width: 60, fixed: 'left', align: 'center'}\r\n          if (seqColumn) {\r\n            col = Object.assign(col, seqColumn, {type: 'seq'})\r\n          }\r\n          _innerColumns.unshift(col)\r\n        }\r\n        // 判断是否开启了可选择行\r\n        if (rowSelection) {\r\n          let width = 40\r\n          if (this.statistics.has && !rowExpand && !dragSort) {\r\n            width = 60\r\n          }\r\n          let col = {type: this.rowSelectionType, width, fixed: 'left', align: 'center'}\r\n          // radio\r\n          if (this.rowSelectionType === 'radio' && radioColumn) {\r\n            col = Object.assign(col, radioColumn, {type: 'radio'})\r\n          }\r\n          // checkbox\r\n          if (this.rowSelectionType === 'checkbox' && checkboxColumn) {\r\n            col = Object.assign(col, checkboxColumn, {type: 'checkbox'})\r\n          }\r\n          _innerColumns.unshift(col)\r\n        }\r\n        // 是否可展开行\r\n        if (rowExpand) {\r\n          let width = 40\r\n          if (this.statistics.has && !dragSort) {\r\n            width = 60\r\n          }\r\n          let col = {type: 'expand', title: '', width, fixed: 'left', align: 'center', slots: {content: 'expandContent'}}\r\n          if (expandColumn) {\r\n            col = Object.assign(col, expandColumn, {type: 'expand'})\r\n          }\r\n          _innerColumns.unshift(col)\r\n        }\r\n        // 是否可拖动排序\r\n        if (dragSort) {\r\n          let width = 40\r\n          if (this.statistics.has) {\r\n            width = 60\r\n          }\r\n          let col = {type: JVXETypes.rowDragSort, title: '', width, fixed: 'left', align: 'center', cellRender: {name: JVXETypes._prefix + JVXETypes.rowDragSort}}\r\n          if (dragSortColumn) {\r\n            col = Object.assign(col, dragSortColumn, {type: JVXETypes.rowDragSort})\r\n          }\r\n          _innerColumns.unshift(col)\r\n        }\r\n\r\n        this._innerColumns = _innerColumns\r\n        this._innerEditRules = _innerEditRules\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n  },\r\n  mounted() {\r\n    this.handleTabsChange()\r\n  },\r\n  methods: {\r\n\r\n    /**\r\n     * 自动判断父级是否是 <a-tabs/> 组件，然后添加事件监听，自动重置表格\r\n     */\r\n    handleTabsChange() {\r\n      // 获取父级\r\n      const tabs = getVmParentByName(this, 'ATabs')\r\n      const tabPane = getVmParentByName(this, 'ATabPane')\r\n      if (tabs && tabPane) {\r\n        // 用户自定义的 key\r\n        const currentKey = tabPane.$vnode.key\r\n        // 添加 activeKey 监听\r\n        const unwatch = tabs.$children[0].$watch('$data._activeKey', async (key) => {\r\n          // 切换到自己时重新计算\r\n          if (currentKey === key) {\r\n            await this.$nextTick()\r\n            await this.refreshScroll()\r\n            await this.recalculate()\r\n          }\r\n        })\r\n        // 当前实例销毁时取消监听\r\n        this.$on('beforeDestroy', () => unwatch())\r\n      }\r\n    },\r\n\r\n    handleVxeScroll(event) {\r\n      let {$refs, scroll} = this\r\n\r\n      // 记录滚动条的位置\r\n      scroll.top = event.scrollTop\r\n      scroll.left = event.scrollLeft\r\n\r\n      $refs.subPopover ? $refs.subPopover.close() : null\r\n      this.scrolling = true\r\n      this.closeScrolling()\r\n    },\r\n    // 当手动勾选单选时触发的事件\r\n    handleVxeRadioChange(event) {\r\n      let row = event.$table.getRadioRecord()\r\n      this.selectedRows = row ? [row] : []\r\n      this.handleSelectChange('radio', this.selectedRows, event)\r\n    },\r\n    // 当手动勾选全选时触发的事件\r\n    handleVxeCheckboxAll(event) {\r\n      this.selectedRows = event.$table.getCheckboxRecords()\r\n      this.handleSelectChange('checkbox-all', this.selectedRows, event)\r\n    },\r\n    // 当手动勾选并且值发生改变时触发的事件\r\n    handleVxeCheckboxChange(event) {\r\n      this.selectedRows = event.$table.getCheckboxRecords()\r\n      this.handleSelectChange('checkbox', this.selectedRows, event)\r\n    },\r\n    // 行选择change事件\r\n    handleSelectChange(type, selectedRows, $event) {\r\n      let action\r\n      if (type === 'radio') {\r\n        action = 'selected'\r\n      } else if (type === 'checkbox') {\r\n        action = selectedRows.includes($event.row) ? 'selected' : 'unselected'\r\n      } else {\r\n        action = 'selected-all'\r\n      }\r\n\r\n      this.selectedRowIds = selectedRows.map(row => row.id)\r\n      this.trigger('selectRowChange', {\r\n        type: type,\r\n        action: action,\r\n        $event: $event,\r\n        row: $event.row,\r\n        selectedRows: this.selectedRows,\r\n        selectedRowIds: this.selectedRowIds\r\n      })\r\n    },\r\n\r\n    // 点击单元格时触发的事件\r\n    handleCellClick(event) {\r\n      let {row, column, $event, $table} = event\r\n      let {$refs} = this\r\n\r\n      // 点击了可编辑的\r\n      if (column.editRender) {\r\n        $refs.subPopover ? $refs.subPopover.close() : null\r\n        return\r\n      }\r\n\r\n      // 显示详细信息\r\n      if (column.own.showDetails) {\r\n        // 两个如果同时存在的话会出现死循环\r\n        $refs.subPopover ? $refs.subPopover.close() : null\r\n        $refs.detailsModal ? $refs.detailsModal.open(event) : null\r\n      } else if ($refs.subPopover) {\r\n        $refs.subPopover.toggle(event)\r\n      } else if (this.clickSelectRow) {\r\n        let className = $event.target.className || ''\r\n        className = typeof className === 'string' ? className : className.toString()\r\n        // 点击的是expand，不做处理\r\n        if (className.includes('vxe-table--expand-btn')) {\r\n          return\r\n        }\r\n        // 点击的是checkbox，不做处理\r\n        if (className.includes('vxe-checkbox--icon') || className.includes('vxe-cell--checkbox')) {\r\n          return\r\n        }\r\n        // 点击的是radio，不做处理\r\n        if (className.includes('vxe-radio--icon') || className.includes('vxe-cell--radio')) {\r\n          return\r\n        }\r\n        if (this.rowSelectionType === 'radio') {\r\n          $table.setRadioRow(row)\r\n          this.handleVxeRadioChange(event)\r\n        } else {\r\n          $table.toggleCheckboxRow(row)\r\n          this.handleVxeCheckboxChange(event)\r\n        }\r\n      }\r\n    },\r\n\r\n    // 单元格编辑状态下被关闭时会触发该事件\r\n    handleEditClosed({column}) {\r\n      // 执行增强\r\n      getEnhancedMixins(column.own.$type, 'aopEvents').editClosed.apply(this, arguments)\r\n    },\r\n\r\n    // 单元格被激活编辑时会触发该事件\r\n    handleEditActived({column}) {\r\n      // 执行增强\r\n      getEnhancedMixins(column.own.$type, 'aopEvents').editActived.apply(this, arguments)\r\n    },\r\n\r\n    /** 表尾数据处理方法，用于显示统计信息 */\r\n    handleFooterMethod({columns, data}) {\r\n      const {statistics} = this\r\n      let footers = []\r\n      if (statistics.has) {\r\n        if (statistics.sum.length > 0) {\r\n          footers.push(this.getFooterStatisticsMap({\r\n            columns: columns,\r\n            title: '合计',\r\n            checks: statistics.sum,\r\n            method: (column) => XEUtils.sum(data, column.property)\r\n          }))\r\n        }\r\n        if (statistics.average.length > 0) {\r\n          footers.push(this.getFooterStatisticsMap({\r\n            columns: columns,\r\n            title: '平均',\r\n            checks: statistics.average,\r\n            method: (column) => XEUtils.mean(data, column.property)\r\n          }))\r\n        }\r\n      }\r\n      return footers\r\n    },\r\n\r\n    getFooterStatisticsMap({columns, title, checks, method}) {\r\n      return columns.map((column, columnIndex) => {\r\n        if (columnIndex === 0) {\r\n          return title\r\n        }\r\n        if (checks.includes(column.property)) {\r\n          return method(column, columnIndex)\r\n        }\r\n        return null\r\n      })\r\n    },\r\n\r\n    /** 表尾单元格合并方法 */\r\n    handleFooterSpanMethod(event) {\r\n      if (event.columnIndex === 0) {\r\n        return {colspan: 2}\r\n      }\r\n    },\r\n\r\n    /*--- 外部可调用接口方法 ---*/\r\n\r\n    /**\r\n     * 重置滚动条Top位置\r\n     * @param top 新top位置，留空则滚动到上次记录的位置，用于解决切换tab选项卡时导致白屏以及自动将滚动条滚动到顶部的问题\r\n     */\r\n    resetScrollTop(top) {\r\n      this.scrollTo(null, (top == null || top === '') ? this.scroll.top : top)\r\n    },\r\n\r\n    /**\r\n     * 加载新数据，和 loadData 不同的是，用该方法加载的数据都是相当于点新增按钮新增的数据。\r\n     * 适用于不是数据库里查出来的没有id的临时数据\r\n     * @param dataSource\r\n     */\r\n    async loadNewData(dataSource) {\r\n      if (Array.isArray(dataSource)) {\r\n        let {xTable} = this.$refs.vxe.$refs\r\n        return await xTable.loadData(dataSource)\r\n      }\r\n      return []\r\n    },\r\n\r\n    // 校验table，失败返回errMap，成功返回null\r\n    async validateTable() {\r\n      const errMap = await this.validate().catch(errMap => errMap)\r\n      return errMap ? errMap : null\r\n    },\r\n    // 完整校验\r\n    async fullValidateTable() {\r\n      const errMap = await this.fullValidate().catch(errMap => errMap)\r\n      return errMap ? errMap : null\r\n    },\r\n\r\n    /** 设置某行某列的值 */\r\n    setValues(values) {\r\n      if (!Array.isArray(values)) {\r\n        console.warn(`JVxeTable.setValues：必须传递数组`)\r\n        return\r\n      }\r\n      values.forEach((item, idx) => {\r\n        let {rowKey, values: record} = item\r\n        let {row} = this.getIfRowById(rowKey)\r\n        if (!row) {\r\n          return\r\n        }\r\n        Object.keys(record).forEach(colKey => {\r\n          let column = this.getColumnByKey(colKey)\r\n          if (column) {\r\n            let oldValue = row[colKey]\r\n            let newValue = record[colKey]\r\n            if (newValue !== oldValue) {\r\n              this.$set(row, colKey, newValue)\r\n              // 触发 valueChange 事件\r\n              this.trigger('valueChange', {\r\n                type: column.own.$type,\r\n                value: newValue,\r\n                oldValue: oldValue,\r\n                col: column.own,\r\n                column: column,\r\n                isSetValues: true,\r\n              })\r\n            }\r\n          } else {\r\n            console.warn(`JVxeTable.setValues：没有找到key为\"${colKey}\"的列`)\r\n          }\r\n        })\r\n      })\r\n    },\r\n\r\n    /** 获取所有的数据，包括values、deleteIds */\r\n    getAll() {\r\n      return {\r\n        tableData: this.getTableData(),\r\n        deleteData: this.getDeleteData()\r\n      }\r\n    },\r\n    /** 获取表格数据 */\r\n    getTableData(options = {}) {\r\n      let {rowIds} = options\r\n      let tableData\r\n      // 仅查询指定id的行\r\n      if (Array.isArray(rowIds) && rowIds.length > 0) {\r\n        tableData = []\r\n        rowIds.forEach(rowId => {\r\n          let {row} = this.getIfRowById(rowId)\r\n          if (row) {\r\n            tableData.push(row)\r\n          }\r\n        })\r\n      } else {\r\n        // 查询所有行\r\n        tableData = this.$refs.vxe.getTableData().fullData\r\n      }\r\n      return this.filterNewRows(tableData, false)\r\n    },\r\n    /** 仅获取新增的数据 */\r\n    getNewData() {\r\n      let newData = cloneObject(this.$refs.vxe.getInsertRecords())\r\n      newData.forEach(row => delete row.id)\r\n      return newData\r\n    },\r\n    /** 仅获取新增的数据,带有id */\r\n    getNewDataWithId() {\r\n      let newData = cloneObject(this.$refs.vxe.getInsertRecords())\r\n      return newData\r\n    },\r\n    /** 根据ID获取行，新增的行也能查出来 */\r\n    getIfRowById(id) {\r\n      let row = this.getRowById(id), isNew = false\r\n      if (!row) {\r\n        row = this.getNewRowById(id)\r\n        if (!row) {\r\n          console.warn(`JVxeTable.getIfRowById：没有找到id为\"${id}\"的行`)\r\n          return {row: null}\r\n        }\r\n        isNew = true\r\n      }\r\n      return {row, isNew}\r\n    },\r\n    /** 通过临时ID获取新增的行 */\r\n    getNewRowById(id) {\r\n      let records = this.getInsertRecords()\r\n      for (let record of records) {\r\n        if (record.id === id) {\r\n          return record\r\n        }\r\n      }\r\n      return null\r\n    },\r\n    /** 仅获取被删除的数据（新增又被删除的数据不会被获取到） */\r\n    getDeleteData() {\r\n      return cloneObject(this.$refs.vxe.getRemoveRecords())\r\n    },\r\n    /**\r\n     * 添加一行或多行\r\n     *\r\n     * @param rows\r\n     * @return\r\n     */\r\n    async addRows(rows = {\r\n\r\n    }, isOnlJs) {\r\n      if(this.isonline) {\r\n        rows = {\r\n          converter: \"\",\r\n          dbDefaultVal: \"\",\r\n          dbFieldName: \"\",\r\n          dbFieldTxt: \"\",\r\n          dbIsKey: \"1\",\r\n          dbIsNull: \"0\",\r\n          dbLength: \"36\",\r\n          dbPointLength: \"0\",\r\n          dbType: \"string\",\r\n          dictField: \"\",\r\n          dictTable: \"\",\r\n          dictText: \"\",\r\n          fieldDefaultValue: \"\",\r\n          fieldExtendJson: \"\",\r\n          fieldHref: \"\",\r\n          fieldLength: \"120\",\r\n          fieldMustInput: \"0\",\r\n          fieldShowType: \"text\",\r\n          isQuery: \"0\",\r\n          isReadOnly: \"1\",\r\n          isShowForm: \"0\",\r\n          isShowList: \"0\",\r\n          mainField: \"\",\r\n          mainTable: \"\",\r\n          orderNum: 1,\r\n          order_num: 0,\r\n          queryConfigFlag: \"0\",\r\n          queryDefVal: \"\",\r\n          queryDictField: \"\",\r\n          queryDictTable: \"\",\r\n          queryDictText: \"\",\r\n          queryMode: \"single\",\r\n          sortFlag: \"0\",\r\n        }\r\n        this.$emit('selfAdd')\r\n      }else {\r\n        return this._addOrInsert(rows, -1, 'added', isOnlJs)\r\n      }\r\n    },\r\n\r\n    /**\r\n     * 添加一行或多行\r\n     *\r\n     * @param rows\r\n     * @param index 添加下标，数字，必填\r\n     * @return\r\n     */\r\n    async insertRows(rows, index) {\r\n      if (typeof index !== 'number' || index < 0) {\r\n        console.warn(`【JVXETable】insertRows：index必须传递数字，且大于-1`)\r\n        return\r\n      }\r\n      return this._addOrInsert(rows, index, 'inserted')\r\n    },\r\n    /**\r\n     * 添加一行或多行临时数据，不会填充默认值，传什么就添加进去什么\r\n     * @param rows\r\n     * @param options 选项\r\n     * @param options.setActive 是否激活最后一行的编辑模式\r\n     */\r\n    async pushRows(rows = {}, options = {}) {\r\n      let {xTable} = this.$refs.vxe.$refs\r\n      let {setActive, index} = options\r\n      setActive = setActive == null ? false : !!setActive\r\n      index = index == null ? -1 : index\r\n      index = index === -1 ? index : xTable.tableFullData[index]\r\n      // 插入行\r\n      let result = await xTable.insertAt(rows, index)\r\n      if (setActive) {\r\n        // 激活最后一行的编辑模式\r\n        xTable.setActiveRow(result.rows[result.rows.length - 1])\r\n      }\r\n      await this._recalcSortNumber()\r\n      return result\r\n    },\r\n\r\n    /** 清空选择行 */\r\n    clearSelection() {\r\n      let event = {$table: this.$refs.vxe, target: this}\r\n      if (this.rowSelectionType === JVXETypes.rowRadio) {\r\n        this.$refs.vxe.clearRadioRow()\r\n        this.handleVxeRadioChange(event)\r\n      } else {\r\n        this.$refs.vxe.clearCheckboxRow()\r\n        this.handleVxeCheckboxChange(event)\r\n      }\r\n    },\r\n\r\n    /** 删除一行或多行数据 */\r\n    async removeRows(rows) {\r\n      const res = await this._remove(rows)\r\n      await this._recalcSortNumber()\r\n      return res\r\n    },\r\n\r\n    /** 根据id删除一行或多行 */\r\n    removeRowsById(rowId) {\r\n      let rowIds\r\n      if (Array.isArray(rowId)) {\r\n        rowIds = rowId\r\n      } else {\r\n        rowIds = [rowId]\r\n      }\r\n      let rows = rowIds.map((id) => {\r\n        let {row} = this.getIfRowById(id)\r\n        if (!row) {\r\n          return\r\n        }\r\n        if (row) {\r\n          return row\r\n        } else {\r\n          console.warn(`【JVXETable】removeRowsById：${id}不存在`)\r\n          return null\r\n        }\r\n      }).filter((row) => row != null)\r\n      return this.removeRows(rows)\r\n    },\r\n\r\n    getColumnByKey() {\r\n      return this.$refs.vxe.getColumnByField.apply(this.$refs.vxe, arguments)\r\n    },\r\n\r\n    /* --- 辅助方法 ---*/\r\n\r\n    // 触发事件\r\n    trigger(name, event = {}) {\r\n      event.$target = this\r\n      event.$table = this.$refs.vxe\r\n      //online增强参数兼容\r\n      event.target = this\r\n      this.$emit(name, event)\r\n    },\r\n\r\n    /** 加载数据字典并合并到 options */\r\n    _loadDictConcatToOptions(column) {\r\n      initDictOptions(column.dictCode).then((res) => {\r\n        if (res.success) {\r\n          let newOptions = (column.options || [])// .concat(res.result)\r\n          res.result.forEach(item => {\r\n            // 过滤重复数据\r\n            for (let option of newOptions) if (option.value === item.value) return\r\n            newOptions.push(item)\r\n          })\r\n          this.$set(column, 'options', newOptions)\r\n        } else {\r\n          console.group(`JVxeTable 查询字典(${column.dictCode})发生异常`)\r\n          console.warn(res.message)\r\n          console.groupEnd()\r\n        }\r\n      })\r\n    },\r\n\r\n    // 设置 this.scrolling 防抖模式\r\n    closeScrolling: simpleDebounce(function () {\r\n      this.scrolling = false\r\n    }, 100),\r\n\r\n    /**\r\n     * 过滤添加的行\r\n     * @param rows 要筛选的行数据\r\n     * @param remove true = 删除新增，false=只删除id\r\n     * @param handler function\r\n     */\r\n    filterNewRows(rows, remove = true, handler) {\r\n      let insertRecords = this.$refs.vxe.getInsertRecords()\r\n      let records = []\r\n      for (let row of rows) {\r\n        let item = cloneObject(row)\r\n        if (insertRecords.includes(row)) {\r\n          handler ? handler({item, row, insertRecords}) : null\r\n\r\n          if (remove) {\r\n            continue\r\n          }\r\n          delete item.id\r\n        }\r\n        records.push(item)\r\n      }\r\n      return records\r\n    },\r\n\r\n    // 删除选中的数据\r\n    async removeSelection() {\r\n      let res = await this._remove(this.selectedRows)\r\n      this.clearSelection()\r\n      await this._recalcSortNumber()\r\n      return res\r\n    },\r\n\r\n    /**\r\n     * 【删除指定行数据】（重写vxeTable的内部方法，添加了从keepSource中删除）\r\n     * 如果传 row 则删除一行\r\n     * 如果传 rows 则删除多行\r\n     * 如果为空则删除所有\r\n     */\r\n    _remove(rows) {\r\n      const xTable = this.$refs.vxe.$refs.xTable\r\n\r\n      const {afterFullData, tableFullData, tableSourceData, editStore, treeConfig, checkboxOpts, selection, isInsertByRow, scrollYLoad} = xTable\r\n      const {actived, removeList, insertList} = editStore\r\n      const {checkField: property} = checkboxOpts\r\n      let rest = []\r\n      const nowData = afterFullData\r\n      if (treeConfig) {\r\n        throw new Error(UtilTools.getLog('vxe.error.noTree', ['remove']))\r\n      }\r\n      if (!rows) {\r\n        rows = tableFullData\r\n      } else if (!XEUtils.isArray(rows)) {\r\n        rows = [rows]\r\n      }\r\n      // 如果是新增，则保存记录\r\n      rows.forEach(row => {\r\n        if (!isInsertByRow(row)) {\r\n          removeList.push(row)\r\n        }\r\n      })\r\n      // 如果绑定了多选属性，则更新状态\r\n      if (!property) {\r\n        XEUtils.remove(selection, row => rows.indexOf(row) > -1)\r\n      }\r\n      // 从数据源中移除\r\n      if (tableFullData === rows) {\r\n        rows = rest = tableFullData.slice(0)\r\n        tableFullData.length = 0\r\n        nowData.length = 0\r\n      } else {\r\n        rest = XEUtils.remove(tableFullData, row => rows.indexOf(row) > -1)\r\n        XEUtils.remove(nowData, row => rows.indexOf(row) > -1)\r\n      }\r\n      // 【从keepSource中删除】\r\n      if (xTable.keepSource) {\r\n        let rowIdSet = new Set(rows.map(row => row.id))\r\n        XEUtils.remove(tableSourceData, row => rowIdSet.has(row.id))\r\n      }\r\n\r\n      // 如果当前行被激活编辑，则清除激活状态\r\n      if (actived.row && rows.indexOf(actived.row) > -1) {\r\n        xTable.clearActived()\r\n      }\r\n      // 从新增中移除已删除的数据\r\n      XEUtils.remove(insertList, row => rows.indexOf(row) > -1)\r\n      xTable.handleTableData()\r\n      xTable.updateFooter()\r\n      xTable.updateCache()\r\n      xTable.checkSelectionStatus()\r\n      if (scrollYLoad) {\r\n        xTable.updateScrollYSpace()\r\n      }\r\n      return xTable.$nextTick().then(() => {\r\n        xTable.recalculate()\r\n        return {row: rest.length ? rest[rest.length - 1] : null, rows: rest}\r\n      })\r\n    },\r\n\r\n    /** 行重新排序 */\r\n    async rowResort(oldIndex, newIndex) {\r\n      const xTable = this.$refs.vxe.$refs.xTable\r\n      window.xTable = xTable\r\n      const sort = (array) => {\r\n        // 存储旧数据，并删除旧项目\r\n        let row = array.splice(oldIndex, 1)[0]\r\n        // 向新项目里添加旧数据\r\n        array.splice(newIndex, 0, row)\r\n      }\r\n      sort(xTable.tableFullData)\r\n      if (xTable.keepSource) {\r\n        sort(xTable.tableSourceData)\r\n      }\r\n      await this.$nextTick()\r\n      await this._recalcSortNumber()\r\n    },\r\n\r\n    /** 重新计算排序字段的数值 */\r\n    async _recalcSortNumber() {\r\n      const xTable = this.$refs.vxe.$refs.xTable\r\n      if (this.dragSort) {\r\n        xTable.tableFullData.forEach((data, idx) => data[this.dragSortKey] = (idx + 1))\r\n      }\r\n      await xTable.updateCache(true)\r\n      return await xTable.updateData()\r\n    },\r\n\r\n    async _addOrInsert(rows = {}, index, triggerName, isOnlJs) {\r\n      let {xTable} = this.$refs.vxe.$refs\r\n      let records\r\n      if (Array.isArray(rows)) {\r\n        delete rows.undefined\r\n        records = rows\r\n      } else {\r\n        delete rows.undefined\r\n        records = [rows]\r\n      }\r\n      console.log(records)\r\n      // 遍历添加默认值\r\n      records.forEach(record => this._createRow(record))\r\n      console.log(records)\r\n      let result = await this.pushRows(records, {index: index, setActive: true})\r\n      // 遍历插入的行\r\n      // update--begin--autor:lvdandan-----date:20201117------for:LOWCOD-987 【新行编辑】js增强附表内置方法调用问题 #1819\r\n      // online js增强时以传过来值为准，不再赋默认值\r\n      if (isOnlJs != true) {\r\n        for (let i = 0; i < result.rows.length; i++) {\r\n          let row = result.rows[i]\r\n          this.trigger(triggerName, {\r\n            row: row,\r\n            $table: xTable,\r\n            target: this,\r\n          })\r\n        }\r\n      }\r\n      // update--end--autor:lvdandan-----date:20201117------for:LOWCOD-987 【新行编辑】js增强附表内置方法调用问题 #1819\r\n      return result\r\n    },\r\n    // 创建新行，自动添加默认值\r\n    _createRow(record = {}) {\r\n      let {xTable} = this.$refs.vxe.$refs\r\n      // 添加默认值\r\n      xTable.tableFullColumn.forEach(column => {\r\n        let col = column.own\r\n        if (record[col.key] == null || record[col.key] === '') {\r\n          // 设置默认值\r\n          let createValue = getEnhancedMixins(col.$type || col.type, 'createValue')\r\n          record[col.key] = createValue({row: record, column, $table: xTable})\r\n        }\r\n      })\r\n      delete record.undefined\r\n      return record\r\n    },\r\n\r\n    /*--- 渲染函数 ---*/\r\n\r\n    // 渲染 vxe\r\n    renderVxeGrid(h) {\r\n      return h('vxe-grid', {\r\n        ref: 'vxe',\r\n        class: ['j-vxe-table'],\r\n        props: this.vxeProps,\r\n        on: this.vxeEvents,\r\n        // 作用域插槽的格式为\r\n        scopedSlots: this.$scopedSlots,\r\n      })\r\n    },\r\n    // 渲染工具栏\r\n    renderToolbar(h) {\r\n      var that = this\r\n      if (this.toolbar) {\r\n        return h('j-vxe-toolbar', {\r\n          props: {\r\n            toolbarConfig: this.toolbarConfig,\r\n            importBtn:this.importBtn,\r\n            excludeCode: this.excludeCode,\r\n            size: this.size,\r\n            disabled: this.disabled,\r\n            disabledRows: this.disabledRows,\r\n            selectedRowIds: this.selectedRowIds,\r\n          },\r\n          on: {\r\n            // 新增事件\r\n            add: () => this.addRows(),\r\n            // 保存事件\r\n            save: () => this.trigger('save', {\r\n              $table: this.$refs.vxe,\r\n              target: this,\r\n            }),\r\n            import() {\r\n              var formData = JSON.parse(window.localStorage.getItem('formData'))\r\n              var res = JSON.parse(window.localStorage.getItem('uploadresult'))\r\n              if(formData.type=='DutyData') {\r\n                  that.$emit('loadDataUpload',res)\r\n              }else if(formData.type=='WeekStatistics') {\r\n                that.dataSource = res\r\n              }\r\n            },\r\n            // 删除事件\r\n            remove: () => {\r\n              let $table = this.$refs.vxe\r\n              let deleteRows = this.filterNewRows(this.selectedRows)\r\n              // 触发删除事件\r\n              if (deleteRows.length > 0) {\r\n                let removeEvent = {deleteRows, $table, target: this}\r\n                if (this.asyncRemove) {\r\n                  // 确认删除，只有调用这个方法才会真删除\r\n                  removeEvent.confirmRemove = () => this.removeSelection()\r\n                } else {\r\n                  this.removeSelection()\r\n                }\r\n                this.trigger('remove', removeEvent)\r\n              } else {\r\n                this.removeSelection()\r\n              }\r\n            },\r\n            // 清除选择事件\r\n            clearSelection: this.clearSelection\r\n          },\r\n          scopedSlots: {\r\n            toolbarPrefix: this.$scopedSlots.toolbarPrefix,\r\n            toolbarSuffix: this.$scopedSlots.toolbarSuffix,\r\n          },\r\n        })\r\n      }\r\n      return null\r\n    },\r\n    // 渲染 toolbarAfter 插槽\r\n    renderToolbarAfterSlot() {\r\n      if (this.$scopedSlots['toolbarAfter']) {\r\n        return this.$scopedSlots['toolbarAfter']()\r\n      }\r\n      return null\r\n    },\r\n    // 渲染点击时弹出的子表\r\n    renderSubPopover(h) {\r\n      if (this.clickRowShowSubForm && this.$scopedSlots.subForm) {\r\n        return h('j-vxe-sub-popover', {\r\n          ref: 'subPopover',\r\n          scopedSlots: {\r\n            subForm: this.$scopedSlots.subForm,\r\n          }\r\n        })\r\n      }\r\n      return null\r\n    },\r\n    // 渲染点击时弹出的详细信息\r\n    renderDetailsModal(h) {\r\n      if (this.clickRowShowMainForm && this.$scopedSlots.mainForm) {\r\n        return h('j-vxe-details-modal', {\r\n          ref: 'detailsModal',\r\n          scopedSlots: {\r\n            subForm: this.clickRowShowSubForm ? this.$scopedSlots.subForm : null,\r\n            mainForm: this.$scopedSlots.mainForm\r\n          }\r\n        })\r\n      }\r\n    },\r\n    // 渲染分页器\r\n    renderPagination(h) {\r\n      if (this.pagination && Object.keys(this.pagination).length > 0) {\r\n        return h('j-vxe-pagination', {\r\n          props: {\r\n            size: this.size,\r\n            disabled: this.disabled,\r\n            pagination: this.pagination\r\n          },\r\n          on: {\r\n            change: (e) => this.trigger('pageChange', e)\r\n          },\r\n        })\r\n      }\r\n      return null\r\n    },\r\n    loadExcludeCode(){\r\n      if(!this.authPre || this.authPre.length==0){\r\n        this.excludeCode = []\r\n      }else{\r\n        let pre = this.authPre\r\n        if(!pre.endsWith(':')){\r\n          pre += ':'\r\n        }\r\n        this.excludeCode = getNoAuthCols(pre)\r\n      }\r\n    }\r\n\r\n  },\r\n  render(h) {\r\n    return h('div', {\r\n      class: ['j-vxe-table-box', `size--${this.size}`]\r\n    }, [\r\n      this.renderSubPopover(h),\r\n      this.renderDetailsModal(h),\r\n      this.renderToolbar(h),\r\n      this.renderToolbarAfterSlot(),\r\n      this.renderVxeGrid(h),\r\n      this.renderPagination(h),\r\n    ])\r\n  },\r\n  beforeDestroy() {\r\n    this.$emit('beforeDestroy')\r\n  }\r\n}\r\n\r\n// 兼容 online 的规则\r\nconst fooPatterns = [\r\n  {title: '非空', value: '*', pattern: /^.+$/},\r\n  {title: '6到16位数字', value: 'n6-16', pattern: /^\\d{6,18}$/},\r\n  {title: '6到16位任意字符', value: '*6-16', pattern: /^.{6,16}$/},\r\n  {title: '6到18位字母', value: 's6-18', pattern: /^[a-z|A-Z]{6,18}$/},\r\n  {title: '网址', value: 'url', pattern: /^(?:([A-Za-z]+):)?(\\/{0,3})([0-9.\\-A-Za-z]+)(?::(\\d+))?(?:\\/([^?#]*))?(?:\\?([^#]*))?(?:#(.*))?$/},\r\n  {title: '电子邮件', value: 'e', pattern: /^([\\w]+\\.*)([\\w]+)@[\\w]+\\.\\w{3}(\\.\\w{2}|)$/},\r\n  {title: '手机号码', value: 'm', pattern: /^1[3456789]\\d{9}$/},\r\n  {title: '邮政编码', value: 'p', pattern: /^[1-9]\\d{5}$/},\r\n  {title: '字母', value: 's', pattern: /^[A-Z|a-z]+$/},\r\n  {title: '数字', value: 'n', pattern: /^-?\\d+(\\.?\\d+|\\d?)$/},\r\n  {title: '整数', value: 'z', pattern: /^-?\\d+$/},\r\n  {title: '金额', value: 'money', pattern: /^(([1-9][0-9]*)|([0]\\.\\d{0,2}|[1-9][0-9]*\\.\\d{0,2}))$/},\r\n]\r\n\r\n/** 旧版handler转为新版Validator */\r\nfunction handlerConvertToValidator(event) {\r\n  const {column, rule} = event\r\n  return new Promise((resolve, reject) => {\r\n    rule.handler(event, (flag, msg) => {\r\n      let message = rule.message\r\n      if (typeof msg === 'string') {\r\n        message = replaceProps(column.own, msg)\r\n      }\r\n      if (flag == null) {\r\n        resolve(message)\r\n      } else if (!!flag) {\r\n        resolve(message)\r\n      } else {\r\n        reject(new Error(message))\r\n      }\r\n    }, this, event)\r\n  })\r\n}\r\n\r\n/** 唯一校验器 */\r\nfunction uniqueValidator(event) {\r\n  const {cellValue, column, rule} = event\r\n  let tableData = this.getTableData()\r\n  let findCount = 0\r\n  for (let rowData of tableData) {\r\n    if (rowData[column.own.key] === cellValue) {\r\n      if (++findCount >= 2) {\r\n        return Promise.reject(new Error(rule.message))\r\n      }\r\n    }\r\n  }\r\n  return Promise.resolve()\r\n}"]}]}