{"remainingRequest":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js!D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\views\\examples\\list\\modules\\RoleModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\src\\views\\examples\\list\\modules\\RoleModal.vue","mtime":1615948818186},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgZ2V0UGVybWlzc2lvbnMgfSBmcm9tICdAL2FwaS9tYW5hZ2UnOwppbXBvcnQgeyBhY3Rpb25Ub09iamVjdCB9IGZyb20gJ0AvdXRpbHMvcGVybWlzc2lvbnMnOwppbXBvcnQgcGljayBmcm9tICdsb2Rhc2gucGljayc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUm9sZU1vZGFsIiwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbGFiZWxDb2w6IHsKICAgICAgICB4czogewogICAgICAgICAgc3BhbjogMjQKICAgICAgICB9LAogICAgICAgIHNtOiB7CiAgICAgICAgICBzcGFuOiA1CiAgICAgICAgfQogICAgICB9LAogICAgICB3cmFwcGVyQ29sOiB7CiAgICAgICAgeHM6IHsKICAgICAgICAgIHNwYW46IDI0CiAgICAgICAgfSwKICAgICAgICBzbTogewogICAgICAgICAgc3BhbjogMTYKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICBjb25maXJtTG9hZGluZzogZmFsc2UsCiAgICAgIG1kbDoge30sCiAgICAgIGZvcm06IHRoaXMuJGZvcm0uY3JlYXRlRm9ybSh0aGlzKSwKICAgICAgcGVybWlzc2lvbnM6IFtdCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMubG9hZFBlcm1pc3Npb25zKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBhZGQ6IGZ1bmN0aW9uIGFkZCgpIHsKICAgICAgdGhpcy5lZGl0KHsKICAgICAgICBpZDogMAogICAgICB9KTsKICAgIH0sCiAgICBlZGl0OiBmdW5jdGlvbiBlZGl0KHJlY29yZCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMubWRsID0gT2JqZWN0LmFzc2lnbih7fSwgcmVjb3JkKTsKICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTsgLy8g5pyJ5p2D6ZmQ6KGo77yM5aSE55CG5Yu+6YCJCgogICAgICBpZiAodGhpcy5tZGwucGVybWlzc2lvbnMgJiYgdGhpcy5wZXJtaXNzaW9ucykgewogICAgICAgIC8vIOWFiOWkhOeQhuimgeWLvumAieeahOadg+mZkOe7k+aehAogICAgICAgIHZhciBwZXJtaXNzaW9uc0FjdGlvbiA9IHt9OwogICAgICAgIHRoaXMubWRsLnBlcm1pc3Npb25zLmZvckVhY2goZnVuY3Rpb24gKHBlcm1pc3Npb24pIHsKICAgICAgICAgIHBlcm1pc3Npb25zQWN0aW9uW3Blcm1pc3Npb24ucGVybWlzc2lvbklkXSA9IHBlcm1pc3Npb24uYWN0aW9uRW50aXR5U2V0Lm1hcChmdW5jdGlvbiAoZW50aXR5KSB7CiAgICAgICAgICAgIHJldHVybiBlbnRpdHkuYWN0aW9uOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7IC8vIOaKiuadg+mZkOihqOmBjeWOhuS4gOmBje+8jOiuvuWumuimgeWLvumAieeahOadg+mZkCBhY3Rpb24KCiAgICAgICAgdGhpcy5wZXJtaXNzaW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChwZXJtaXNzaW9uKSB7CiAgICAgICAgICBwZXJtaXNzaW9uLnNlbGVjdGVkID0gcGVybWlzc2lvbnNBY3Rpb25bcGVybWlzc2lvbi5pZF07CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczIuZm9ybS5zZXRGaWVsZHNWYWx1ZShwaWNrKF90aGlzMi5tZGwsICdpZCcsICduYW1lJywgJ3N0YXR1cycsICdkZXNjcmliZScpKTsKICAgICAgfSk7CiAgICAgIGNvbnNvbGUubG9nKCd0aGlzLm1kbCcsIHRoaXMubWRsKTsKICAgIH0sCiAgICBjbG9zZTogZnVuY3Rpb24gY2xvc2UoKSB7CiAgICAgIHRoaXMuJGVtaXQoJ2Nsb3NlJyk7CiAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlOwogICAgfSwKICAgIGhhbmRsZU9rOiBmdW5jdGlvbiBoYW5kbGVPaygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsgLy8g6Kem5Y+R6KGo5Y2V6aqM6K+BCgoKICAgICAgdGhpcy5mb3JtLnZhbGlkYXRlRmllbGRzKGZ1bmN0aW9uIChlcnIsIHZhbHVlcykgewogICAgICAgIC8vIOmqjOivgeihqOWNleayoemUmeivrwogICAgICAgIGlmICghZXJyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnZm9ybSB2YWx1ZXMnLCB2YWx1ZXMpOwogICAgICAgICAgX3RoaXMuY29uZmlybUxvYWRpbmcgPSB0cnVlOyAvLyDmqKHmi5/lkI7nq6/or7fmsYIgMjAwMCDmr6vnp5Llu7bov58KCiAgICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSgpOwogICAgICAgICAgICB9LCAyMDAwKTsKICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvLyBEbyBzb21ldGhpbmcKICAgICAgICAgICAgX3RoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5L+d5a2Y5oiQ5YqfJyk7CgogICAgICAgICAgICBfdGhpcy4kZW1pdCgnb2snKTsKICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsvLyBEbyBzb21ldGhpbmcKICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpcy5jb25maXJtTG9hZGluZyA9IGZhbHNlOwoKICAgICAgICAgICAgX3RoaXMuY2xvc2UoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlQ2FuY2VsOiBmdW5jdGlvbiBoYW5kbGVDYW5jZWwoKSB7CiAgICAgIHRoaXMuY2xvc2UoKTsKICAgIH0sCiAgICBvbkNoYW5nZUNoZWNrOiBmdW5jdGlvbiBvbkNoYW5nZUNoZWNrKHBlcm1pc3Npb24pIHsKICAgICAgcGVybWlzc2lvbi5pbmRldGVybWluYXRlID0gISFwZXJtaXNzaW9uLnNlbGVjdGVkLmxlbmd0aCAmJiBwZXJtaXNzaW9uLnNlbGVjdGVkLmxlbmd0aCA8IHBlcm1pc3Npb24uYWN0aW9uc09wdGlvbnMubGVuZ3RoOwogICAgICBwZXJtaXNzaW9uLmNoZWNrZWRBbGwgPSBwZXJtaXNzaW9uLnNlbGVjdGVkLmxlbmd0aCA9PT0gcGVybWlzc2lvbi5hY3Rpb25zT3B0aW9ucy5sZW5ndGg7CiAgICB9LAogICAgb25DaGFuZ2VDaGVja0FsbDogZnVuY3Rpb24gb25DaGFuZ2VDaGVja0FsbChlLCBwZXJtaXNzaW9uKSB7CiAgICAgIE9iamVjdC5hc3NpZ24ocGVybWlzc2lvbiwgewogICAgICAgIHNlbGVjdGVkOiBlLnRhcmdldC5jaGVja2VkID8gcGVybWlzc2lvbi5hY3Rpb25zT3B0aW9ucy5tYXAoZnVuY3Rpb24gKG9iaikgewogICAgICAgICAgcmV0dXJuIG9iai52YWx1ZTsKICAgICAgICB9KSA6IFtdLAogICAgICAgIGluZGV0ZXJtaW5hdGU6IGZhbHNlLAogICAgICAgIGNoZWNrZWRBbGw6IGUudGFyZ2V0LmNoZWNrZWQKICAgICAgfSk7CiAgICB9LAogICAgbG9hZFBlcm1pc3Npb25zOiBmdW5jdGlvbiBsb2FkUGVybWlzc2lvbnMoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgZ2V0UGVybWlzc2lvbnMoKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICB2YXIgcmVzdWx0ID0gcmVzLnJlc3VsdDsKICAgICAgICBfdGhpczMucGVybWlzc2lvbnMgPSByZXN1bHQubWFwKGZ1bmN0aW9uIChwZXJtaXNzaW9uKSB7CiAgICAgICAgICB2YXIgb3B0aW9ucyA9IGFjdGlvblRvT2JqZWN0KHBlcm1pc3Npb24uYWN0aW9uRGF0YSk7CiAgICAgICAgICBwZXJtaXNzaW9uLmNoZWNrZWRBbGwgPSBmYWxzZTsKICAgICAgICAgIHBlcm1pc3Npb24uc2VsZWN0ZWQgPSBbXTsKICAgICAgICAgIHBlcm1pc3Npb24uaW5kZXRlcm1pbmF0ZSA9IGZhbHNlOwogICAgICAgICAgcGVybWlzc2lvbi5hY3Rpb25zT3B0aW9ucyA9IG9wdGlvbnMubWFwKGZ1bmN0aW9uIChvcHRpb24pIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICBsYWJlbDogb3B0aW9uLmRlc2NyaWJlLAogICAgICAgICAgICAgIHZhbHVlOiBvcHRpb24uYWN0aW9uCiAgICAgICAgICAgIH07CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBwZXJtaXNzaW9uOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["RoleModal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <a-modal\r\n    title=\"操作\"\r\n    :width=\"800\"\r\n    :visible=\"visible\"\r\n    :confirmLoading=\"confirmLoading\"\r\n    @ok=\"handleOk\"\r\n    @cancel=\"handleCancel\"\r\n  >\r\n    <a-spin :spinning=\"confirmLoading\">\r\n      <a-form :form=\"form\">\r\n\r\n        <a-form-item\r\n          :labelCol=\"labelCol\"\r\n          :wrapperCol=\"wrapperCol\"\r\n          label=\"唯一识别码\"\r\n          hasFeedback\r\n        >\r\n          <a-input placeholder=\"唯一识别码\" disabled=\"disabled\" v-decorator=\"[ 'id', {rules: []} ]\" />\r\n        </a-form-item>\r\n\r\n        <a-form-item\r\n          :labelCol=\"labelCol\"\r\n          :wrapperCol=\"wrapperCol\"\r\n          label=\"角色名称\"\r\n          hasFeedback >\r\n          <a-input placeholder=\"起一个名字\" v-decorator=\"[ 'name', {rules: [{ required: true, message: '不起一个名字吗？' }] }]\" />\r\n        </a-form-item>\r\n\r\n        <a-form-item\r\n          :labelCol=\"labelCol\"\r\n          :wrapperCol=\"wrapperCol\"\r\n          label=\"状态\"\r\n          hasFeedback >\r\n          <a-select v-decorator=\"[ 'status', {rules: []} ]\">\r\n            <a-select-option :value=\"1\">正常</a-select-option>\r\n            <a-select-option :value=\"2\">禁用</a-select-option>\r\n          </a-select>\r\n        </a-form-item>\r\n\r\n        <a-form-item\r\n          :labelCol=\"labelCol\"\r\n          :wrapperCol=\"wrapperCol\"\r\n          label=\"描述\"\r\n          hasFeedback\r\n        >\r\n          <a-textarea :rows=\"5\" placeholder=\"...\" v-decorator=\"[ 'describe', { rules: [] } ]\" />\r\n        </a-form-item>\r\n\r\n        <a-divider/>\r\n\r\n        <a-form-item\r\n          :labelCol=\"labelCol\"\r\n          :wrapperCol=\"wrapperCol\"\r\n          label=\"拥有权限\"\r\n          hasFeedback\r\n        >\r\n          <a-row :gutter=\"16\" v-for=\"(permission, index) in permissions\" :key=\"index\">\r\n            <a-col :span=\"4\">\r\n              {{ permission.name }}：\r\n            </a-col>\r\n            <a-col :span=\"20\">\r\n              <a-checkbox\r\n                v-if=\"permission.actionsOptions.length > 0\"\r\n                :indeterminate=\"permission.indeterminate\"\r\n                :checked=\"permission.checkedAll\"\r\n                @change=\"onChangeCheckAll($event, permission)\">\r\n                全选\r\n              </a-checkbox>\r\n              <a-checkbox-group :options=\"permission.actionsOptions\" v-model=\"permission.selected\" @change=\"onChangeCheck(permission)\" />\r\n            </a-col>\r\n          </a-row>\r\n\r\n        </a-form-item>\r\n      </a-form>\r\n    </a-spin>\r\n  </a-modal>\r\n</template>\r\n\r\n<script>\r\n  import { getPermissions } from '@/api/manage'\r\n  import { actionToObject } from '@/utils/permissions'\r\n  import pick from 'lodash.pick'\r\n\r\n  export default {\r\n    name: \"RoleModal\",\r\n    data () {\r\n      return {\r\n        labelCol: {\r\n          xs: { span: 24 },\r\n          sm: { span: 5 },\r\n        },\r\n        wrapperCol: {\r\n          xs: { span: 24 },\r\n          sm: { span: 16 },\r\n        },\r\n        visible: false,\r\n        confirmLoading: false,\r\n        mdl: {},\r\n\r\n        form: this.$form.createForm(this),\r\n        permissions: []\r\n      }\r\n    },\r\n    created () {\r\n      this.loadPermissions()\r\n    },\r\n    methods: {\r\n      add () {\r\n        this.edit({ id: 0 })\r\n      },\r\n      edit (record) {\r\n        this.mdl = Object.assign({}, record)\r\n        this.visible = true\r\n\r\n        // 有权限表，处理勾选\r\n        if (this.mdl.permissions && this.permissions) {\r\n          // 先处理要勾选的权限结构\r\n          const permissionsAction = {}\r\n          this.mdl.permissions.forEach(permission => {\r\n            permissionsAction[permission.permissionId] = permission.actionEntitySet.map(entity => entity.action)\r\n          })\r\n          // 把权限表遍历一遍，设定要勾选的权限 action\r\n          this.permissions.forEach(permission => {\r\n            permission.selected = permissionsAction[permission.id]\r\n          })\r\n        }\r\n\r\n        this.$nextTick(() => {\r\n          this.form.setFieldsValue(pick(this.mdl, 'id', 'name', 'status', 'describe'))\r\n        })\r\n        console.log('this.mdl', this.mdl)\r\n\r\n      },\r\n      close () {\r\n        this.$emit('close')\r\n        this.visible = false\r\n      },\r\n      handleOk () {\r\n        const _this = this\r\n        // 触发表单验证\r\n        this.form.validateFields((err, values) => {\r\n          // 验证表单没错误\r\n          if (!err) {\r\n            console.log('form values', values)\r\n\r\n            _this.confirmLoading = true\r\n            // 模拟后端请求 2000 毫秒延迟\r\n            new Promise((resolve) => {\r\n              setTimeout(() => resolve(), 2000)\r\n            }).then(() => {\r\n              // Do something\r\n              _this.$message.success('保存成功')\r\n              _this.$emit('ok')\r\n            }).catch(() => {\r\n              // Do something\r\n            }).finally(() => {\r\n              _this.confirmLoading = false\r\n              _this.close()\r\n            })\r\n          }\r\n        })\r\n      },\r\n      handleCancel () {\r\n        this.close()\r\n      },\r\n      onChangeCheck (permission) {\r\n        permission.indeterminate = !!permission.selected.length && (permission.selected.length < permission.actionsOptions.length)\r\n        permission.checkedAll = permission.selected.length === permission.actionsOptions.length\r\n      },\r\n      onChangeCheckAll (e, permission) {\r\n        Object.assign(permission, {\r\n          selected: e.target.checked ? permission.actionsOptions.map(obj => obj.value) : [],\r\n          indeterminate: false,\r\n          checkedAll: e.target.checked\r\n        })\r\n      },\r\n      loadPermissions () {\r\n        getPermissions().then(res => {\r\n          let result = res.result\r\n          this.permissions = result.map(permission => {\r\n            const options = actionToObject(permission.actionData)\r\n            permission.checkedAll = false\r\n            permission.selected = []\r\n            permission.indeterminate = false\r\n            permission.actionsOptions = options.map(option => {\r\n              return {\r\n                label: option.describe,\r\n                value: option.action\r\n              }\r\n            })\r\n            return permission\r\n          })\r\n        })\r\n      }\r\n\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"],"sourceRoot":"src/views/examples/list/modules"}]}