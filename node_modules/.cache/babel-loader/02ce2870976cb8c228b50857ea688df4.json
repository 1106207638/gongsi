{"remainingRequest":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js!D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\components\\jeecg\\JImportModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\src\\components\\jeecg\\JImportModal.vue","mtime":1615948815736},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgeyBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09ICJbb2JqZWN0IEFyZ3VtZW50c10iKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0gfQoKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgcG9zdEFjdGlvbiB9IGZyb20gJ0AvYXBpL21hbmFnZSc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnSkltcG9ydE1vZGFsJywKICBwcm9wczogewogICAgdXJsOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJycsCiAgICAgIHJlcXVpcmVkOiBmYWxzZQogICAgfSwKICAgIGJpejogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICcnLAogICAgICByZXF1aXJlZDogZmFsc2UKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB2aXNpYmxlOiBmYWxzZSwKICAgICAgdXBsb2FkaW5nOiBmYWxzZSwKICAgICAgZmlsZUxpc3Q6IFtdLAogICAgICB1cGxvYWRBY3Rpb246ICcnLAogICAgICBmb3JlaWduS2V5czogJycKICAgIH07CiAgfSwKICB3YXRjaDogewogICAgdXJsOiBmdW5jdGlvbiB1cmwodmFsKSB7CiAgICAgIGlmICh2YWwpIHsKICAgICAgICB0aGlzLnVwbG9hZEFjdGlvbiA9IHdpbmRvdy5fQ09ORklHWydkb21pYW5VUkwnXSArIHZhbDsKICAgICAgfQogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMudXBsb2FkQWN0aW9uID0gd2luZG93Ll9DT05GSUdbJ2RvbWlhblVSTCddICsgdGhpcy51cmw7CiAgfSwKICBtZXRob2RzOiB7CiAgICBoYW5kbGVDbG9zZTogZnVuY3Rpb24gaGFuZGxlQ2xvc2UoKSB7CiAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlOwogICAgfSwKICAgIHNob3c6IGZ1bmN0aW9uIHNob3coYXJnKSB7CiAgICAgIHRoaXMuZmlsZUxpc3QgPSBbXTsKICAgICAgdGhpcy51cGxvYWRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTsKICAgICAgdGhpcy5mb3JlaWduS2V5cyA9IGFyZzsKICAgIH0sCiAgICBoYW5kbGVSZW1vdmU6IGZ1bmN0aW9uIGhhbmRsZVJlbW92ZShmaWxlKSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuZmlsZUxpc3QuaW5kZXhPZihmaWxlKTsKICAgICAgdmFyIG5ld0ZpbGVMaXN0ID0gdGhpcy5maWxlTGlzdC5zbGljZSgpOwogICAgICBuZXdGaWxlTGlzdC5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB0aGlzLmZpbGVMaXN0ID0gbmV3RmlsZUxpc3Q7CiAgICB9LAogICAgYmVmb3JlVXBsb2FkOiBmdW5jdGlvbiBiZWZvcmVVcGxvYWQoZmlsZSkgewogICAgICB0aGlzLmZpbGVMaXN0ID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheSh0aGlzLmZpbGVMaXN0KSwgW2ZpbGVdKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIGhhbmRsZUltcG9ydDogZnVuY3Rpb24gaGFuZGxlSW1wb3J0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGZpbGVMaXN0ID0gdGhpcy5maWxlTGlzdDsKICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CgogICAgICBpZiAodGhpcy5iaXopIHsKICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2lzU2luZ2xlVGFibGVJbXBvcnQnLCB0aGlzLmJpeik7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmZvcmVpZ25LZXlzICYmIHRoaXMuZm9yZWlnbktleXMubGVuZ3RoID4gMCkgewogICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZm9yZWlnbktleXMnLCB0aGlzLmZvcmVpZ25LZXlzKTsKICAgICAgfQoKICAgICAgZmlsZUxpc3QuZm9yRWFjaChmdW5jdGlvbiAoZmlsZSkgewogICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZXNbXScsIGZpbGUpOwogICAgICB9KTsKICAgICAgdGhpcy51cGxvYWRpbmcgPSB0cnVlOwogICAgICBwb3N0QWN0aW9uKHRoaXMudXBsb2FkQWN0aW9uLCBmb3JtRGF0YSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMudXBsb2FkaW5nID0gZmFsc2U7CgogICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgX3RoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXMubWVzc2FnZSk7CgogICAgICAgICAgX3RoaXMudmlzaWJsZSA9IGZhbHNlOwoKICAgICAgICAgIF90aGlzLiRlbWl0KCdvaycpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpcy4kbWVzc2FnZS53YXJuaW5nKHJlcy5tZXNzYWdlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["JImportModal.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <a-modal\r\n    title=\"导入EXCEL\"\r\n    :width=\"600\"\r\n    :visible=\"visible\"\r\n    :confirmLoading=\"uploading\"\r\n    @cancel=\"handleClose\">\r\n\r\n    <a-upload\r\n      name=\"file\"\r\n      :multiple=\"true\"\r\n      accept=\".xls,.xlsx\"\r\n      :fileList=\"fileList\"\r\n      :remove=\"handleRemove\"\r\n      :beforeUpload=\"beforeUpload\">\r\n      <a-button>\r\n        <a-icon type=\"upload\" />\r\n        选择导入文件\r\n      </a-button>\r\n    </a-upload>\r\n\r\n    <template slot=\"footer\">\r\n      <a-button @click=\"handleClose\">关闭</a-button>\r\n      <a-button\r\n        type=\"primary\"\r\n        @click=\"handleImport\"\r\n        :disabled=\"fileList.length === 0\"\r\n        :loading=\"uploading\">\r\n        {{ uploading ? '上传中...' : '开始上传' }}\r\n      </a-button>\r\n    </template>\r\n\r\n  </a-modal>\r\n</template>\r\n\r\n<script>\r\n  import { postAction } from '@/api/manage'\r\n  export default {\r\n    name: 'JImportModal',\r\n    props:{\r\n      url:{\r\n        type: String,\r\n        default: '',\r\n        required: false\r\n      },\r\n      biz:{\r\n        type: String,\r\n        default: '',\r\n        required: false\r\n      }\r\n    },\r\n    data(){\r\n      return {\r\n        visible:false,\r\n        uploading:false,\r\n        fileList:[],\r\n        uploadAction:'',\r\n        foreignKeys:''\r\n      }\r\n    },\r\n    watch: {\r\n      url (val) {\r\n        if(val){\r\n         this.uploadAction = window._CONFIG['domianURL']+val\r\n        }\r\n      }\r\n    },\r\n    created () {\r\n      this.uploadAction = window._CONFIG['domianURL']+this.url\r\n    },\r\n\r\n    methods:{\r\n      handleClose(){\r\n        this.visible=false\r\n      },\r\n      show(arg){\r\n        this.fileList = []\r\n        this.uploading = false\r\n        this.visible = true\r\n        this.foreignKeys = arg;\r\n      },\r\n      handleRemove(file) {\r\n        const index = this.fileList.indexOf(file);\r\n        const newFileList = this.fileList.slice();\r\n        newFileList.splice(index, 1);\r\n        this.fileList = newFileList\r\n      },\r\n      beforeUpload(file) {\r\n        this.fileList = [...this.fileList, file]\r\n        return false;\r\n      },\r\n      handleImport() {\r\n        const { fileList } = this;\r\n        const formData = new FormData();\r\n        if(this.biz){\r\n          formData.append('isSingleTableImport',this.biz);\r\n        }\r\n        if(this.foreignKeys && this.foreignKeys.length>0){\r\n          formData.append('foreignKeys',this.foreignKeys);\r\n        }\r\n        fileList.forEach((file) => {\r\n          formData.append('files[]', file);\r\n        });\r\n        this.uploading = true\r\n        postAction(this.uploadAction, formData).then((res) => {\r\n          this.uploading = false\r\n          if(res.success){\r\n            this.$message.success(res.message)\r\n            this.visible=false\r\n            this.$emit('ok')\r\n          }else{\r\n            this.$message.warning(res.message)\r\n          }\r\n        })\r\n      }\r\n\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"],"sourceRoot":"src/components/jeecg"}]}