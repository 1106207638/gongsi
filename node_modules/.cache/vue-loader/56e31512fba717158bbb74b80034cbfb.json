{"remainingRequest":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\components\\CountDown\\CountDown.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\src\\components\\CountDown\\CountDown.vue","mtime":1615948813397},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KCgpmdW5jdGlvbiBmaXhlZFplcm8odmFsKSB7CiAgcmV0dXJuIHZhbCAqIDEgPCAxMCA/IGAwJHt2YWx9YCA6IHZhbDsKfQoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJDb3VudERvd24iLAogIHByb3BzOiB7CiAgICBmb3JtYXQ6IHsKICAgICAgdHlwZTogRnVuY3Rpb24sCiAgICAgIGRlZmF1bHQ6IHVuZGVmaW5lZAogICAgfSwKICAgIHRhcmdldDogewogICAgICB0eXBlOiBbRGF0ZSwgTnVtYmVyXSwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAogICAgb25FbmQ6IHsKICAgICAgdHlwZTogRnVuY3Rpb24sCiAgICAgIGRlZmF1bHQ6ICgpID0+IHsKICAgICAgfQogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGRhdGVUaW1lOiAnMCcsCiAgICAgIG9yaWdpblRhcmdldFRpbWU6IDAsCiAgICAgIGxhc3RUaW1lOiAwLAogICAgICB0aW1lcjogMCwKICAgICAgaW50ZXJ2YWw6IDEwMDAKICAgIH0KICB9LAogIGZpbHRlcnM6IHsKICAgIGZvcm1hdCh0aW1lKSB7CiAgICAgIGNvbnN0IGhvdXJzID0gNjAgKiA2MCAqIDEwMDA7CiAgICAgIGNvbnN0IG1pbnV0ZXMgPSA2MCAqIDEwMDA7CgogICAgICBjb25zdCBoID0gTWF0aC5mbG9vcih0aW1lIC8gaG91cnMpOwogICAgICBjb25zdCBtID0gTWF0aC5mbG9vcigodGltZSAtIGggKiBob3VycykgLyBtaW51dGVzKTsKICAgICAgY29uc3QgcyA9IE1hdGguZmxvb3IoKHRpbWUgLSBoICogaG91cnMgLSBtICogbWludXRlcykgLyAxMDAwKTsKICAgICAgcmV0dXJuIGAke2ZpeGVkWmVybyhoKX06JHtmaXhlZFplcm8obSl9OiR7Zml4ZWRaZXJvKHMpfWAKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmluaXRUaW1lKCkKICAgIHRoaXMudGljaygpCiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0VGltZSgpIHsKICAgICAgbGV0IGxhc3RUaW1lID0gMDsKICAgICAgbGV0IHRhcmdldFRpbWUgPSAwOwogICAgICB0aGlzLm9yaWdpblRhcmdldFRpbWUgPSB0aGlzLnRhcmdldAogICAgICB0cnkgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodGhpcy50YXJnZXQpID09PSAnW29iamVjdCBEYXRlXScpIHsKICAgICAgICAgIHRhcmdldFRpbWUgPSB0aGlzLnRhcmdldAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0YXJnZXRUaW1lID0gbmV3IERhdGUodGhpcy50YXJnZXQpLmdldFRpbWUoKQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCB0YXJnZXQgcHJvcCcpCiAgICAgIH0KCiAgICAgIGxhc3RUaW1lID0gdGFyZ2V0VGltZSAtIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwoKICAgICAgdGhpcy5sYXN0VGltZSA9IGxhc3RUaW1lIDwgMCA/IDAgOiBsYXN0VGltZQogICAgfSwKICAgIHRpY2soKSB7CiAgICAgIGNvbnN0IHtvbkVuZH0gPSB0aGlzCgogICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgaWYgKHRoaXMubGFzdFRpbWUgPCB0aGlzLmludGVydmFsKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcikKICAgICAgICAgIHRoaXMubGFzdFRpbWUgPSAwCiAgICAgICAgICBpZiAodHlwZW9mIG9uRW5kID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIG9uRW5kKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMubGFzdFRpbWUgLT0gdGhpcy5pbnRlcnZhbAogICAgICAgICAgdGhpcy50aWNrKCkKICAgICAgICB9CiAgICAgIH0sIHRoaXMuaW50ZXJ2YWwpCiAgICB9CiAgfSwKICBiZWZvcmVVcGRhdGUgKCkgewogICAgaWYgKHRoaXMub3JpZ2luVGFyZ2V0VGltZSAhPT0gdGhpcy50YXJnZXQpIHsKICAgICAgdGhpcy5pbml0VGltZSgpCiAgICB9CiAgfSwKICBiZWZvcmVEZXN0cm95KCkgewogICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpCiAgfQp9Cg=="},{"version":3,"sources":["CountDown.vue"],"names":[],"mappings":";;;;;;;;AAQA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CountDown.vue","sourceRoot":"src/components/CountDown","sourcesContent":["<template>\r\n  <span>\r\n    {{ lastTime | format }}\r\n  </span>\r\n</template>\r\n\r\n<script>\r\n\r\n  function fixedZero(val) {\r\n    return val * 1 < 10 ? `0${val}` : val;\r\n  }\r\n\r\n  export default {\r\n    name: \"CountDown\",\r\n    props: {\r\n      format: {\r\n        type: Function,\r\n        default: undefined\r\n      },\r\n      target: {\r\n        type: [Date, Number],\r\n        required: true,\r\n      },\r\n      onEnd: {\r\n        type: Function,\r\n        default: () => {\r\n        }\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        dateTime: '0',\r\n        originTargetTime: 0,\r\n        lastTime: 0,\r\n        timer: 0,\r\n        interval: 1000\r\n      }\r\n    },\r\n    filters: {\r\n      format(time) {\r\n        const hours = 60 * 60 * 1000;\r\n        const minutes = 60 * 1000;\r\n\r\n        const h = Math.floor(time / hours);\r\n        const m = Math.floor((time - h * hours) / minutes);\r\n        const s = Math.floor((time - h * hours - m * minutes) / 1000);\r\n        return `${fixedZero(h)}:${fixedZero(m)}:${fixedZero(s)}`\r\n      }\r\n    },\r\n    created() {\r\n      this.initTime()\r\n      this.tick()\r\n    },\r\n    methods: {\r\n      initTime() {\r\n        let lastTime = 0;\r\n        let targetTime = 0;\r\n        this.originTargetTime = this.target\r\n        try {\r\n          if (Object.prototype.toString.call(this.target) === '[object Date]') {\r\n            targetTime = this.target\r\n          } else {\r\n            targetTime = new Date(this.target).getTime()\r\n          }\r\n        } catch (e) {\r\n          throw new Error('invalid target prop')\r\n        }\r\n\r\n        lastTime = targetTime - new Date().getTime();\r\n\r\n        this.lastTime = lastTime < 0 ? 0 : lastTime\r\n      },\r\n      tick() {\r\n        const {onEnd} = this\r\n\r\n        this.timer = setTimeout(() => {\r\n          if (this.lastTime < this.interval) {\r\n            clearTimeout(this.timer)\r\n            this.lastTime = 0\r\n            if (typeof onEnd === 'function') {\r\n              onEnd();\r\n            }\r\n          } else {\r\n            this.lastTime -= this.interval\r\n            this.tick()\r\n          }\r\n        }, this.interval)\r\n      }\r\n    },\r\n    beforeUpdate () {\r\n      if (this.originTargetTime !== this.target) {\r\n        this.initTime()\r\n      }\r\n    },\r\n    beforeDestroy() {\r\n      clearTimeout(this.timer)\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]}]}