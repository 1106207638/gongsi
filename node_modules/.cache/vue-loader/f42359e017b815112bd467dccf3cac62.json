{"remainingRequest":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\views\\zbtest\\cblbdetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\src\\views\\zbtest\\cblbdetail.vue","mtime":1616030468385},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTVGFibGUgZnJvbSAiQC9jb21wb25lbnRzL3RhYmxlLyI7CmltcG9ydCB7IGdldEFjdGlvbiB9IGZyb20gIkAvYXBpL21hbmFnZSI7CmltcG9ydCB7IEpWWEVUeXBlcyB9IGZyb20gIkBjb21wL2plZWNnL0pWeGVUYWJsZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImNibGJkZXRhaWwiLAogIGNvbXBvbmVudHM6IHsKICAgIFNUYWJsZSwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpZDogdGhpcy4kcm91dGUucGFyYW1zLmlkLAogICAgICBpbmRleFN0eWxlOiAxLAogICAgICBpc3RhYmxlOiB0cnVlLAogICAgICBjb2x1bW5zOiBbXSwKICAgICAgY29sdW1uc3M6IFtdLAogICAgICB0YWJzOiBbXSwKICAgICAgdXJsOiB7CiAgICAgICAgbGlzdDogIi9yZXBvcnRGb3JtTW9kZWwvcXVlcnlSZXBvcnRGb3JtRGF0YSIsCiAgICAgICAgZGV0YWlsczogIi9yZXBvcnRGb3JtTW9kZWwvcXVlcnlSZXBvcnRGb3JtRGF0YSIsCiAgICAgICAgc3RydWN0dXJlOiAiL3NvdXRoVGFibGUvcXVlcnlUYWJsZVN0cnVjdHVyZSIsIC8v57uT5p6ECiAgICAgIH0sCiAgICAgIGRhdGFTb3VyY2U6IFtdLAogICAgICBoZWFkVmVyc2lvbjoge30sCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0RGVwdEhlYWREZXRhaWxzKCk7CiAgfSwKICBtb3VudGVkKCkge30sCiAgbWV0aG9kczogewogICAgLy8gIOeJiOacrOivpuaDhQogICAgZ2V0RGVwdEhlYWREZXRhaWxzKCkgewogICAgICBnZXRBY3Rpb24odGhpcy51cmwuZGV0YWlscyArICI/aWQ9IiArIHRoaXMuaWQsIHt9KS50aGVuKChyZXMpID0+IHsKICAgICAgICBpZiAocmVzLmNvZGUgPT0gMjAwKSB7CiAgICAgICAgICB0aGlzLmRhdGFTb3VyY2UgPSByZXMucmVzdWx0LmRhdGE7CiAgICAgICAgICB0aGlzLmhlYWRWZXJzaW9uID0gcmVzLnJlc3VsdC5oZWFkVmVyc2lvbjsKICAgICAgICAgIHRoaXMuZ2V0U3RydWN0dXJlKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1lc3NhZ2UpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy8g5p+l6K+i57uT5p6E77yIdGFibGXnmoTlpLTpg6jvvIkKICAgIGdldFN0cnVjdHVyZSgpIHsKICAgICAgLy8g5bCB6KOF5p+l6K+i5p2h5Lu2CiAgICAgIGxldCBmb3JtRGF0YSA9IHsKICAgICAgICByZXBvcnRGcm9tVHlwZTogdGhpcy5oZWFkVmVyc2lvbi5yZXBvcnRGb3JtVHlwZSwKICAgICAgICB0ZW1wbGF0ZVR5cGU6IHRoaXMuaGVhZFZlcnNpb24uYnVzaW5lc3NUeXBlSWQsCiAgICAgIH07CiAgICAgIC8vIOiwg+eUqOafpeivouaVsOaNruaOpeWPowogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICBnZXRBY3Rpb24odGhpcy51cmwuc3RydWN0dXJlLCBmb3JtRGF0YSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgaWYgKGZvcm1EYXRhLnJlcG9ydEZyb21UeXBlICE9ICJEdXR5RGF0YSIpIHsKICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gcmVzLnJlc3VsdDsKICAgICAgICAgICAgICAvLyDlsIbmn6Xor6LnmoTmlbDmja7otYvlgLznu5kgZGF0YVNvdXJjZQogICAgICAgICAgICAgIHZhciBhcnIgPSBbXTsKICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKHJlc3VsdFtpXS5pc1Nob3dGb3JtID09IDEpIHsKICAgICAgICAgICAgICAgICAgYXJyLnB1c2goewogICAgICAgICAgICAgICAgICAgIGRhdGFJbmRleDogcmVzdWx0W2ldLmRiRmllbGROYW1lLAogICAgICAgICAgICAgICAgICAgIHRpdGxlOiByZXN1bHRbaV0uZGJGaWVsZFR4dCwKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRoaXMuamRlbW9zaG93ID0gdHJ1ZTsKICAgICAgICAgICAgICB0aGlzLmNvbHVtbnMgPSBhcnI7CiAgICAgICAgICAgICAgdGhpcy5jb2x1bW5zcyA9IFtdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8v5omn5Yuk5pWw5o2uCiAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHJlcy5yZXN1bHQ7CiAgICAgICAgICAgICAgdmFyIGNvbHVtbnMgPSBbXTsKICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgdmFyIGFyciA9IFtdOwogICAgICAgICAgICAgICAgdmFyIG9iaiA9IHsKICAgICAgICAgICAgICAgICAgbmFtZTogcmVzdWx0W2ldLnNoZWV0TmFtZSwKICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZTogW10sCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSByZXN1bHRbaV0uZmllbGRzOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCByZXN1bHRzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzW2pdLmlzU2hvd0Zvcm0gPT0gMSkgewogICAgICAgICAgICAgICAgICAgIGFyci5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgIGRhdGFJbmRleDogcmVzdWx0c1tqXS5kYkZpZWxkTmFtZSwKICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiByZXN1bHRzW2pdLmRiRmllbGRUeHQsCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG9iai5jb2x1bW5zID0gYXJyOwogICAgICAgICAgICAgICAgY29sdW1ucy5wdXNoKG9iaik7CiAgICAgICAgICAgICAgICB0aGlzLnRhYnMucHVzaCh7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiByZXN1bHRbaV0uc2hlZXROYW1lLAogICAgICAgICAgICAgICAgICBjb2x1bW5zOiBhcnIsCiAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2U6IHRoaXMuZGF0YVNvdXJjZVtpXSwKICAgICAgICAgICAgICAgICAga2V5OiBpLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRoaXMuY29sdW1uc3MgPSBjb2x1bW5zOwogICAgICAgICAgICAgIHRoaXMuamRlbW9zaG93ID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuJGVycm9yKHsgdGl0bGU6ICLkuLvooajmn6Xor6LlpLHotKUiLCBjb250ZW50OiByZXMubWVzc2FnZSB9KTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5maW5hbGx5KCgpID0+IHsKICAgICAgICAgIC8vIOi/memHjOaYr+aXoOiuuuaIkOWKn+aIluWksei0pemDveS8muaJp+ihjOeahOaWueazle+8jOWcqOi/memHjOWFs+mXrWxvYWRpbmcKICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0pOwogICAgfSwKICB9LAogIHdhdGNoOiB7CiAgICAiJHJvdXRlLnBhcmFtcy5pZCI6IGZ1bmN0aW9uIChuZXdWYWwsIG9sZFZhbCkgewogICAgICBpZiAodHlwZW9mIG5ld1ZhbCAhPSAidW5kZWZpbmVkIikgewogICAgICAgIHRoaXMuZ2V0RGVwdEhlYWREZXRhaWxzKCk7CiAgICAgIH0KICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["cblbdetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"cblbdetail.vue","sourceRoot":"src/views/zbtest","sourcesContent":["<template>\n  <div class=\"center-flex-box\">\n    <div class=\"card-box\" style=\"width: 300px\">\n      <div class=\"box-title\">报表信息</div>\n\n      <div class=\"box-content\">\n        <div class=\"card\">\n          <div class=\"card-item\">\n            <div class=\"label\">时间:</div>\n            <div class=\"text\">{{ headVersion.createTime }}</div>\n          </div>\n          <div class=\"card-item\">\n            <div class=\"label\">报告类型：</div>\n            <div class=\"text\">{{ headVersion.reportFormName }}</div>\n          </div>\n          <div class=\"card-item\">\n            <div class=\"label\">报表模板：</div>\n            <div class=\"text\">{{ headVersion.businessType }}</div>\n          </div>\n          <div class=\"card-item\">\n            <div class=\"label\">席位：</div>\n            <div class=\"text\">{{ headVersion.sysOrgCodeName }}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"card-box\" style=\"flex: 1; padding-left: 20px\">\n      <div class=\"box-title\">数据展示</div>\n      <div class=\"box-content\">\n        <div>\n          <div v-if=\"headVersion.reportFormType != 'DutyData'\">\n            <a-table\n              ref=\"table\"\n              size=\"default\"\n              :columns=\"columns\"\n              :dataSource=\"dataSource\"\n            >\n            </a-table>\n          </div>\n\n          <div v-if=\"headVersion.reportFormType == 'DutyData'\">\n            <a-tabs>\n              <a-tab-pane v-for=\"tab in tabs\" :key=\"tab.key\" :tab=\"tab.title\">\n                <a-table\n                  ref=\"table\"\n                  size=\"default\"\n                  :columns=\"tab.columns\"\n                  :dataSource=\"tab.dataSource\"\n                  :pagination=\"false\"\n                >\n                </a-table>\n              </a-tab-pane>\n            </a-tabs>\n          </div>\n\n          <div class=\"tbottom\">\n            <div class=\"bi\">协调席：马化腾</div>\n            <div class=\"bi\">海上席：张一鸣</div>\n            <div class=\"bi\">防空席：李彦宏</div>\n            <div class=\"bi\">陆上席：马云</div>\n            <div class=\"bi\">防务席：黄峥</div>\n            <div class=\"bi\">防务席：黄兴</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport STable from \"@/components/table/\";\nimport { getAction } from \"@/api/manage\";\nimport { JVXETypes } from \"@comp/jeecg/JVxeTable\";\n\nexport default {\n  name: \"cblbdetail\",\n  components: {\n    STable,\n  },\n  data() {\n    return {\n      id: this.$route.params.id,\n      indexStyle: 1,\n      istable: true,\n      columns: [],\n      columnss: [],\n      tabs: [],\n      url: {\n        list: \"/reportFormModel/queryReportFormData\",\n        details: \"/reportFormModel/queryReportFormData\",\n        structure: \"/southTable/queryTableStructure\", //结构\n      },\n      dataSource: [],\n      headVersion: {},\n    };\n  },\n  created() {\n    this.getDeptHeadDetails();\n  },\n  mounted() {},\n  methods: {\n    //  版本详情\n    getDeptHeadDetails() {\n      getAction(this.url.details + \"?id=\" + this.id, {}).then((res) => {\n        if (res.code == 200) {\n          this.dataSource = res.result.data;\n          this.headVersion = res.result.headVersion;\n          this.getStructure();\n        } else {\n          this.$message.error(res.message);\n        }\n      });\n    },\n    // 查询结构（table的头部）\n    getStructure() {\n      // 封装查询条件\n      let formData = {\n        reportFromType: this.headVersion.reportFormType,\n        templateType: this.headVersion.businessTypeId,\n      };\n      // 调用查询数据接口\n      this.loading = true;\n      getAction(this.url.structure, formData)\n        .then((res) => {\n          if (res.success) {\n            if (formData.reportFromType != \"DutyData\") {\n              var result = res.result;\n              // 将查询的数据赋值给 dataSource\n              var arr = [];\n              for (var i = 0; i < result.length; i++) {\n                if (result[i].isShowForm == 1) {\n                  arr.push({\n                    dataIndex: result[i].dbFieldName,\n                    title: result[i].dbFieldTxt,\n                  });\n                }\n              }\n              this.jdemoshow = true;\n              this.columns = arr;\n              this.columnss = [];\n            } else {\n              //执勤数据\n              var result = res.result;\n              var columns = [];\n              for (var i = 0; i < result.length; i++) {\n                var arr = [];\n                var obj = {\n                  name: result[i].sheetName,\n                  dataSource: [],\n                };\n                var results = result[i].fields;\n                for (var j = 0; j < results.length; j++) {\n                  if (results[j].isShowForm == 1) {\n                    arr.push({\n                      dataIndex: results[j].dbFieldName,\n                      title: results[j].dbFieldTxt,\n                    });\n                  }\n                }\n                obj.columns = arr;\n                columns.push(obj);\n                this.tabs.push({\n                  title: result[i].sheetName,\n                  columns: arr,\n                  dataSource: this.dataSource[i],\n                  key: i,\n                });\n              }\n              this.columnss = columns;\n              this.jdemoshow = false;\n            }\n          } else {\n            this.$error({ title: \"主表查询失败\", content: res.message });\n          }\n        })\n        .finally(() => {\n          // 这里是无论成功或失败都会执行的方法，在这里关闭loading\n          this.loading = false;\n        });\n    },\n  },\n  watch: {\n    \"$route.params.id\": function (newVal, oldVal) {\n      if (typeof newVal != \"undefined\") {\n        this.getDeptHeadDetails();\n      }\n    },\n  },\n};\n</script>\n<style lang=\"less\" scoped>\n.center-flex-box {\n  display: flex;\n  height: calc(100vh - 160px);\n  justify-content: space-between;\n  .card-box {\n    height: 100%;\n    box-sizing: border-box;\n    background: #fff;\n    overflow-y: auto;\n    border: 1px solid #ddd;\n  }\n}\n.box-title {\n  background: rgba(0, 121, 254, 1);\n  line-height: 2.6rem;\n  color: #fff;\n  font-size: 1.2rem;\n  padding-left: 20px;\n}\n.box-content {\n  padding: 1.3rem;\n}\n.card-item {\n  display: flex;\n  margin: 10px 0;\n}\n.card-item .label {\n  width: 100px;\n}\n.tbottom {\n  display: flex;\n}\n.bi {\n  flex: 1;\n  text-align: center;\n}\n</style>"]}]}