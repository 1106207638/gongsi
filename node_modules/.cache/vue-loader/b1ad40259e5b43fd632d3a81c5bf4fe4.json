{"remainingRequest":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\components\\jeecg\\JEditor.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\src\\components\\jeecg\\JEditor.vue","mtime":1615948815730},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB0aW55bWNlIGZyb20gJ3RpbnltY2UvdGlueW1jZScKaW1wb3J0IEVkaXRvciBmcm9tICdAdGlueW1jZS90aW55bWNlLXZ1ZScKaW1wb3J0ICd0aW55bWNlL3RoZW1lcy9zaWx2ZXIvdGhlbWUnCmltcG9ydCAndGlueW1jZS9wbHVnaW5zL2ltYWdlJwppbXBvcnQgJ3RpbnltY2UvcGx1Z2lucy9saW5rJwppbXBvcnQgJ3RpbnltY2UvcGx1Z2lucy9tZWRpYScKaW1wb3J0ICd0aW55bWNlL3BsdWdpbnMvdGFibGUnCmltcG9ydCAndGlueW1jZS9wbHVnaW5zL2xpc3RzJwppbXBvcnQgJ3RpbnltY2UvcGx1Z2lucy9jb250ZXh0bWVudScKaW1wb3J0ICd0aW55bWNlL3BsdWdpbnMvd29yZGNvdW50JwppbXBvcnQgJ3RpbnltY2UvcGx1Z2lucy9jb2xvcnBpY2tlcicKaW1wb3J0ICd0aW55bWNlL3BsdWdpbnMvdGV4dGNvbG9yJwppbXBvcnQgJ3RpbnltY2UvcGx1Z2lucy9mdWxsc2NyZWVuJwppbXBvcnQgJ3RpbnltY2UvaWNvbnMvZGVmYXVsdCcKaW1wb3J0IHsgdXBsb2FkQWN0aW9uLGdldEZpbGVBY2Nlc3NIdHRwVXJsIH0gZnJvbSAnQC9hcGkvbWFuYWdlJwppbXBvcnQgeyBnZXRWbVBhcmVudEJ5TmFtZSB9IGZyb20gJ0AvdXRpbHMvdXRpbCcKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIEVkaXRvcgogIH0sCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgcmVxdWlyZWQ6ZmFsc2UKICAgIH0sCiAgICB0cmlnZ2VyQ2hhbmdlOnsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICAgIHJlcXVpcmVkOmZhbHNlCiAgICB9LAogICAgZGlzYWJsZWQ6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICBwbHVnaW5zOiB7CiAgICAgIHR5cGU6IFtTdHJpbmcsIEFycmF5XSwKICAgICAgZGVmYXVsdDogJ2xpc3RzIGltYWdlIGxpbmsgbWVkaWEgdGFibGUgdGV4dGNvbG9yIHdvcmRjb3VudCBjb250ZXh0bWVudSBmdWxsc2NyZWVuJwogICAgfSwKICAgIHRvb2xiYXI6IHsKICAgICAgdHlwZTogW1N0cmluZywgQXJyYXldLAogICAgICBkZWZhdWx0OiAndW5kbyByZWRvIHwgIGZvcm1hdHNlbGVjdCB8IGJvbGQgaXRhbGljIHwgYWxpZ25sZWZ0IGFsaWduY2VudGVyIGFsaWducmlnaHQgYWxpZ25qdXN0aWZ5IHwgYnVsbGlzdCBudW1saXN0IG91dGRlbnQgaW5kZW50IHwgbGlzdHMgbGluayB1bmxpbmsgaW1hZ2UgbWVkaWEgdGFibGUgfCByZW1vdmVmb3JtYXQgfCBmdWxsc2NyZWVuJywKICAgICAgYnJhbmRpbmc6ZmFsc2UKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvL+WIneWni+WMlumFjee9rgogICAgICBpbml0OiB7CiAgICAgICAgbGFuZ3VhZ2VfdXJsOiAnL3RpbnltY2UvbGFuZ3MvemhfQ04uanMnLAogICAgICAgIGxhbmd1YWdlOiAnemhfQ04nLAogICAgICAgIHNraW5fdXJsOiAnL3RpbnltY2Uvc2tpbnMvbGlnaHRncmF5JywKICAgICAgICBoZWlnaHQ6IDMwMCwKICAgICAgICBwbHVnaW5zOiB0aGlzLnBsdWdpbnMsCiAgICAgICAgdG9vbGJhcjogdGhpcy50b29sYmFyLAogICAgICAgIGJyYW5kaW5nOiBmYWxzZSwKICAgICAgICBtZW51YmFyOiBmYWxzZSwKICAgICAgICB0b29sYmFyX2RyYXdlcjogZmFsc2UsCiAgICAgICAgaW1hZ2VzX3VwbG9hZF9oYW5kbGVyOiAoYmxvYkluZm8sIHN1Y2Nlc3MpID0+IHsKICAgICAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpCiAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBibG9iSW5mby5ibG9iKCksIGJsb2JJbmZvLmZpbGVuYW1lKCkpOwogICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdiaXonLCAiamVkaXRvciIpOwogICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJqZWRpdG9yIiwiMSIpOwogICAgICAgICAgdXBsb2FkQWN0aW9uKHdpbmRvdy5fQ09ORklHWydkb21pYW5VUkwnXSsiL3N5cy9jb21tb24vdXBsb2FkIiwgZm9ybURhdGEpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICBpZihyZXMubWVzc2FnZSA9PSAnbG9jYWwnKXsKICAgICAgICAgICAgICAgIGNvbnN0IGltZyA9ICdkYXRhOmltYWdlL2pwZWc7YmFzZTY0LCcgKyBibG9iSW5mby5iYXNlNjQoKQogICAgICAgICAgICAgICAgc3VjY2VzcyhpbWcpCiAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICBsZXQgaW1nID0gZ2V0RmlsZUFjY2Vzc0h0dHBVcmwocmVzLm1lc3NhZ2UpCiAgICAgICAgICAgICAgICBzdWNjZXNzKGltZykKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9LAogICAgICBteVZhbHVlOiB0aGlzLnZhbHVlLAogICAgICByZWxvYWRpbmc6IGZhbHNlLAogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuaW5pdEFUYWJzQ2hhbmdlQXV0b1JlbG9hZCgpCiAgfSwKICBtZXRob2RzOiB7CgogICAgcmVsb2FkKCkgewogICAgICB0aGlzLnJlbG9hZGluZyA9IHRydWUKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gdGhpcy5yZWxvYWRpbmcgPSBmYWxzZSkKICAgIH0sCgogICAgb25DbGljayhlKSB7CiAgICAgIHRoaXMuJGVtaXQoJ29uQ2xpY2snLCBlLCB0aW55bWNlKQogICAgfSwKICAgIC8v5Y+v5Lul5re75Yqg5LiA5Lqb6Ieq5bex55qE6Ieq5a6a5LmJ5LqL5Lu277yM5aaC5riF56m65YaF5a65CiAgICBjbGVhcigpIHsKICAgICAgdGhpcy5teVZhbHVlID0gJycKICAgIH0sCgogICAgLyoqCiAgICAgKiDoh6rliqjliKTmlq3niLbnuqfmmK/lkKbmmK8gPGEtdGFicy8+IOe7hOS7tu+8jOeEtuWQjua3u+WKoOS6i+S7tuebkeWQrO+8jOiHquWKqOinpuWPkXJlbG9hZCgpCiAgICAgKgogICAgICog55Sx5LqOIHRhYnMg57uE5Lu25YiH5o2i5Lya5a+86Ie0IHRpbnltY2Ug5peg5rOV6L6T5YWl77yMCiAgICAgKiDlj6rmnInph43mlrDliqDovb3miY3og73kvb/nlKjvvIjml6DorrrmmK92dWXniYjnmoTov5jmmK9qUXVlcnnniYh0aW55bWNl6YO95pyJ6L+Z5Liq6YCa55eF77yJCiAgICAgKi8KICAgIGluaXRBVGFic0NoYW5nZUF1dG9SZWxvYWQoKSB7CiAgICAgIC8vIOiOt+WPlueItue6pwogICAgICBsZXQgdGFicyA9IGdldFZtUGFyZW50QnlOYW1lKHRoaXMsICdBVGFicycpCiAgICAgIGxldCB0YWJQYW5lID0gZ2V0Vm1QYXJlbnRCeU5hbWUodGhpcywgJ0FUYWJQYW5lJykKICAgICAgaWYgKHRhYnMgJiYgdGFiUGFuZSkgewogICAgICAgIC8vIOeUqOaIt+iHquWumuS5ieeahCBrZXkKICAgICAgICBsZXQgY3VycmVudEtleSA9IHRhYlBhbmUuJHZub2RlLmtleQogICAgICAgIC8vIOa3u+WKoOS6i+S7tuebkeWQrAogICAgICAgIHRhYnMuJG9uKCdjaGFuZ2UnLCAoa2V5KSA9PiB7CiAgICAgICAgICAvLyDliIfmjaLliLDoh6rlt7Hml7bmiafooYxyZWxvYWQKICAgICAgICAgIGlmIChjdXJyZW50S2V5ID09PSBrZXkpIHsKICAgICAgICAgICAgdGhpcy5yZWxvYWQoKQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgIH1lbHNlewogICAgICAgIC8vdXBkYXRlLS1iZWdpbi0tYXV0b3I6d2FuZ3NodWFpLS0tLS1kYXRlOjIwMjAwNzI0LS0tLS0tZm9y77ya5a+M5paH5pys57yW6L6R5Zmo5YiH5o2idGFi5peg5rOV5L+u5pS5LS0tLS0tCiAgICAgICAgbGV0IHRhYkxheW91dCA9IGdldFZtUGFyZW50QnlOYW1lKHRoaXMsICdUYWJMYXlvdXQnKQogICAgICAgIHRhYkxheW91dC5leGN1dGVDYWxsYmFjaygoKT0+ewogICAgICAgICAgdGhpcy5yZWxvYWQoKQogICAgICAgIH0pCiAgICAgICAgLy91cGRhdGUtLWJlZ2luLS1hdXRvcjp3YW5nc2h1YWktLS0tLWRhdGU6MjAyMDA3MjQtLS0tLS1mb3LvvJrmlofmnKznvJbovpHlmajliIfmjaJ0YWLml6Dms5Xkv67mlLktLS0tLS0KICAgICAgfQogICAgfSwKCiAgfSwKICB3YXRjaDogewogICAgdmFsdWUobmV3VmFsdWUpIHsKICAgICAgdGhpcy5teVZhbHVlID0gKG5ld1ZhbHVlID09IG51bGwgPyAnJyA6IG5ld1ZhbHVlKQogICAgfSwKICAgIG15VmFsdWUobmV3VmFsdWUpIHsKICAgICAgaWYodGhpcy50cmlnZ2VyQ2hhbmdlKXsKICAgICAgICB0aGlzLiRlbWl0KCdjaGFuZ2UnLCBuZXdWYWx1ZSkKICAgICAgfWVsc2V7CiAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCBuZXdWYWx1ZSkKICAgICAgfQogICAgfQogIH0KfQoK"},{"version":3,"sources":["JEditor.vue"],"names":[],"mappings":";;;;;;;;;;;;;AAaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"JEditor.vue","sourceRoot":"src/components/jeecg","sourcesContent":["<template>\r\n  <div class=\"tinymce-editor\">\r\n    <editor\r\n      v-if=\"!reloading\"\r\n      v-model=\"myValue\"\r\n      :init=\"init\"\r\n      :disabled=\"disabled\"\r\n      @onClick=\"onClick\">\r\n    </editor>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import tinymce from 'tinymce/tinymce'\r\n  import Editor from '@tinymce/tinymce-vue'\r\n  import 'tinymce/themes/silver/theme'\r\n  import 'tinymce/plugins/image'\r\n  import 'tinymce/plugins/link'\r\n  import 'tinymce/plugins/media'\r\n  import 'tinymce/plugins/table'\r\n  import 'tinymce/plugins/lists'\r\n  import 'tinymce/plugins/contextmenu'\r\n  import 'tinymce/plugins/wordcount'\r\n  import 'tinymce/plugins/colorpicker'\r\n  import 'tinymce/plugins/textcolor'\r\n  import 'tinymce/plugins/fullscreen'\r\n  import 'tinymce/icons/default'\r\n  import { uploadAction,getFileAccessHttpUrl } from '@/api/manage'\r\n  import { getVmParentByName } from '@/utils/util'\r\n  export default {\r\n    components: {\r\n      Editor\r\n    },\r\n    props: {\r\n      value: {\r\n        type: String,\r\n        required:false\r\n      },\r\n      triggerChange:{\r\n        type: Boolean,\r\n        default: false,\r\n        required:false\r\n      },\r\n      disabled: {\r\n        type: Boolean,\r\n        default: false\r\n      },\r\n      plugins: {\r\n        type: [String, Array],\r\n        default: 'lists image link media table textcolor wordcount contextmenu fullscreen'\r\n      },\r\n      toolbar: {\r\n        type: [String, Array],\r\n        default: 'undo redo |  formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | lists link unlink image media table | removeformat | fullscreen',\r\n        branding:false\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        //初始化配置\r\n        init: {\r\n          language_url: '/tinymce/langs/zh_CN.js',\r\n          language: 'zh_CN',\r\n          skin_url: '/tinymce/skins/lightgray',\r\n          height: 300,\r\n          plugins: this.plugins,\r\n          toolbar: this.toolbar,\r\n          branding: false,\r\n          menubar: false,\r\n          toolbar_drawer: false,\r\n          images_upload_handler: (blobInfo, success) => {\r\n            let formData = new FormData()\r\n            formData.append('file', blobInfo.blob(), blobInfo.filename());\r\n            formData.append('biz', \"jeditor\");\r\n            formData.append(\"jeditor\",\"1\");\r\n            uploadAction(window._CONFIG['domianURL']+\"/sys/common/upload\", formData).then((res) => {\r\n              if (res.success) {\r\n                if(res.message == 'local'){\r\n                  const img = 'data:image/jpeg;base64,' + blobInfo.base64()\r\n                  success(img)\r\n                }else{\r\n                  let img = getFileAccessHttpUrl(res.message)\r\n                  success(img)\r\n                }\r\n              }\r\n            })\r\n          }\r\n        },\r\n        myValue: this.value,\r\n        reloading: false,\r\n      }\r\n    },\r\n    mounted() {\r\n      this.initATabsChangeAutoReload()\r\n    },\r\n    methods: {\r\n\r\n      reload() {\r\n        this.reloading = true\r\n        this.$nextTick(() => this.reloading = false)\r\n      },\r\n\r\n      onClick(e) {\r\n        this.$emit('onClick', e, tinymce)\r\n      },\r\n      //可以添加一些自己的自定义事件，如清空内容\r\n      clear() {\r\n        this.myValue = ''\r\n      },\r\n\r\n      /**\r\n       * 自动判断父级是否是 <a-tabs/> 组件，然后添加事件监听，自动触发reload()\r\n       *\r\n       * 由于 tabs 组件切换会导致 tinymce 无法输入，\r\n       * 只有重新加载才能使用（无论是vue版的还是jQuery版tinymce都有这个通病）\r\n       */\r\n      initATabsChangeAutoReload() {\r\n        // 获取父级\r\n        let tabs = getVmParentByName(this, 'ATabs')\r\n        let tabPane = getVmParentByName(this, 'ATabPane')\r\n        if (tabs && tabPane) {\r\n          // 用户自定义的 key\r\n          let currentKey = tabPane.$vnode.key\r\n          // 添加事件监听\r\n          tabs.$on('change', (key) => {\r\n            // 切换到自己时执行reload\r\n            if (currentKey === key) {\r\n              this.reload()\r\n            }\r\n          })\r\n        }else{\r\n          //update--begin--autor:wangshuai-----date:20200724------for：富文本编辑器切换tab无法修改------\r\n          let tabLayout = getVmParentByName(this, 'TabLayout')\r\n          tabLayout.excuteCallback(()=>{\r\n            this.reload()\r\n          })\r\n          //update--begin--autor:wangshuai-----date:20200724------for：文本编辑器切换tab无法修改------\r\n        }\r\n      },\r\n\r\n    },\r\n    watch: {\r\n      value(newValue) {\r\n        this.myValue = (newValue == null ? '' : newValue)\r\n      },\r\n      myValue(newValue) {\r\n        if(this.triggerChange){\r\n          this.$emit('change', newValue)\r\n        }else{\r\n          this.$emit('input', newValue)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n</script>\r\n<style scoped>\r\n</style>"]}]}