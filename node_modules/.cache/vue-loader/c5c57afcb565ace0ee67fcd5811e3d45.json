{"remainingRequest":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\components\\jeecg\\JAreaLinkage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\src\\components\\jeecg\\JAreaLinkage.vue","mtime":1615948815712},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHBjYWEgfSBmcm9tICdhcmVhLWRhdGEnCmltcG9ydCBBcmVhIGZyb20gJ0AvY29tcG9uZW50cy9fdXRpbC9BcmVhJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdKQXJlYUxpbmthZ2UnLAogIHByb3BzOiB7CiAgICB2YWx1ZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIHJlcXVpcmVkOmZhbHNlCiAgICB9LAogICAgLy8g57uE5Lu255qE57G75Z6L77yM5Y+v6YCJ5YC877yaCiAgICAvLyBzZWxlY3Qg5LiL5ouJ5qC35byPCiAgICAvLyBjYXNjYWRlciDnuqfogZTmoLflvI/vvIjpu5jorqTvvIkKICAgIHR5cGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnY2FzY2FkZXInCiAgICB9LAogICAgd2lkdGg6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnMTAwJScKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwY2FhLAogICAgICBpbm5lclZhbHVlOiBbXSwKICAgICAgdXNlZExpc3RlbmVyczogWydjaGFuZ2UnXSwKICAgICAgZW51bXM6IHsKICAgICAgICB0eXBlOiBbJ2Nhc2NhZGVyJywgJ3NlbGVjdCddCiAgICAgIH0sCiAgICAgIHJlbG9hZGluZzogZmFsc2UsCiAgICAgIGFyZWFEYXRhOicnCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgX2xpc3RlbmVycygpIHsKICAgICAgbGV0IGxpc3RlbmVycyA9IHsgLi4udGhpcy4kbGlzdGVuZXJzIH0KICAgICAgLy8g5Y675o6J5bey5L2/55So55qE5LqL5Lu277yM6Ziy5q2i5Yay56qBCiAgICAgIHRoaXMudXNlZExpc3RlbmVycy5mb3JFYWNoKGtleSA9PiB7CiAgICAgICAgZGVsZXRlIGxpc3RlbmVyc1trZXldCiAgICAgIH0pCiAgICAgIHJldHVybiBsaXN0ZW5lcnMKICAgIH0sCiAgICBfdHlwZSgpIHsKICAgICAgaWYgKHRoaXMuZW51bXMudHlwZS5pbmNsdWRlcyh0aGlzLnR5cGUpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudHlwZQogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUuZXJyb3IoYEpBcmVhTGlua2FnZeeahHR5cGXlsZ7mgKflj6rog73mjqXmlLbmjIflrprnmoTlgLzvvIgke3RoaXMuZW51bXMudHlwZS5qb2luKCd8Jyl977yJYCkKICAgICAgICByZXR1cm4gdGhpcy5lbnVtcy50eXBlWzBdCiAgICAgIH0KICAgIH0sCiAgfSwKICB3YXRjaDogewogICAgdmFsdWU6IHsKICAgICAgaW1tZWRpYXRlOiB0cnVlLAogICAgICBoYW5kbGVyKCkgewogICAgICAgIHRoaXMubG9hZERhdGFCeVZhbHVlKHRoaXMudmFsdWUpCiAgICAgIH0KICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5pbml0QXJlYURhdGEoKTsKICB9LAogIG1ldGhvZHM6IHsKCiAgICAvKiog6YeN5paw5Yqg6L2957uE5Lu2ICovCiAgICByZWxvYWQoKSB7CiAgICAgIHRoaXMucmVsb2FkaW5nID0gdHJ1ZQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB0aGlzLnJlbG9hZGluZyA9IGZhbHNlKQogICAgfSwKCiAgICAvKiog6YCa6L+HIHZhbHVlIOWPjeaOqCBvcHRpb25zICovCiAgICBsb2FkRGF0YUJ5VmFsdWUodmFsdWUpIHsKICAgICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZS5sZW5ndGggPT09IDApIHsKICAgICAgICB0aGlzLmlubmVyVmFsdWUgPSBbXQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaW5pdEFyZWFEYXRhKCkKICAgICAgICBsZXQgYXJyID0gdGhpcy5hcmVhRGF0YS5nZXRSZWFsQ29kZSh2YWx1ZSkKICAgICAgICB0aGlzLmlubmVyVmFsdWUgPSBhcnIKICAgICAgfQogICAgICB0aGlzLnJlbG9hZCgpCiAgICB9LAogICAgLyoqIOmAmui/h+WcsOWMumNvZGXojrflj5blrZDnuqcgKi8KICAgIGxvYWREYXRhQnlDb2RlKHZhbHVlKSB7CiAgICAgIGxldCBvcHRpb25zID0gW10KICAgICAgbGV0IGRhdGEgPSBwY2FhW3ZhbHVlXQogICAgICBpZiAoZGF0YSkgewogICAgICAgIGZvciAobGV0IGtleSBpbiBkYXRhKSB7CiAgICAgICAgICBpZiAoZGF0YS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAgICAgICAgIG9wdGlvbnMucHVzaCh7IHZhbHVlOiBrZXksIGxhYmVsOiBkYXRhW2tleV0sIH0pCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBvcHRpb25zCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIFtdCiAgICAgIH0KICAgIH0sCiAgICAvKiog5Yik5pat5piv5ZCm5pyJ5a2Q6IqC54K5ICovCiAgICBoYXNDaGlsZHJlbihvcHRpb25zKSB7CiAgICAgIG9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4gewogICAgICAgIGxldCBkYXRhID0gdGhpcy5sb2FkRGF0YUJ5Q29kZShvcHRpb24udmFsdWUpCiAgICAgICAgb3B0aW9uLmlzTGVhZiA9IGRhdGEubGVuZ3RoID09PSAwCiAgICAgIH0pCiAgICB9LAogICAgaGFuZGxlQ2hhbmdlKHZhbHVlcykgewogICAgICBsZXQgdmFsdWUgPSB2YWx1ZXNbdmFsdWVzLmxlbmd0aCAtIDFdCiAgICAgIHRoaXMuJGVtaXQoJ2NoYW5nZScsIHZhbHVlKQogICAgfSwKICAgIGluaXRBcmVhRGF0YSgpewogICAgICBpZighdGhpcy5hcmVhRGF0YSl7CiAgICAgICAgdGhpcy5hcmVhRGF0YSA9IG5ldyBBcmVhKCk7CiAgICAgIH0KICAgIH0sCgogIH0sCiAgbW9kZWw6IHsgcHJvcDogJ3ZhbHVlJywgZXZlbnQ6ICdjaGFuZ2UnIH0sCn0K"},{"version":3,"sources":["JAreaLinkage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"JAreaLinkage.vue","sourceRoot":"src/components/jeecg","sourcesContent":["<template>\r\n  <div class=\"j-area-linkage\">\r\n    <div v-if=\"reloading\">\r\n      <span> Reloading... </span>\r\n    </div>\r\n    <area-cascader\r\n      v-else-if=\"_type === enums.type[0]\"\r\n      :value=\"innerValue\"\r\n      :data=\"pcaa\"\r\n      :level=\"1\"\r\n      :style=\"{width}\"\r\n      v-bind=\"$attrs\"\r\n      v-on=\"_listeners\"\r\n      @change=\"handleChange\"\r\n    />\r\n    <area-select\r\n      v-else-if=\"_type === enums.type[1]\"\r\n      :value=\"innerValue\"\r\n      :data=\"pcaa\"\r\n      :level=\"2\"\r\n      v-bind=\"$attrs\"\r\n      v-on=\"_listeners\"\r\n      @change=\"handleChange\"\r\n    />\r\n    <div v-else>\r\n      <span style=\"color:red;\"> Bad type value: {{_type}}</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import { pcaa } from 'area-data'\r\n  import Area from '@/components/_util/Area'\r\n\r\n  export default {\r\n    name: 'JAreaLinkage',\r\n    props: {\r\n      value: {\r\n        type: String,\r\n        required:false\r\n      },\r\n      // 组件的类型，可选值：\r\n      // select 下拉样式\r\n      // cascader 级联样式（默认）\r\n      type: {\r\n        type: String,\r\n        default: 'cascader'\r\n      },\r\n      width: {\r\n        type: String,\r\n        default: '100%'\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        pcaa,\r\n        innerValue: [],\r\n        usedListeners: ['change'],\r\n        enums: {\r\n          type: ['cascader', 'select']\r\n        },\r\n        reloading: false,\r\n        areaData:''\r\n      }\r\n    },\r\n    computed: {\r\n      _listeners() {\r\n        let listeners = { ...this.$listeners }\r\n        // 去掉已使用的事件，防止冲突\r\n        this.usedListeners.forEach(key => {\r\n          delete listeners[key]\r\n        })\r\n        return listeners\r\n      },\r\n      _type() {\r\n        if (this.enums.type.includes(this.type)) {\r\n          return this.type\r\n        } else {\r\n          console.error(`JAreaLinkage的type属性只能接收指定的值（${this.enums.type.join('|')}）`)\r\n          return this.enums.type[0]\r\n        }\r\n      },\r\n    },\r\n    watch: {\r\n      value: {\r\n        immediate: true,\r\n        handler() {\r\n          this.loadDataByValue(this.value)\r\n        }\r\n      },\r\n    },\r\n    created() {\r\n      this.initAreaData();\r\n    },\r\n    methods: {\r\n\r\n      /** 重新加载组件 */\r\n      reload() {\r\n        this.reloading = true\r\n        this.$nextTick(() => this.reloading = false)\r\n      },\r\n\r\n      /** 通过 value 反推 options */\r\n      loadDataByValue(value) {\r\n        if (!value || value.length === 0) {\r\n          this.innerValue = []\r\n        } else {\r\n          this.initAreaData()\r\n          let arr = this.areaData.getRealCode(value)\r\n          this.innerValue = arr\r\n        }\r\n        this.reload()\r\n      },\r\n      /** 通过地区code获取子级 */\r\n      loadDataByCode(value) {\r\n        let options = []\r\n        let data = pcaa[value]\r\n        if (data) {\r\n          for (let key in data) {\r\n            if (data.hasOwnProperty(key)) {\r\n              options.push({ value: key, label: data[key], })\r\n            }\r\n          }\r\n          return options\r\n        } else {\r\n          return []\r\n        }\r\n      },\r\n      /** 判断是否有子节点 */\r\n      hasChildren(options) {\r\n        options.forEach(option => {\r\n          let data = this.loadDataByCode(option.value)\r\n          option.isLeaf = data.length === 0\r\n        })\r\n      },\r\n      handleChange(values) {\r\n        let value = values[values.length - 1]\r\n        this.$emit('change', value)\r\n      },\r\n      initAreaData(){\r\n        if(!this.areaData){\r\n          this.areaData = new Area();\r\n        }\r\n      },\r\n\r\n    },\r\n    model: { prop: 'value', event: 'change' },\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n  .j-area-linkage {\r\n    height:40px;\r\n    /deep/ .area-cascader-wrap .area-select {\r\n      width: 100%;\r\n    }\r\n\r\n    /deep/ .area-select .area-selected-trigger {\r\n      line-height: 1.15;\r\n    }\r\n  }\r\n\r\n</style>"]}]}