{"remainingRequest":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\components\\jeecg\\dynamic\\JsCodeEditorDyn.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"D:\\vue\\src\\components\\jeecg\\dynamic\\JsCodeEditorDyn.vue","mtime":1615948814837},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\css-loader\\dist\\cjs.js","mtime":1615952641773},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1615952643260},{"path":"D:\\vue\\node_modules\\postcss-loader\\src\\index.js","mtime":1615952643158},{"path":"D:\\vue\\node_modules\\less-loader\\dist\\cjs.js","mtime":1615952670554},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmplZWNnLWVkaXRvci10eXsKICBwb3NpdGlvbjogcmVsYXRpdmU7CgogIC5mdWxsLXNjcmVlbi1pY29uIHsKICAgIG9wYWNpdHk6IDA7CiAgICBjb2xvcjogYmxhY2s7CiAgICB3aWR0aDogMjBweDsKICAgIGhlaWdodDogMjBweDsKICAgIGxpbmUtaGVpZ2h0OiAyNHB4OwogICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDRweDsKICAgIHJpZ2h0OiAycHg7CiAgICB6LWluZGV4OiA5OwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjNzOwogIH0KICAmOmhvdmVyIHsKICAgIC5mdWxsLXNjcmVlbi1pY29uIHsKICAgICAgb3BhY2l0eTogMTsKCiAgICAgICY6aG92ZXIgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC44OCk7CiAgICAgIH0KICAgIH0KICB9CgogIC5udWxsLXRpcHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHRvcDogNHB4OwogICAgbGVmdDogMzZweDsKICAgIHotaW5kZXg6IDEwOwogICAgZm9udC1zaXplOjE2cHg7CiAgICBjb2xvcjogI2FjYWFhYWM5OwogICAgbGluZS1oZWlnaHQ6IGluaXRpYWw7CiAgfQogIC5udWxsLXRpcC1oaWRkZW57CiAgICBkaXNwbGF5OiBub25lOwogIH0KfQouamVlY2ctZWRpdG9yLW1heHsKICBwb3NpdGlvbjogZml4ZWQ7CiAgbGVmdDogMDsKICB0b3A6IDA7CiAgei1pbmRleDogOTk5OwogIGhlaWdodDogMTAwJTsKICB3aWR0aDogMTAwJSAhaW1wb3J0YW50OwoKICAuQ29kZU1pcnJvcnsKICAgIHBvc2l0aW9uOiBpbmhlcml0ICFpbXBvcnRhbnQ7CiAgICB3aWR0aDogMTAwJTsKICAgIGhlaWdodDogMTAwJTsKICB9CiAgLmZ1bGwtc2NyZWVuLWljb257CiAgICB6LWluZGV4Ojk5OTk7CiAgfQp9Cg=="},{"version":3,"sources":["JsCodeEditorDyn.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqQA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"JsCodeEditorDyn.vue","sourceRoot":"src/components/jeecg/dynamic","sourcesContent":["<template>\r\n  <div class=\"jeecg-editor-ty\" :class=\"fullCoder?'jeecg-editor-max':'jeecg-editor-min'\">\r\n    <a-icon v-if=\"fullScreen\" class=\"full-screen-icon\" :type=\"iconType\" @click=\"()=>fullCoder=!fullCoder\"/>\r\n    <textarea :id=\"dynamicId\" />\r\n    <span @click=\"nullTipClick\" class=\"null-tip\" :class=\"{'null-tip-hidden': hasCode}\" :style=\"nullTipStyle\">{{ placeholderShow }}</span>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\n  import '@/assets/less/codemirror_idea.css'\r\n  import './cm_hint.js'\r\n\r\n  export default {\r\n    name: 'JsCodeEditorDyn',\r\n    props:{\r\n      id: {\r\n        type: String,\r\n        default: function() {\r\n          return 'vue-editor-' + new Date() + ((Math.random() * 1000).toFixed(0) + '')\r\n        }\r\n      },\r\n      value: {\r\n        type: String,\r\n        default: ''\r\n      },\r\n      // 显示行号\r\n      lineNumbers: {\r\n        type: Boolean,\r\n        default: true\r\n      },\r\n      placeholder: {\r\n        type: String,\r\n        default: ''\r\n      },\r\n      zIndex: {\r\n        type: [Number, String],\r\n        default: 999\r\n      },\r\n      autoHeight: {\r\n        type: [String, Boolean],\r\n        default: true\r\n      },\r\n      // 不自适应高度的情况下生效的固定高度\r\n      height: {\r\n        type: [String, Number],\r\n        default: '240px'\r\n      },\r\n      autoHeight: {\r\n        type: [String, Boolean],\r\n        default: true\r\n      },\r\n      // 是否显示全屏按钮\r\n      fullScreen: {\r\n        type: Boolean,\r\n        default: false\r\n      },\r\n\r\n    },\r\n    data(){\r\n      return {\r\n        dynamicId: this.id,\r\n        coder: '',\r\n        hasCode: false,\r\n        code: '',\r\n        // code 编辑器 是否全屏\r\n        fullCoder: false,\r\n        iconType: 'fullscreen',\r\n      }\r\n    },\r\n    computed:{\r\n      placeholderShow() {\r\n        if (this.placeholder == null) {\r\n          return `请在此输入javascript代码`\r\n        } else {\r\n          return this.placeholder\r\n        }\r\n      },\r\n      nullTipStyle(){\r\n        if (this.lineNumbers) {\r\n          return { left: '36px' }\r\n        } else {\r\n          return { left: '12px' }\r\n        }\r\n      },\r\n      isAutoHeight() {\r\n        let {autoHeight} = this\r\n        if (typeof autoHeight === 'string' && autoHeight.toLowerCase().trim() === '!ie') {\r\n          autoHeight = !(isIE() || isIE11())\r\n        } else {\r\n          autoHeight = true\r\n        }\r\n        return autoHeight\r\n      },\r\n      fullScreenParentProps() {\r\n        let props = {\r\n          class: {\r\n            'full-screen-parent': true,\r\n            'full-screen': this.fullCoder,\r\n            'auto-height': this.isAutoHeight\r\n          },\r\n          style: {}\r\n        }\r\n        if (this.fullCoder) {\r\n          props.style['z-index'] = this.zIndex\r\n        }\r\n        if (!this.isAutoHeight) {\r\n          props.style['height'] = (typeof this.height === 'number' ? this.height + 'px' : this.height)\r\n        }\r\n        return props\r\n      }\r\n    },\r\n    watch: {\r\n      fullCoder:{\r\n        handler(value) {\r\n          if(value){\r\n            this.iconType=\"fullscreen-exit\"\r\n          }else{\r\n            this.iconType=\"fullscreen\"\r\n          }\r\n        }\r\n      }\r\n    },\r\n    mounted() {\r\n      this.init()\r\n    },\r\n    methods:{\r\n      init(){\r\n        this.main();\r\n      },\r\n      main(){\r\n        let obj = document.getElementById(this.dynamicId);\r\n        const that = this;\r\n        let editor = CodeMirror.fromTextArea(obj,{\r\n          theme:'idea',\r\n          lineNumbers: this.lineNumbers,\r\n          lineWrapping: true,\r\n          mode: \"javascript\",\r\n          indentUnit: 1,\r\n          indentWithTabs: true,\r\n          styleActiveLine: true,\r\n          /* styleSelectedText: false, */\r\n          extraKeys: {\r\n            \"F11\": function(cm) {\r\n              that.fullCoder = !that.fullCoder\r\n              cm.setOption(\"fullScreen\", !cm.getOption(\"fullScreen\"));\r\n            },\r\n            \"Esc\": function(cm) {\r\n              that.fullCoder = false\r\n              if (cm.getOption(\"fullScreen\")) cm.setOption(\"fullScreen\", false);\r\n            },\r\n            \"Alt-/\":  function(cm) {\r\n              let a = cm.getValue()+\"\"\r\n              console.log('a',a)\r\n              cm.showHint();\r\n            },\r\n            \"Tab\": (cm) => {\r\n              if (cm.somethingSelected()) {\r\n                cm.indentSelection('add');\r\n              } else {\r\n                //cm.indentLine(cm.getCursor().line, \"add\");\r\n                //走两格 第三格输入\r\n                cm.replaceSelection(Array(3).join(\" \"), \"end\", \"+input\");\r\n              }\r\n            },\r\n            \"Shift-Tab\": (cm) => {\r\n              if (cm.somethingSelected()) {\r\n                cm.indentSelection('subtract');\r\n              } else {\r\n                // cm.indentLine(cm.getCursor().line, \"subtract\");\r\n                const cursor = cm.getCursor();\r\n                // 光标回退 indexUnit 字符\r\n                cm.setCursor({line: cursor.line, ch: cursor.ch - 4});\r\n              }\r\n              return ;\r\n            }\r\n          }\r\n        })\r\n        this.coder = editor\r\n        this.addEvent();\r\n        this.setCoderValue();\r\n      },\r\n      setCoderValue(){\r\n        if(this.value||this.code){\r\n          this.hasCode=true\r\n          this.setCodeContent(this.value || this.code)\r\n        }else{\r\n          this.coder.setValue('')\r\n          this.hasCode=false\r\n        }\r\n      },\r\n      getCodeContent(){\r\n        return this.code\r\n      },\r\n      setCodeContent(val){\r\n        setTimeout(()=>{\r\n          if(!val){\r\n            this.coder.setValue('')\r\n          }else{\r\n            this.coder.setValue(val)\r\n          }\r\n        },300)\r\n      },\r\n      addEvent(){\r\n        const that = this;\r\n        this.coder.on('cursorActivity',function(wl) {\r\n          let arr = wl.state.activeLines\r\n          if(arr && arr.length>0){\r\n            let text = arr[0].text\r\n            if(text.lastIndexOf('that.')>=0){\r\n              that.coder.showHint();\r\n            }\r\n          }\r\n        });\r\n        this.coder.on('change', (coder) => {\r\n          this.code = coder.getValue()\r\n          if(this.code){\r\n            this.hasCode=true\r\n          }else{\r\n            this.hasCode=false\r\n          }\r\n          if (this.$emit) {\r\n            this.$emit('input', this.code)\r\n          }\r\n        });\r\n        this.coder.on('focus', () => {\r\n          this.hasCode=true\r\n        });\r\n        this.coder.on('blur', () => {\r\n          if(this.code){\r\n            this.hasCode=true\r\n          }else{\r\n            this.hasCode=false\r\n          }\r\n        });\r\n      },\r\n      loadResource(src,type){\r\n        return new Promise((resolve,reject)=>{\r\n          load(src,type,(msg)=>{\r\n            if(!msg){\r\n              resolve();\r\n            }else{\r\n              reject(msg)\r\n            }\r\n          })\r\n        })\r\n      },\r\n      nullTipClick(){\r\n        this.coder.focus()\r\n      },\r\n      fullToggle(){\r\n        this.fullCoder = !this.fullCoder\r\n        this.coder.setOption(\"fullScreen\", this.fullCoder);\r\n      }\r\n\r\n    }\r\n\r\n\r\n  }\r\n</script>\r\n<style lang=\"less\" >\r\n  .jeecg-editor-ty{\r\n    position: relative;\r\n\r\n    .full-screen-icon {\r\n      opacity: 0;\r\n      color: black;\r\n      width: 20px;\r\n      height: 20px;\r\n      line-height: 24px;\r\n      background-color: white;\r\n      position: absolute;\r\n      top: 4px;\r\n      right: 2px;\r\n      z-index: 9;\r\n      cursor: pointer;\r\n      transition: opacity 0.3s;\r\n    }\r\n    &:hover {\r\n      .full-screen-icon {\r\n        opacity: 1;\r\n\r\n        &:hover {\r\n          background-color: rgba(255, 255, 255, 0.88);\r\n        }\r\n      }\r\n    }\r\n\r\n    .null-tip{\r\n      position: absolute;\r\n      top: 4px;\r\n      left: 36px;\r\n      z-index: 10;\r\n      font-size:16px;\r\n      color: #acaaaac9;\r\n      line-height: initial;\r\n    }\r\n    .null-tip-hidden{\r\n      display: none;\r\n    }\r\n  }\r\n  .jeecg-editor-max{\r\n    position: fixed;\r\n    left: 0;\r\n    top: 0;\r\n    z-index: 999;\r\n    height: 100%;\r\n    width: 100% !important;\r\n\r\n    .CodeMirror{\r\n      position: inherit !important;\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n    .full-screen-icon{\r\n      z-index:9999;\r\n    }\r\n  }\r\n</style>"]}]}