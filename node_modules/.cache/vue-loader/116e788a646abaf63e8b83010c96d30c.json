{"remainingRequest":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\components\\jeecg\\JPopup.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\src\\components\\jeecg\\JPopup.vue","mtime":1615948815739},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBKUG9wdXBPbmxSZXBvcnQgZnJvbSAnLi9tb2RhbC9KUG9wdXBPbmxSZXBvcnQnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0pQb3B1cCcsCiAgY29tcG9uZW50czogewogICAgSlBvcHVwT25sUmVwb3J0CiAgfSwKICBwcm9wczogewogICAgY29kZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICcnLAogICAgICByZXF1aXJlZDogZmFsc2UKICAgIH0sCiAgICBmaWVsZDogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICcnLAogICAgICByZXF1aXJlZDogZmFsc2UKICAgIH0sCiAgICBvcmdGaWVsZHM6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnJywKICAgICAgcmVxdWlyZWQ6IGZhbHNlCiAgICB9LAogICAgZGVzdEZpZWxkczogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICcnLAogICAgICByZXF1aXJlZDogZmFsc2UKICAgIH0sCiAgICB3aWR0aDogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDEyMDAsCiAgICAgIHJlcXVpcmVkOiBmYWxzZQogICAgfSwKICAgIHBsYWNlaG9sZGVyOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ+ivt+mAieaLqScsCiAgICAgIHJlcXVpcmVkOiBmYWxzZQogICAgfSwKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgcmVxdWlyZWQ6IGZhbHNlCiAgICB9LAogICAgdHJpZ2dlckNoYW5nZTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgZGlzYWJsZWQ6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIG11bHRpOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICAvL3BvcHVw5Yqo5oCB5Y+C5pWwIOaUr+aMgeezu+e7n+WPmOmHj+ivreazlQogICAgcGFyYW06ewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgZGVmYXVsdDogKCk9Pnt9CiAgICB9LAogICAgLyoqIOWIhue7hElE77yM55So5LqO5bCG5aSa5LiqcG9wdXDnmoTor7fmsYLlkIjlubbliLDkuIDotbfvvIzkuI3kvKDkuI3liIbnu4QgKi8KICAgIGdyb3VwSWQ6IFN0cmluZwoKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzaG93VGV4dDogJycsCiAgICAgIHRpdGxlOiAnJywKICAgICAgYXZhbGlkOiB0cnVlCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgdW5pcUdyb3VwSWQoKSB7CiAgICAgIGlmICh0aGlzLmdyb3VwSWQpIHsKICAgICAgICBsZXQgeyBncm91cElkLCBjb2RlLCBmaWVsZCwgb3JnRmllbGRzLCBkZXN0RmllbGRzIH0gPSB0aGlzCiAgICAgICAgcmV0dXJuIGAke2dyb3VwSWR9XyR7Y29kZX1fJHtmaWVsZH1fJHtvcmdGaWVsZHN9XyR7ZGVzdEZpZWxkc31gCiAgICAgIH0KICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICB2YWx1ZTogewogICAgICBpbW1lZGlhdGU6IHRydWUsCiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uKHZhbCkgewogICAgICAgIGlmICghdmFsKSB7CiAgICAgICAgICB0aGlzLnNob3dUZXh0ID0gJycKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5zaG93VGV4dCA9IHZhbAogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICB9LAogIG1vdW50ZWQoKSB7CiAgICBpZiAoIXRoaXMub3JnRmllbGRzIHx8ICF0aGlzLmRlc3RGaWVsZHMgfHwgIXRoaXMuY29kZSkgewogICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCdwb3B1cOWPguaVsOacquato+ehrumFjee9riEnKQogICAgICB0aGlzLmF2YWxpZCA9IGZhbHNlCiAgICB9CiAgICBpZiAodGhpcy5kZXN0RmllbGRzLnNwbGl0KCcsJykubGVuZ3RoICE9IHRoaXMub3JnRmllbGRzLnNwbGl0KCcsJykubGVuZ3RoKSB7CiAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ3BvcHVw5Y+C5pWw5pyq5q2j56Gu6YWN572uLOWOn+Wni+WAvOWSjOebruagh+WAvOaVsOmHj+S4jeS4gOiHtCEnKQogICAgICB0aGlzLmF2YWxpZCA9IGZhbHNlCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBvcGVuTW9kYWwoKSB7CiAgICAgIGlmICh0aGlzLmRpc2FibGVkID09PSBmYWxzZSkgewogICAgICAgIHRoaXMuJHJlZnMualBvcHVwT25sUmVwb3J0LnNob3coKQogICAgICB9CiAgICB9LAogICAgaGFuZGxlRW1wdHkoKSB7CiAgICAgIHRoaXMuc2hvd1RleHQgPSAnJwogICAgICBsZXQgZGVzdEZpZWxkc0FyciA9IHRoaXMuZGVzdEZpZWxkcy5zcGxpdCgnLCcpCiAgICAgIGlmIChkZXN0RmllbGRzQXJyLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIGxldCByZXMgPSB7fQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRlc3RGaWVsZHNBcnIubGVuZ3RoOyBpKyspIHsKICAgICAgICByZXNbZGVzdEZpZWxkc0FycltpXV0gPSAnJwogICAgICB9CiAgICAgIGlmICh0aGlzLnRyaWdnZXJDaGFuZ2UpIHsKICAgICAgICB0aGlzLiRlbWl0KCdjYWxsYmFjaycsIHJlcykKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsICcnLCByZXMpCiAgICAgIH0KICAgIH0sCiAgICBjYWxsQmFjayhyb3dzKSB7CiAgICAgIC8vIHVwZGF0ZS0tYmVnaW4tLWF1dG9yOmx2ZGFuZGFuLS0tLS1kYXRlOjIwMjAwNjMwLS0tLS0tZm9y77ya5aSa6YCJ5pe25pyq5bim5Zue5aSa5Liq5YC8LS0tLS0tCiAgICAgIGxldCBvcmdGaWVsZHNBcnIgPSB0aGlzLm9yZ0ZpZWxkcy5zcGxpdCgnLCcpCiAgICAgIGxldCBkZXN0RmllbGRzQXJyID0gdGhpcy5kZXN0RmllbGRzLnNwbGl0KCcsJykKICAgICAgbGV0IHJlc2V0VGV4dCA9IGZhbHNlCiAgICAgIGlmICh0aGlzLmZpZWxkICYmIHRoaXMuZmllbGQubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMuc2hvd1RleHQgPSAnJwogICAgICAgIHJlc2V0VGV4dCA9IHRydWUKICAgICAgfQogICAgICBsZXQgcmVzID0ge30KICAgICAgaWYgKG9yZ0ZpZWxkc0Fyci5sZW5ndGggPiAwKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcmdGaWVsZHNBcnIubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGxldCB0ZW1wRGVzdEFyciA9IFtdCiAgICAgICAgICBmb3IobGV0IHJ3IG9mIHJvd3MpewogICAgICAgICAgICBsZXQgdmFsID0gcndbb3JnRmllbGRzQXJyW2ldXQogICAgICAgICAgICBpZighdmFsKXsKICAgICAgICAgICAgICB2YWwgPSAiIgogICAgICAgICAgICB9CiAgICAgICAgICAgIHRlbXBEZXN0QXJyLnB1c2godmFsKQogICAgICAgICAgfQogICAgICAgICAgcmVzW2Rlc3RGaWVsZHNBcnJbaV1dID0gdGVtcERlc3RBcnIuam9pbigiLCIpCiAgICAgICAgfQogICAgICAgIGlmIChyZXNldFRleHQgPT09IHRydWUpIHsKICAgICAgICAgIGxldCB0ZW1wVGV4dCA9IFtdCiAgICAgICAgICBmb3IobGV0IHJ3IG9mIHJvd3MpewogICAgICAgICAgICBsZXQgdmFsID0gcndbb3JnRmllbGRzQXJyW2Rlc3RGaWVsZHNBcnIuaW5kZXhPZih0aGlzLmZpZWxkKV1dCiAgICAgICAgICAgIGlmKCF2YWwpewogICAgICAgICAgICAgIHZhbCA9ICIiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGVtcFRleHQucHVzaCh2YWwpCiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLnNob3dUZXh0ID0gdGVtcFRleHQuam9pbigiLCIpCiAgICAgICAgfQogICAgICAgIC8vIHVwZGF0ZS0tZW5kLS1hdXRvcjpsdmRhbmRhbi0tLS0tZGF0ZToyMDIwMDYzMC0tLS0tLWZvcu+8muWkmumAieaXtuacquW4puWbnuWkmuS4quWAvC0tLS0tLQogICAgICB9CiAgICAgIGlmICh0aGlzLnRyaWdnZXJDaGFuZ2UpIHsKICAgICAgICAvL3YtZGVj5pe25Y2zdHJpZ2dlckNoYW5nZeS4unRydWXml7Yg5bCG5pW05Liq5a+56LGh57uZZm9ybemhtemdoiDorqnku5boh6rlt7FzZXRGaWVsZHNWYWx1ZQogICAgICAgIHRoaXMuJGVtaXQoJ2NhbGxiYWNrJywgcmVzKQogICAgICB9IGVsc2UgewogICAgICAgIC8vdi1tb2RlbOaXtiDpnIDopoHkvKDkuIDkuKrlj4LmlbBmaWVsZCDooajnpLrlvZPliY3ov5nkuKrlrZfmrrUg5LuO6ICM5qC55o2u6L+Z5Liq5a2X5q6155qE6aG65bqP5om+5Yiw5Y6f5aeL5YC8CiAgICAgICAgLy8gdGhpcy4kZW1pdCgiaW5wdXQiLHJvd1tvcmdGaWVsZHNBcnJbZGVzdEZpZWxkc0Fyci5pbmRleE9mKHRoaXMuZmllbGQpXV0pCiAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB0aGlzLnNob3dUZXh0LCByZXMpCiAgICAgIH0KICAgIH0KICB9Cn0K"},{"version":3,"sources":["JPopup.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAqBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"JPopup.vue","sourceRoot":"src/components/jeecg","sourcesContent":["<template>\r\n  <div class=\"components-input-demo-presuffix\" v-if=\"avalid\">\r\n    <!---->\r\n    <a-input @click=\"openModal\" :placeholder=\"placeholder\" v-model=\"showText\" readOnly :disabled=\"disabled\">\r\n      <a-icon slot=\"prefix\" type=\"cluster\" :title=\"title\"/>\r\n      <a-icon v-if=\"showText\" slot=\"suffix\" type=\"close-circle\" @click=\"handleEmpty\" title=\"清空\"/>\r\n    </a-input>\r\n\r\n    <j-popup-onl-report\r\n      ref=\"jPopupOnlReport\"\r\n      :code=\"code\"\r\n      :multi=\"multi\"\r\n      :groupId=\"uniqGroupId\"\r\n      :param=\"param\"\r\n      @ok=\"callBack\"\r\n    />\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import JPopupOnlReport from './modal/JPopupOnlReport'\r\n\r\n  export default {\r\n    name: 'JPopup',\r\n    components: {\r\n      JPopupOnlReport\r\n    },\r\n    props: {\r\n      code: {\r\n        type: String,\r\n        default: '',\r\n        required: false\r\n      },\r\n      field: {\r\n        type: String,\r\n        default: '',\r\n        required: false\r\n      },\r\n      orgFields: {\r\n        type: String,\r\n        default: '',\r\n        required: false\r\n      },\r\n      destFields: {\r\n        type: String,\r\n        default: '',\r\n        required: false\r\n      },\r\n      width: {\r\n        type: Number,\r\n        default: 1200,\r\n        required: false\r\n      },\r\n      placeholder: {\r\n        type: String,\r\n        default: '请选择',\r\n        required: false\r\n      },\r\n      value: {\r\n        type: String,\r\n        required: false\r\n      },\r\n      triggerChange: {\r\n        type: Boolean,\r\n        required: false,\r\n        default: false\r\n      },\r\n      disabled: {\r\n        type: Boolean,\r\n        required: false,\r\n        default: false\r\n      },\r\n      multi: {\r\n        type: Boolean,\r\n        required: false,\r\n        default: false\r\n      },\r\n      //popup动态参数 支持系统变量语法\r\n      param:{\r\n        type: Object,\r\n        required: false,\r\n        default: ()=>{}\r\n      },\r\n      /** 分组ID，用于将多个popup的请求合并到一起，不传不分组 */\r\n      groupId: String\r\n\r\n    },\r\n    data() {\r\n      return {\r\n        showText: '',\r\n        title: '',\r\n        avalid: true\r\n      }\r\n    },\r\n    computed: {\r\n      uniqGroupId() {\r\n        if (this.groupId) {\r\n          let { groupId, code, field, orgFields, destFields } = this\r\n          return `${groupId}_${code}_${field}_${orgFields}_${destFields}`\r\n        }\r\n      }\r\n    },\r\n    watch: {\r\n      value: {\r\n        immediate: true,\r\n        handler: function(val) {\r\n          if (!val) {\r\n            this.showText = ''\r\n          } else {\r\n            this.showText = val\r\n          }\r\n        }\r\n      }\r\n    },\r\n    created() {\r\n    },\r\n    mounted() {\r\n      if (!this.orgFields || !this.destFields || !this.code) {\r\n        this.$message.error('popup参数未正确配置!')\r\n        this.avalid = false\r\n      }\r\n      if (this.destFields.split(',').length != this.orgFields.split(',').length) {\r\n        this.$message.error('popup参数未正确配置,原始值和目标值数量不一致!')\r\n        this.avalid = false\r\n      }\r\n    },\r\n    methods: {\r\n      openModal() {\r\n        if (this.disabled === false) {\r\n          this.$refs.jPopupOnlReport.show()\r\n        }\r\n      },\r\n      handleEmpty() {\r\n        this.showText = ''\r\n        let destFieldsArr = this.destFields.split(',')\r\n        if (destFieldsArr.length === 0) {\r\n          return\r\n        }\r\n        let res = {}\r\n        for (let i = 0; i < destFieldsArr.length; i++) {\r\n          res[destFieldsArr[i]] = ''\r\n        }\r\n        if (this.triggerChange) {\r\n          this.$emit('callback', res)\r\n        } else {\r\n          this.$emit('input', '', res)\r\n        }\r\n      },\r\n      callBack(rows) {\r\n        // update--begin--autor:lvdandan-----date:20200630------for：多选时未带回多个值------\r\n        let orgFieldsArr = this.orgFields.split(',')\r\n        let destFieldsArr = this.destFields.split(',')\r\n        let resetText = false\r\n        if (this.field && this.field.length > 0) {\r\n          this.showText = ''\r\n          resetText = true\r\n        }\r\n        let res = {}\r\n        if (orgFieldsArr.length > 0) {\r\n          for (let i = 0; i < orgFieldsArr.length; i++) {\r\n            let tempDestArr = []\r\n            for(let rw of rows){\r\n              let val = rw[orgFieldsArr[i]]\r\n              if(!val){\r\n                val = \"\"\r\n              }\r\n              tempDestArr.push(val)\r\n            }\r\n            res[destFieldsArr[i]] = tempDestArr.join(\",\")\r\n          }\r\n          if (resetText === true) {\r\n            let tempText = []\r\n            for(let rw of rows){\r\n              let val = rw[orgFieldsArr[destFieldsArr.indexOf(this.field)]]\r\n              if(!val){\r\n                val = \"\"\r\n              }\r\n              tempText.push(val)\r\n            }\r\n            this.showText = tempText.join(\",\")\r\n          }\r\n          // update--end--autor:lvdandan-----date:20200630------for：多选时未带回多个值------\r\n        }\r\n        if (this.triggerChange) {\r\n          //v-dec时即triggerChange为true时 将整个对象给form页面 让他自己setFieldsValue\r\n          this.$emit('callback', res)\r\n        } else {\r\n          //v-model时 需要传一个参数field 表示当前这个字段 从而根据这个字段的顺序找到原始值\r\n          // this.$emit(\"input\",row[orgFieldsArr[destFieldsArr.indexOf(this.field)]])\r\n          this.$emit('input', this.showText, res)\r\n        }\r\n      }\r\n    }\r\n  }\r\n</script>\r\n<style scoped>\r\n  .components-input-demo-presuffix .anticon-close-circle {\r\n    cursor: pointer;\r\n    color: #ccc;\r\n    transition: color 0.3s;\r\n    font-size: 12px;\r\n  }\r\n\r\n  .components-input-demo-presuffix .anticon-close-circle:hover {\r\n    color: #f5222d;\r\n  }\r\n\r\n  .components-input-demo-presuffix .anticon-close-circle:active {\r\n    color: #666;\r\n  }\r\n</style>"]}]}