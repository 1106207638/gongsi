{"remainingRequest":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\views\\jeecg\\JVxeDemo\\demo\\SocketReload.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\src\\views\\jeecg\\JVxeDemo\\demo\\SocketReload.vue","mtime":1615948818513},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldEFjdGlvbiB9IGZyb20gJ0BhcGkvbWFuYWdlJwppbXBvcnQgeyBKVlhFVHlwZXMgfSBmcm9tICdAL2NvbXBvbmVudHMvamVlY2cvSlZ4ZVRhYmxlJwoKLy8g5peg55eV5Yi35paw56S65L6LCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnU29ja2V0UmVsb2FkJywKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIGRhdGFTb3VyY2U6IFtdLAogICAgICBjb2x1bW5zOiBbCiAgICAgICAge2tleTogJ251bScsIHRpdGxlOiAn5bqP5Y+3Jywgd2lkdGg6ICc4MHB4J30sCiAgICAgICAge2tleTogJ3NoaXBfbmFtZScsIHRpdGxlOiAn6Ii55ZCNJywgd2lkdGg6ICcxODBweCcsIHR5cGU6IEpWWEVUeXBlcy5pbnB1dH0sCiAgICAgICAge2tleTogJ2NhbGwnLCB0aXRsZTogJ+WRvOWPqycsIHdpZHRoOiAnODBweCcsIHR5cGU6IEpWWEVUeXBlcy5pbnB1dH0sCiAgICAgICAge2tleTogJ2xlbicsIHRpdGxlOiAn6ZW/Jywgd2lkdGg6ICc4MHB4JywgdHlwZTogSlZYRVR5cGVzLmlucHV0fSwKICAgICAgICB7a2V5OiAndG9uJywgdGl0bGU6ICflkKgnLCB3aWR0aDogJzEyMHB4JywgdHlwZTogSlZYRVR5cGVzLmlucHV0fSwKICAgICAgICB7a2V5OiAncGF5ZXInLCB0aXRsZTogJ+S7mOasvuaWuScsIHdpZHRoOiAnMTIwcHgnLCB0eXBlOiBKVlhFVHlwZXMuaW5wdXR9LAogICAgICAgIHtrZXk6ICdjb3VudCcsIHRpdGxlOiAn5pWwJywgd2lkdGg6ICc0MHB4J30sCiAgICAgICAge2tleTogJ2NvbXBhbnknLCB0aXRsZTogJ+WFrOWPuCcsIG1pbldpZHRoOiAnMTgwcHgnLCB0eXBlOiBKVlhFVHlwZXMuaW5wdXR9LAogICAgICAgIHtrZXk6ICd0cmVuZCcsIHRpdGxlOiAn5Yqo5ZCRJywgd2lkdGg6ICcxMjBweCcsIHR5cGU6IEpWWEVUeXBlcy5pbnB1dH0sCiAgICAgIF0sCiAgICAgIC8vIOafpeivonVybOWcsOWdgAogICAgICB1cmw6IHsKICAgICAgICBnZXREYXRhOiAnL21vY2svdnhlL2dldERhdGEnLAogICAgICB9LAogICAgICAvLyDmmK/lkKblkK/nlKjml6XljobliLfmlrDmlYjmnpwKICAgICAgcmVsb2FkRWZmZWN0OiBmYWxzZSwKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxvYWREYXRhKCkKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOWKoOi9veaVsOaNrgogICAgbG9hZERhdGEoKSB7CiAgICAgIGxldCBmb3JtRGF0YSA9IHtwYWdlTm86IDEsIHBhZ2VTaXplOiAyMDB9CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKICAgICAgZ2V0QWN0aW9uKHRoaXMudXJsLmdldERhdGEsIGZvcm1EYXRhKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICB0aGlzLmRhdGFTb3VyY2UgPSByZXMucmVzdWx0LnJlY29yZHMKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kZXJyb3Ioe3RpdGxlOiAn5Li76KGo5p+l6K+i5aSx6LSlJywgY29udGVudDogcmVzLm1lc3NhZ2V9KQogICAgICAgIH0KICAgICAgfSkuZmluYWxseSgoKSA9PiB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgfSkKICAgIH0sCgogICAgLy8g5Y2V5YWD5qC857yW6L6R5a6M5oiQ5LmL5ZCO6Kem5Y+R55qE5LqL5Lu2CiAgICBoYW5kbGVFZGl0Q2xvc2VkKGV2ZW50KSB7CiAgICAgIGxldCB7JHRhYmxlLCByb3csIGNvbHVtbn0gPSBldmVudAoKICAgICAgbGV0IGZpZWxkID0gY29sdW1uLnByb3BlcnR5CiAgICAgIGxldCBjZWxsVmFsdWUgPSByb3dbZmllbGRdCiAgICAgIC8vIOWIpOaWreWNleWFg+agvOWAvOaYr+WQpuiiq+S/ruaUuQogICAgICBpZiAoJHRhYmxlLmlzVXBkYXRlQnlSb3cocm93LCBmaWVsZCkpIHsKICAgICAgICAvLyDmoKHpqozlvZPliY3ooYwKICAgICAgICAkdGFibGUudmFsaWRhdGUocm93KS50aGVuKChlcnJNYXApID0+IHsKICAgICAgICAgIC8vIOagoemqjOmAmui/hwogICAgICAgICAgaWYgKCFlcnJNYXApIHsKICAgICAgICAgICAgLy8g44CQ5qih5ouf5L+d5a2Y44CR77yI5q2k5aSE6ZyA6KaB5pu/5o2i5oiQ55yf5a6e55qE6K+35rGC77yJCiAgICAgICAgICAgIGxldCBoaWRlTG9hZGluZyA9IHRoaXMuJG1lc3NhZ2UubG9hZGluZyhg5q2j5Zyo5L+d5a2YIiR7Y29sdW1uLnRpdGxlfSJgLCAwKQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICBoaWRlTG9hZGluZygpCiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKGAiJHtjb2x1bW4udGl0bGV9IuS/neWtmOaIkOWKn++8gWApCiAgICAgICAgICAgICAgLy8g5bGA6YOo5pu05paw5Y2V5YWD5qC85Li65bey5L+d5a2Y54q25oCBCiAgICAgICAgICAgICAgJHRhYmxlLnJlbG9hZFJvdyhyb3csIG51bGwsIGZpZWxkKQogICAgICAgICAgICAgIC8vIOWPkemAgeabtOaWsOa2iOaBrwogICAgICAgICAgICAgIHRoaXMuJHJlZnMudGFibGUuc29ja2V0U2VuZFVwZGF0ZVJvdyhyb3cpCiAgICAgICAgICAgIH0sIDU1NSkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9CiAgICB9LAoKICB9LAp9Cg=="},{"version":3,"sources":["SocketReload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"SocketReload.vue","sourceRoot":"src/views/jeecg/JVxeDemo/demo","sourcesContent":["<template>\r\n  <a-card title=\"无痕刷新示例\" :bordered=\"false\">\r\n\r\n    <div style=\"margin-bottom: 8px;\">\r\n      <span>启用数据变动特效：</span>\r\n      <a-switch v-model=\"reloadEffect\"/>\r\n    </div>\r\n\r\n    <!--\r\n      【即时保存大体思路】：\r\n      1. 该功能依赖于【即时保存】功能，请先看即时保存示例\r\n      2. 必须要有 socket-reload 属性，且设为 true\r\n      3. 必须要有 socket-key 属性，该属性为当前表格的唯一标识，\r\n         系统会自动更新所有 socket-key 相同的表格\r\n      4. 在局部保存 edit-closed 事件中，\r\n         保存成功后调用 socketSendUpdateRow 方法，将当前 row 传递过去即可 （见第 108 行）\r\n    -->\r\n    <j-vxe-table\r\n      ref=\"table\"\r\n      row-number\r\n      row-selection\r\n\r\n      keep-source\r\n      socket-reload\r\n      socket-key=\"demo-socket-reload\"\r\n      :reload-effect=\"reloadEffect\"\r\n\r\n      :height=\"340\"\r\n      :loading=\"loading\"\r\n      :columns=\"columns\"\r\n      :dataSource=\"dataSource\"\r\n      @edit-closed=\"handleEditClosed\"\r\n    />\r\n  </a-card>\r\n</template>\r\n\r\n<script>\r\n  import { getAction } from '@api/manage'\r\n  import { JVXETypes } from '@/components/jeecg/JVxeTable'\r\n\r\n  // 无痕刷新示例\r\n  export default {\r\n    name: 'SocketReload',\r\n    data() {\r\n      return {\r\n        loading: false,\r\n        dataSource: [],\r\n        columns: [\r\n          {key: 'num', title: '序号', width: '80px'},\r\n          {key: 'ship_name', title: '船名', width: '180px', type: JVXETypes.input},\r\n          {key: 'call', title: '呼叫', width: '80px', type: JVXETypes.input},\r\n          {key: 'len', title: '长', width: '80px', type: JVXETypes.input},\r\n          {key: 'ton', title: '吨', width: '120px', type: JVXETypes.input},\r\n          {key: 'payer', title: '付款方', width: '120px', type: JVXETypes.input},\r\n          {key: 'count', title: '数', width: '40px'},\r\n          {key: 'company', title: '公司', minWidth: '180px', type: JVXETypes.input},\r\n          {key: 'trend', title: '动向', width: '120px', type: JVXETypes.input},\r\n        ],\r\n        // 查询url地址\r\n        url: {\r\n          getData: '/mock/vxe/getData',\r\n        },\r\n        // 是否启用日历刷新效果\r\n        reloadEffect: false,\r\n      }\r\n    },\r\n    created() {\r\n      this.loadData()\r\n    },\r\n    methods: {\r\n      // 加载数据\r\n      loadData() {\r\n        let formData = {pageNo: 1, pageSize: 200}\r\n        this.loading = true\r\n        getAction(this.url.getData, formData).then(res => {\r\n          if (res.success) {\r\n            this.dataSource = res.result.records\r\n          } else {\r\n            this.$error({title: '主表查询失败', content: res.message})\r\n          }\r\n        }).finally(() => {\r\n          this.loading = false\r\n        })\r\n      },\r\n\r\n      // 单元格编辑完成之后触发的事件\r\n      handleEditClosed(event) {\r\n        let {$table, row, column} = event\r\n\r\n        let field = column.property\r\n        let cellValue = row[field]\r\n        // 判断单元格值是否被修改\r\n        if ($table.isUpdateByRow(row, field)) {\r\n          // 校验当前行\r\n          $table.validate(row).then((errMap) => {\r\n            // 校验通过\r\n            if (!errMap) {\r\n              // 【模拟保存】（此处需要替换成真实的请求）\r\n              let hideLoading = this.$message.loading(`正在保存\"${column.title}\"`, 0)\r\n              setTimeout(() => {\r\n                hideLoading()\r\n                this.$message.success(`\"${column.title}\"保存成功！`)\r\n                // 局部更新单元格为已保存状态\r\n                $table.reloadRow(row, null, field)\r\n                // 发送更新消息\r\n                this.$refs.table.socketSendUpdateRow(row)\r\n              }, 555)\r\n            }\r\n          })\r\n        }\r\n      },\r\n\r\n    },\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]}]}