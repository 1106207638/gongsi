{"remainingRequest":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\views\\modules\\oss\\OSSFileList.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\src\\views\\modules\\oss\\OSSFileList.vue","mtime":1615948820465},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7SmVlY2dMaXN0TWl4aW59IGZyb20gJ0AvbWl4aW5zL0plZWNnTGlzdE1peGluJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJPU1NGaWxlTGlzdCIsCiAgbWl4aW5zOiBbSmVlY2dMaXN0TWl4aW5dLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkZXNjcmlwdGlvbjogJ+aWh+S7tuWIl+ihqCcsCiAgICAgIC8vIOihqOWktAogICAgICBjb2x1bW5zOiBbCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICcjJywKICAgICAgICAgIGRhdGFJbmRleDogJycsCiAgICAgICAgICBrZXk6ICdyb3dJbmRleCcsCiAgICAgICAgICB3aWR0aDogNjAsCiAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICBjdXN0b21SZW5kZXI6IGZ1bmN0aW9uICh0LCByLCBpbmRleCkgewogICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoaW5kZXgpICsgMTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAn5paH5Lu25ZCN56ewJywKICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgIGRhdGFJbmRleDogJ2ZpbGVOYW1lJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICfmlofku7blnLDlnYAnLAogICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgZGF0YUluZGV4OiAndXJsJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICfmk43kvZwnLAogICAgICAgICAgZGF0YUluZGV4OiAnYWN0aW9uJywKICAgICAgICAgIGFsaWduOiAiY2VudGVyIiwKICAgICAgICAgIHNjb3BlZFNsb3RzOiB7Y3VzdG9tUmVuZGVyOiAnYWN0aW9uJ30sCiAgICAgICAgfQogICAgICBdLAogICAgICB1cmw6IHsKICAgICAgICB1cGxvYWQ6ICIvc3lzL29zcy9maWxlL3VwbG9hZCIsCiAgICAgICAgbGlzdDogIi9zeXMvb3NzL2ZpbGUvbGlzdCIsCiAgICAgICAgZGVsZXRlOiAiL3N5cy9vc3MvZmlsZS9kZWxldGUiLAogICAgICAgIG1pbmlvVXBsb2FkOiAiL3N5cy91cGxvYWQvdXBsb2FkTWluaW8iCiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICB1cGxvYWRBY3Rpb24oKSB7CiAgICAgIHJldHVybiB3aW5kb3cuX0NPTkZJR1snZG9taWFuVVJMJ10gKyB0aGlzLnVybC51cGxvYWQ7CiAgICB9LAogICAgbWluaW9VcGxvYWRBY3Rpb24oKSB7CiAgICAgIHJldHVybiB3aW5kb3cuX0NPTkZJR1snZG9taWFuVVJMJ10gKyB0aGlzLnVybC5taW5pb1VwbG9hZDsKICAgIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICBiZWZvcmVVcGxvYWQoZmlsZSkgewogICAgICB2YXIgZmlsZVR5cGUgPSBmaWxlLnR5cGU7CiAgICAgIGlmIChmaWxlVHlwZSA9PT0gJ2ltYWdlJykgewogICAgICAgIGlmIChmaWxlVHlwZS5pbmRleE9mKCdpbWFnZScpIDwgMCkgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfor7fkuIrkvKDlm77niYcnKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZmlsZVR5cGUgPT09ICdmaWxlJykgewogICAgICAgIGlmIChmaWxlVHlwZS5pbmRleE9mKCdpbWFnZScpID49IDApIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn6K+35LiK5Lyg5paH5Lu2Jyk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB0cnVlCiAgICB9LAogICAgaGFuZGxlQ2hhbmdlKGluZm8pIHsKICAgICAgaWYgKGluZm8uZmlsZS5zdGF0dXMgPT09ICdkb25lJykgewogICAgICAgIGlmIChpbmZvLmZpbGUucmVzcG9uc2Uuc3VjY2VzcykgewogICAgICAgICAgdGhpcy5sb2FkRGF0YSgpCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoYCR7aW5mby5maWxlLm5hbWV9IOS4iuS8oOaIkOWKnyFgKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihgJHtpbmZvLmZpbGUucmVzcG9uc2UubWVzc2FnZX1gKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoaW5mby5maWxlLnN0YXR1cyA9PT0gJ2Vycm9yJykgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoYCR7aW5mby5maWxlLnJlc3BvbnNlLm1lc3NhZ2V9YCk7CiAgICAgIH0KICAgIH0sCiAgICBvc3NEZWxldGUoaWQpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICB0aGF0LiRjb25maXJtKHsKICAgICAgICB0aXRsZTogIuehruiupOWIoOmZpCIsCiAgICAgICAgY29udGVudDogIuaYr+WQpuWIoOmZpOmAieS4reaWh+S7tj8iLAogICAgICAgIG9uT2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHRoYXQuaGFuZGxlRGVsZXRlKGlkKQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlUHJldmlldyhyZWNvcmQpIHsKICAgICAgaWYgKHJlY29yZCAmJiByZWNvcmQudXJsKSB7CiAgICAgICAgbGV0IHVybCA9IHdpbmRvdy5fQ09ORklHWydvbmxpbmVQcmV2aWV3RG9tYWluVVJMJ10gKyAnP3VybD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHJlY29yZC51cmwpCiAgICAgICAgd2luZG93Lm9wZW4odXJsLCAnX2JsYW5rJykKICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["OSSFileList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4FA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"OSSFileList.vue","sourceRoot":"src/views/modules/oss","sourcesContent":["<template>\r\n  <a-card :bordered=\"false\">\r\n    <!-- 查询区域 -->\r\n    <div class=\"table-page-search-wrapper\">\r\n      <a-form layout=\"inline\" @keyup.enter.native=\"searchQuery\">\r\n        <a-row :gutter=\"24\">\r\n          <a-col :md=\"6\" :sm=\"8\">\r\n            <a-form-item label=\"文件名称\">\r\n              <a-input placeholder=\"请输入文件名称\" v-model=\"queryParam.fileName\"></a-input>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :md=\"6\" :sm=\"8\">\r\n            <a-form-item label=\"文件地址\">\r\n              <a-input placeholder=\"请输入文件地址\" v-model=\"queryParam.url\"></a-input>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :md=\"6\" :sm=\"8\">\r\n            <span style=\"float: left;overflow: hidden;\" class=\"table-page-search-submitButtons\">\r\n              <a-button type=\"primary\" @click=\"searchQuery\" icon=\"search\">查询</a-button>\r\n              <a-button type=\"primary\" @click=\"searchReset\" icon=\"reload\" style=\"margin-left: 8px\">重置</a-button>\r\n            </span>\r\n          </a-col>\r\n        </a-row>\r\n      </a-form>\r\n    </div>\r\n\r\n    <!-- 操作按钮区域 -->\r\n    <div class=\"table-operator\">\r\n      <!--      <a-button type=\"primary\" icon=\"download\" @click=\"handleExportXls('文件列表')\">导出</a-button>-->\r\n      <a-upload\r\n          name=\"file\"\r\n          :multiple=\"false\"\r\n          :action=\"uploadAction\"\r\n          :headers=\"tokenHeader\"\r\n          :showUploadList=\"false\"\r\n          :beforeUpload=\"beforeUpload\"\r\n          @change=\"handleChange\">\r\n        <a-button>\r\n          <a-icon type=\"upload\"/>\r\n          OSS文件上传\r\n        </a-button>\r\n      </a-upload>\r\n\r\n      <a-upload\r\n        name=\"file\"\r\n        :multiple=\"false\"\r\n        :action=\"minioUploadAction\"\r\n        :headers=\"tokenHeader\"\r\n        :showUploadList=\"false\"\r\n        :beforeUpload=\"beforeUpload\"\r\n        @change=\"handleChange\">\r\n        <a-button>\r\n          <a-icon type=\"upload\"/>\r\n          MINIO文件上传\r\n        </a-button>\r\n      </a-upload>\r\n    </div>\r\n\r\n    <!-- table区域-begin -->\r\n    <div>\r\n      <div class=\"ant-alert ant-alert-info\" style=\"margin-bottom: 16px;\">\r\n        <i class=\"anticon anticon-info-circle ant-alert-icon\"></i> 已选择 <a\r\n          style=\"font-weight: 600\">{{\r\n        selectedRowKeys.length }}</a>项\r\n        <a style=\"margin-left: 24px\" @click=\"onClearSelected\">清空</a>\r\n      </div>\r\n\r\n      <a-table\r\n          ref=\"table\"\r\n          size=\"middle\"\r\n          bordered\r\n          rowKey=\"id\"\r\n          :columns=\"columns\"\r\n          :dataSource=\"dataSource\"\r\n          :pagination=\"ipagination\"\r\n          :loading=\"loading\"\r\n          :rowSelection=\"{selectedRowKeys: selectedRowKeys, onChange: onSelectChange}\"\r\n          @change=\"handleTableChange\">\r\n\r\n        <span slot=\"action\" slot-scope=\"text, record\">\r\n          <a @click=\"handlePreview(record)\">预览</a>\r\n          <a-divider type=\"vertical\"/>\r\n          <a @click=\"ossDelete(record.id)\">删除</a>\r\n        </span>\r\n\r\n      </a-table>\r\n    </div>\r\n    <!-- table区域-end -->\r\n  </a-card>\r\n</template>\r\n\r\n<script>\r\n  import {JeecgListMixin} from '@/mixins/JeecgListMixin'\r\n\r\n  export default {\r\n    name: \"OSSFileList\",\r\n    mixins: [JeecgListMixin],\r\n    data() {\r\n      return {\r\n        description: '文件列表',\r\n        // 表头\r\n        columns: [\r\n          {\r\n            title: '#',\r\n            dataIndex: '',\r\n            key: 'rowIndex',\r\n            width: 60,\r\n            align: \"center\",\r\n            customRender: function (t, r, index) {\r\n              return parseInt(index) + 1;\r\n            }\r\n          },\r\n          {\r\n            title: '文件名称',\r\n            align: \"center\",\r\n            dataIndex: 'fileName'\r\n          },\r\n          {\r\n            title: '文件地址',\r\n            align: \"center\",\r\n            dataIndex: 'url'\r\n          },\r\n          {\r\n            title: '操作',\r\n            dataIndex: 'action',\r\n            align: \"center\",\r\n            scopedSlots: {customRender: 'action'},\r\n          }\r\n        ],\r\n        url: {\r\n          upload: \"/sys/oss/file/upload\",\r\n          list: \"/sys/oss/file/list\",\r\n          delete: \"/sys/oss/file/delete\",\r\n          minioUpload: \"/sys/upload/uploadMinio\"\r\n        }\r\n      }\r\n    },\r\n    computed: {\r\n      uploadAction() {\r\n        return window._CONFIG['domianURL'] + this.url.upload;\r\n      },\r\n      minioUploadAction() {\r\n        return window._CONFIG['domianURL'] + this.url.minioUpload;\r\n      },\r\n    },\r\n    methods: {\r\n      beforeUpload(file) {\r\n        var fileType = file.type;\r\n        if (fileType === 'image') {\r\n          if (fileType.indexOf('image') < 0) {\r\n            this.$message.warning('请上传图片');\r\n            return false;\r\n          }\r\n        } else if (fileType === 'file') {\r\n          if (fileType.indexOf('image') >= 0) {\r\n            this.$message.warning('请上传文件');\r\n            return false;\r\n          }\r\n        }\r\n        return true\r\n      },\r\n      handleChange(info) {\r\n        if (info.file.status === 'done') {\r\n          if (info.file.response.success) {\r\n            this.loadData()\r\n            this.$message.success(`${info.file.name} 上传成功!`);\r\n          } else {\r\n            this.$message.error(`${info.file.response.message}`);\r\n          }\r\n        } else if (info.file.status === 'error') {\r\n          this.$message.error(`${info.file.response.message}`);\r\n        }\r\n      },\r\n      ossDelete(id) {\r\n        var that = this;\r\n        that.$confirm({\r\n          title: \"确认删除\",\r\n          content: \"是否删除选中文件?\",\r\n          onOk: function () {\r\n            that.handleDelete(id)\r\n          }\r\n        });\r\n      },\r\n      handlePreview(record) {\r\n        if (record && record.url) {\r\n          let url = window._CONFIG['onlinePreviewDomainURL'] + '?url=' + encodeURIComponent(record.url)\r\n          window.open(url, '_blank')\r\n        }\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  @import '~@assets/less/common.less';\r\n</style>\r\n"]}]}