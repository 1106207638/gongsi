{"remainingRequest":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue\\src\\components\\jeecg\\JVxeTable\\components\\cells\\JVxeSelectCell.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue\\src\\components\\jeecg\\JVxeTable\\components\\cells\\JVxeSelectCell.vue","mtime":1615948814724},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1615952610415},{"path":"D:\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615952641464},{"path":"D:\\vue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1615952643260}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBKVnhlQ2VsbE1peGlucywgeyBkaXNwYXRjaEV2ZW50IH0gZnJvbSAnQC9jb21wb25lbnRzL2plZWNnL0pWeGVUYWJsZS9taXhpbnMvSlZ4ZUNlbGxNaXhpbnMnCmltcG9ydCB7IEpWWEVUeXBlcyB9IGZyb20gJ0Bjb21wL2plZWNnL0pWeGVUYWJsZS9pbmRleCcKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnSlZ4ZVNlbGVjdENlbGwnLAogIG1peGluczogW0pWeGVDZWxsTWl4aW5zXSwKICBjb21wdXRlZDogewogICAgc2VsZWN0UHJvcHMoKSB7CiAgICAgIGxldCBwcm9wcyA9IHsuLi50aGlzLmNlbGxQcm9wc30KICAgICAgLy8g5Yik5patc2VsZWN05piv5ZCm5YWB6K646L6T5YWlCiAgICAgIGxldCB7YWxsb3dTZWFyY2gsIGFsbG93SW5wdXR9ID0gdGhpcy5vcmlnaW5Db2x1bW4KICAgICAgaWYgKGFsbG93SW5wdXQgPT09IHRydWUgfHwgYWxsb3dTZWFyY2ggPT09IHRydWUpIHsKICAgICAgICBwcm9wc1snc2hvd1NlYXJjaCddID0gdHJ1ZQogICAgICB9CiAgICAgIHJldHVybiBwcm9wcwogICAgfSwKICB9LAogIGNyZWF0ZWQoKSB7CiAgICBsZXQgbXVsdGlwbGUgPSBbSlZYRVR5cGVzLnNlbGVjdE11bHRpcGxlLCBKVlhFVHlwZXMubGlzdF9tdWx0aV0KICAgIGxldCBzZWFyY2ggPSBbSlZYRVR5cGVzLnNlbGVjdFNlYXJjaCwgSlZYRVR5cGVzLnNlbF9zZWFyY2hdCiAgICBpZiAobXVsdGlwbGUuaW5jbHVkZXModGhpcy4kdHlwZSkpIHsKICAgICAgLy8g5aSE55CG5aSa6YCJCiAgICAgIGxldCBwcm9wcyA9IHRoaXMub3JpZ2luQ29sdW1uLnByb3BzIHx8IHt9CiAgICAgIHByb3BzWydtb2RlJ10gPSAnbXVsdGlwbGUnCiAgICAgIHByb3BzWydtYXhUYWdDb3VudCddID0gMQogICAgICB0aGlzLiRzZXQodGhpcy5vcmlnaW5Db2x1bW4sICdwcm9wcycsIHByb3BzKQogICAgfSBlbHNlIGlmIChzZWFyY2guaW5jbHVkZXModGhpcy4kdHlwZSkpIHsKICAgICAgLy8g5aSE55CG5pCc57SiCiAgICAgIHRoaXMuJHNldCh0aGlzLm9yaWdpbkNvbHVtbiwgJ2FsbG93U2VhcmNoJywgdHJ1ZSkKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKCiAgICAvKiog5aSE55CGYmx1cuWkseWOu+eEpueCueS6i+S7tiAqLwogICAgaGFuZGxlQmx1cih2YWx1ZSkgewogICAgICBsZXQge2FsbG93SW5wdXQsIG9wdGlvbnN9ID0gdGhpcy5vcmlnaW5Db2x1bW4KCiAgICAgIGlmIChhbGxvd0lucHV0ID09PSB0cnVlKSB7CiAgICAgICAgLy8g5Yig6Zmk5peg55So55qE5Zug5pCc57Si77yI55So5oi36L6T5YWl77yJ6ICM5Yib5bu655qE6aG5CiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgIGxldCBpbmRleGVzID0gW10KICAgICAgICAgIG9wdGlvbnMuZm9yRWFjaCgob3B0aW9uLCBpbmRleCkgPT4gewogICAgICAgICAgICBpZiAob3B0aW9uLnZhbHVlLnRvTG9jYWxlU3RyaW5nKCkgPT09IHZhbHVlLnRvTG9jYWxlU3RyaW5nKCkpIHsKICAgICAgICAgICAgICBkZWxldGUgb3B0aW9uLnNlYXJjaEFkZAogICAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbi5zZWFyY2hBZGQgPT09IHRydWUpIHsKICAgICAgICAgICAgICBpbmRleGVzLnB1c2goaW5kZXgpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgICAvLyDnv7vovazliKDpmaTmlbDnu4TkuK3nmoTpobkKICAgICAgICAgIGZvciAobGV0IGluZGV4IG9mIGluZGV4ZXMucmV2ZXJzZSgpKSB7CiAgICAgICAgICAgIG9wdGlvbnMuc3BsaWNlKGluZGV4LCAxKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5oYW5kbGVCbHVyQ29tbW9uKHZhbHVlKQogICAgfSwKCiAgICAvKiog55So5LqO5pCc57Si5LiL5ouJ5qGG5Lit55qE5YaF5a65ICovCiAgICBoYW5kbGVTZWxlY3RGaWx0ZXJPcHRpb24oaW5wdXQsIG9wdGlvbikgewogICAgICBsZXQge2FsbG93U2VhcmNoLCBhbGxvd0lucHV0fSA9IHRoaXMub3JpZ2luQ29sdW1uCiAgICAgIGlmIChhbGxvd1NlYXJjaCA9PT0gdHJ1ZSB8fCBhbGxvd0lucHV0ID09PSB0cnVlKSB7CiAgICAgICAgLy91cGRhdGUtYmVnaW4tYXV0aG9yOnRhb3lhbiBkYXRlOjIwMjAwODIwIGZvcjrjgJDkuJPpobnku7vliqHjgJHlpKfov57pobnnm67lj43ppojooYznvJbovpHpl67popjlpITnkIYg5LiL5ouJ5qGG5pCc57SiCiAgICAgICAgcmV0dXJuIG9wdGlvbi5jb21wb25lbnRPcHRpb25zLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLnRleHQudG9Mb3dlckNhc2UoKS5pbmRleE9mKGlucHV0LnRvTG93ZXJDYXNlKCkpID49IDAKICAgICAgICAvL3VwZGF0ZS1lbmQtYXV0aG9yOnRhb3lhbiBkYXRlOjIwMjAwODIwIGZvcjrjgJDkuJPpobnku7vliqHjgJHlpKfov57pobnnm67lj43ppojooYznvJbovpHpl67popjlpITnkIYg5LiL5ouJ5qGG5pCc57SiCiAgICAgIH0KICAgICAgcmV0dXJuIHRydWUKICAgIH0sCgogICAgLyoqIHNlbGVjdCDmkJzntKLml7bnmoTkuovku7bvvIznlKjkuo7liqjmgIHmt7vliqBvcHRpb25zICovCiAgICBoYW5kbGVTZWFyY2hTZWxlY3QodmFsdWUpIHsKICAgICAgbGV0IHthbGxvd1NlYXJjaCwgYWxsb3dJbnB1dCwgb3B0aW9uc30gPSB0aGlzLm9yaWdpbkNvbHVtbgoKICAgICAgaWYgKGFsbG93U2VhcmNoICE9PSB0cnVlICYmIGFsbG93SW5wdXQgPT09IHRydWUpIHsKICAgICAgICAvLyDmmK/lkKbmib7liLDkuoblr7nlupTnmoTpobnvvIzmib7kuI3liLDliJnmt7vliqDov5nkuIDpobkKICAgICAgICBsZXQgZmxhZyA9IGZhbHNlCiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIG9wdGlvbnMpIHsKICAgICAgICAgIGlmIChvcHRpb24udmFsdWUudG9Mb2NhbGVTdHJpbmcoKSA9PT0gdmFsdWUudG9Mb2NhbGVTdHJpbmcoKSkgewogICAgICAgICAgICBmbGFnID0gdHJ1ZQogICAgICAgICAgICBicmVhawogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvLyAhIXZhbHVlIO+8muS4jea3u+WKoOepuuWAvAogICAgICAgIGlmICghZmxhZyAmJiAhIXZhbHVlKSB7CiAgICAgICAgICAvLyBzZWFyY2hBZGQg5piv5ZCm5piv6YCa6L+H5pCc57Si5re75Yqg55qECiAgICAgICAgICBvcHRpb25zLnB1c2goe3RpdGxlOiB2YWx1ZSwgdmFsdWU6IHZhbHVlLCBzZWFyY2hBZGQ6IHRydWV9KQogICAgICAgIH0KCiAgICAgIH0KICAgIH0sCgogIH0sCiAgLy8g44CQ57uE5Lu25aKe5by644CR5rOo6YeK6K+m6KeB77yaSlZ4ZUNlbGxNaXhpbnMuanMKICBlbmhhbmNlZDogewogICAgYW9wRXZlbnRzOiB7CiAgICAgIGVkaXRBY3RpdmVkOiBldmVudCA9PiBkaXNwYXRjaEV2ZW50KGV2ZW50LCAnYW50LXNlbGVjdCcpLAogICAgfSwKICAgIHRyYW5zbGF0ZToge2VuYWJsZWQ6IHRydWV9LAogICAgZ2V0VmFsdWUodmFsdWUpIHsKICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlLmpvaW4oJywnKQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB2YWx1ZQogICAgICB9CiAgICB9LAogICAgc2V0VmFsdWUodmFsdWUpIHsKICAgICAgbGV0IHtjb2x1bW46IHtvd246IGNvbH0sIHBhcmFtczogeyR0YWJsZX19ID0gdGhpcwogICAgICAvLyDliKTmlq3mmK/lkKbmmK/lpJrpgIkKICAgICAgaWYgKChjb2wucHJvcHMgfHwge30pWydtb2RlJ10gPT09ICdtdWx0aXBsZScpIHsKICAgICAgICAkdGFibGUuJHNldChjb2wucHJvcHMsICdtYXhUYWdDb3VudCcsIDEpCiAgICAgIH0KICAgICAgaWYgKHZhbHVlICE9IG51bGwgJiYgdmFsdWUgIT09ICcnKSB7CiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgIHJldHVybiB2YWx1ZSA9PT0gJycgPyBbXSA6IHZhbHVlLnNwbGl0KCcsJykKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHZhbHVlCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZAogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["JVxeSelectCell.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"JVxeSelectCell.vue","sourceRoot":"src/components/jeecg/JVxeTable/components/cells","sourcesContent":["<template>\r\n  <a-select\r\n    ref=\"select\"\r\n    :value=\"innerValue\"\r\n    allowClear\r\n    :filterOption=\"handleSelectFilterOption\"\r\n    v-bind=\"selectProps\"\r\n    style=\"width: 100%;\"\r\n    @blur=\"handleBlur\"\r\n    @change=\"handleChangeCommon\"\r\n    @search=\"handleSearchSelect\"\r\n  >\r\n\r\n    <template v-for=\"option of originColumn.options\">\r\n      <a-select-option :key=\"option.value\" :value=\"option.value\" :disabled=\"option.disabled\">\r\n        <span>{{option.text || option.label || option.title|| option.value}}</span>\r\n      </a-select-option>\r\n    </template>\r\n\r\n  </a-select>\r\n</template>\r\n\r\n<script>\r\n  import JVxeCellMixins, { dispatchEvent } from '@/components/jeecg/JVxeTable/mixins/JVxeCellMixins'\r\n  import { JVXETypes } from '@comp/jeecg/JVxeTable/index'\r\n\r\n  export default {\r\n    name: 'JVxeSelectCell',\r\n    mixins: [JVxeCellMixins],\r\n    computed: {\r\n      selectProps() {\r\n        let props = {...this.cellProps}\r\n        // 判断select是否允许输入\r\n        let {allowSearch, allowInput} = this.originColumn\r\n        if (allowInput === true || allowSearch === true) {\r\n          props['showSearch'] = true\r\n        }\r\n        return props\r\n      },\r\n    },\r\n    created() {\r\n      let multiple = [JVXETypes.selectMultiple, JVXETypes.list_multi]\r\n      let search = [JVXETypes.selectSearch, JVXETypes.sel_search]\r\n      if (multiple.includes(this.$type)) {\r\n        // 处理多选\r\n        let props = this.originColumn.props || {}\r\n        props['mode'] = 'multiple'\r\n        props['maxTagCount'] = 1\r\n        this.$set(this.originColumn, 'props', props)\r\n      } else if (search.includes(this.$type)) {\r\n        // 处理搜索\r\n        this.$set(this.originColumn, 'allowSearch', true)\r\n      }\r\n    },\r\n    methods: {\r\n\r\n      /** 处理blur失去焦点事件 */\r\n      handleBlur(value) {\r\n        let {allowInput, options} = this.originColumn\r\n\r\n        if (allowInput === true) {\r\n          // 删除无用的因搜索（用户输入）而创建的项\r\n          if (typeof value === 'string') {\r\n            let indexes = []\r\n            options.forEach((option, index) => {\r\n              if (option.value.toLocaleString() === value.toLocaleString()) {\r\n                delete option.searchAdd\r\n              } else if (option.searchAdd === true) {\r\n                indexes.push(index)\r\n              }\r\n            })\r\n            // 翻转删除数组中的项\r\n            for (let index of indexes.reverse()) {\r\n              options.splice(index, 1)\r\n            }\r\n          }\r\n        }\r\n\r\n        this.handleBlurCommon(value)\r\n      },\r\n\r\n      /** 用于搜索下拉框中的内容 */\r\n      handleSelectFilterOption(input, option) {\r\n        let {allowSearch, allowInput} = this.originColumn\r\n        if (allowSearch === true || allowInput === true) {\r\n          //update-begin-author:taoyan date:20200820 for:【专项任务】大连项目反馈行编辑问题处理 下拉框搜索\r\n          return option.componentOptions.children[0].children[0].text.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n          //update-end-author:taoyan date:20200820 for:【专项任务】大连项目反馈行编辑问题处理 下拉框搜索\r\n        }\r\n        return true\r\n      },\r\n\r\n      /** select 搜索时的事件，用于动态添加options */\r\n      handleSearchSelect(value) {\r\n        let {allowSearch, allowInput, options} = this.originColumn\r\n\r\n        if (allowSearch !== true && allowInput === true) {\r\n          // 是否找到了对应的项，找不到则添加这一项\r\n          let flag = false\r\n          for (let option of options) {\r\n            if (option.value.toLocaleString() === value.toLocaleString()) {\r\n              flag = true\r\n              break\r\n            }\r\n          }\r\n          // !!value ：不添加空值\r\n          if (!flag && !!value) {\r\n            // searchAdd 是否是通过搜索添加的\r\n            options.push({title: value, value: value, searchAdd: true})\r\n          }\r\n\r\n        }\r\n      },\r\n\r\n    },\r\n    // 【组件增强】注释详见：JVxeCellMixins.js\r\n    enhanced: {\r\n      aopEvents: {\r\n        editActived: event => dispatchEvent(event, 'ant-select'),\r\n      },\r\n      translate: {enabled: true},\r\n      getValue(value) {\r\n        if (Array.isArray(value)) {\r\n          return value.join(',')\r\n        } else {\r\n          return value\r\n        }\r\n      },\r\n      setValue(value) {\r\n        let {column: {own: col}, params: {$table}} = this\r\n        // 判断是否是多选\r\n        if ((col.props || {})['mode'] === 'multiple') {\r\n          $table.$set(col.props, 'maxTagCount', 1)\r\n        }\r\n        if (value != null && value !== '') {\r\n          if (typeof value === 'string') {\r\n            return value === '' ? [] : value.split(',')\r\n          }\r\n          return value\r\n        } else {\r\n          return undefined\r\n        }\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]}]}